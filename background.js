(()=>{var Xl={8778:(Ie,c,ue)=>{/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(fn){if(!0)Ie.exports=fn();else var b})(function(){var fn,b,lr;return function K(lt,Ye,Me){function Be(Ce,ut){if(!Ye[Ce]){if(!lt[Ce]){var H=void 0;if(!ut&&H)return require(Ce,!0);if(ge)return ge(Ce,!0);var X=new Error("Cannot find module '"+Ce+"'");throw X.code="MODULE_NOT_FOUND",X}var ye=Ye[Ce]={exports:{}};lt[Ce][0].call(ye.exports,function(he){var $e=lt[Ce][1][he];return Be($e||he)},ye,ye.exports,K,lt,Ye,Me)}return Ye[Ce].exports}for(var ge=void 0,Ke=0;Ke<Me.length;Ke++)Be(Me[Ke]);return Be}({1:[function(K,lt,Ye){(function(Me){"use strict";var Be=Me.MutationObserver||Me.WebKitMutationObserver,ge;if(Be){var Ke=0,Ce=new Be(he),ut=Me.document.createTextNode("");Ce.observe(ut,{characterData:!0}),ge=function(){ut.data=Ke=++Ke%2}}else if(!Me.setImmediate&&typeof Me.MessageChannel!="undefined"){var H=new Me.MessageChannel;H.port1.onmessage=he,ge=function(){H.port2.postMessage(0)}}else"document"in Me&&"onreadystatechange"in Me.document.createElement("script")?ge=function(){var Re=Me.document.createElement("script");Re.onreadystatechange=function(){he(),Re.onreadystatechange=null,Re.parentNode.removeChild(Re),Re=null},Me.document.documentElement.appendChild(Re)}:ge=function(){setTimeout(he,0)};var X,ye=[];function he(){X=!0;for(var Re,De,Pe=ye.length;Pe;){for(De=ye,ye=[],Re=-1;++Re<Pe;)De[Re]();Pe=ye.length}X=!1}lt.exports=$e;function $e(Re){ye.push(Re)===1&&!X&&ge()}}).call(this,typeof ue.g!="undefined"?ue.g:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(K,lt,Ye){"use strict";var Me=K(1);function Be(){}var ge={},Ke=["REJECTED"],Ce=["FULFILLED"],ut=["PENDING"];lt.exports=H;function H(Y){if(typeof Y!="function")throw new TypeError("resolver must be a function");this.state=ut,this.queue=[],this.outcome=void 0,Y!==Be&&$e(this,Y)}H.prototype.catch=function(Y){return this.then(null,Y)},H.prototype.then=function(Y,oe){if(typeof Y!="function"&&this.state===Ce||typeof oe!="function"&&this.state===Ke)return this;var R=new this.constructor(Be);if(this.state!==ut){var z=this.state===Ce?Y:oe;ye(R,z,this.outcome)}else this.queue.push(new X(R,Y,oe));return R};function X(Y,oe,R){this.promise=Y,typeof oe=="function"&&(this.onFulfilled=oe,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}X.prototype.callFulfilled=function(Y){ge.resolve(this.promise,Y)},X.prototype.otherCallFulfilled=function(Y){ye(this.promise,this.onFulfilled,Y)},X.prototype.callRejected=function(Y){ge.reject(this.promise,Y)},X.prototype.otherCallRejected=function(Y){ye(this.promise,this.onRejected,Y)};function ye(Y,oe,R){Me(function(){var z;try{z=oe(R)}catch(Q){return ge.reject(Y,Q)}z===Y?ge.reject(Y,new TypeError("Cannot resolve promise with itself")):ge.resolve(Y,z)})}ge.resolve=function(Y,oe){var R=Re(he,oe);if(R.status==="error")return ge.reject(Y,R.value);var z=R.value;if(z)$e(Y,z);else{Y.state=Ce,Y.outcome=oe;for(var Q=-1,te=Y.queue.length;++Q<te;)Y.queue[Q].callFulfilled(oe)}return Y},ge.reject=function(Y,oe){Y.state=Ke,Y.outcome=oe;for(var R=-1,z=Y.queue.length;++R<z;)Y.queue[R].callRejected(oe);return Y};function he(Y){var oe=Y&&Y.then;if(Y&&(typeof Y=="object"||typeof Y=="function")&&typeof oe=="function")return function(){oe.apply(Y,arguments)}}function $e(Y,oe){var R=!1;function z(Te){R||(R=!0,ge.reject(Y,Te))}function Q(Te){R||(R=!0,ge.resolve(Y,Te))}function te(){oe(Q,z)}var _e=Re(te);_e.status==="error"&&z(_e.value)}function Re(Y,oe){var R={};try{R.value=Y(oe),R.status="success"}catch(z){R.status="error",R.value=z}return R}H.resolve=De;function De(Y){return Y instanceof this?Y:ge.resolve(new this(Be),Y)}H.reject=Pe;function Pe(Y){var oe=new this(Be);return ge.reject(oe,Y)}H.all=_t;function _t(Y){var oe=this;if(Object.prototype.toString.call(Y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=Y.length,z=!1;if(!R)return this.resolve([]);for(var Q=new Array(R),te=0,_e=-1,Te=new this(Be);++_e<R;)Ve(Y[_e],_e);return Te;function Ve(ne,ze){oe.resolve(ne).then(Se,function(gt){z||(z=!0,ge.reject(Te,gt))});function Se(gt){Q[ze]=gt,++te===R&&!z&&(z=!0,ge.resolve(Te,Q))}}}H.race=st;function st(Y){var oe=this;if(Object.prototype.toString.call(Y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=Y.length,z=!1;if(!R)return this.resolve([]);for(var Q=-1,te=new this(Be);++Q<R;)_e(Y[Q]);return te;function _e(Te){oe.resolve(Te).then(function(Ve){z||(z=!0,ge.resolve(te,Ve))},function(Ve){z||(z=!0,ge.reject(te,Ve))})}}},{"1":1}],3:[function(K,lt,Ye){(function(Me){"use strict";typeof Me.Promise!="function"&&(Me.Promise=K(2))}).call(this,typeof ue.g!="undefined"?ue.g:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(K,lt,Ye){"use strict";var Me=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h};function Be(h,v){if(!(h instanceof v))throw new TypeError("Cannot call a class as a function")}function ge(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(h){return}}var Ke=ge();function Ce(){try{if(!Ke||!Ke.open)return!1;var h=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),v=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!h||v)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(m){return!1}}function ut(h,v){h=h||[],v=v||{};try{return new Blob(h,v)}catch(A){if(A.name!=="TypeError")throw A;for(var m=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,E=new m,y=0;y<h.length;y+=1)E.append(h[y]);return E.getBlob(v.type)}}typeof Promise=="undefined"&&K(3);var H=Promise;function X(h,v){v&&h.then(function(m){v(null,m)},function(m){v(m)})}function ye(h,v,m){typeof v=="function"&&h.then(v),typeof m=="function"&&h.catch(m)}function he(h){return typeof h!="string"&&(h=String(h)),h}function $e(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var Re="local-forage-detect-blob-support",De=void 0,Pe={},_t=Object.prototype.toString,st="readonly",Y="readwrite";function oe(h){for(var v=h.length,m=new ArrayBuffer(v),E=new Uint8Array(m),y=0;y<v;y++)E[y]=h.charCodeAt(y);return m}function R(h){return new H(function(v){var m=h.transaction(Re,Y),E=ut([""]);m.objectStore(Re).put(E,"key"),m.onabort=function(y){y.preventDefault(),y.stopPropagation(),v(!1)},m.oncomplete=function(){var y=navigator.userAgent.match(/Chrome\/(\d+)/),A=navigator.userAgent.match(/Edge\//);v(A||!y||parseInt(y[1],10)>=43)}}).catch(function(){return!1})}function z(h){return typeof De=="boolean"?H.resolve(De):R(h).then(function(v){return De=v,De})}function Q(h){var v=Pe[h.name],m={};m.promise=new H(function(E,y){m.resolve=E,m.reject=y}),v.deferredOperations.push(m),v.dbReady?v.dbReady=v.dbReady.then(function(){return m.promise}):v.dbReady=m.promise}function te(h){var v=Pe[h.name],m=v.deferredOperations.pop();if(m)return m.resolve(),m.promise}function _e(h,v){var m=Pe[h.name],E=m.deferredOperations.pop();if(E)return E.reject(v),E.promise}function Te(h,v){return new H(function(m,E){if(Pe[h.name]=Pe[h.name]||ur(),h.db)if(v)Q(h),h.db.close();else return m(h.db);var y=[h.name];v&&y.push(h.version);var A=Ke.open.apply(Ke,y);v&&(A.onupgradeneeded=function(O){var W=A.result;try{W.createObjectStore(h.storeName),O.oldVersion<=1&&W.createObjectStore(Re)}catch(D){if(D.name!=="ConstraintError")throw D}}),A.onerror=function(O){O.preventDefault(),E(A.error)},A.onsuccess=function(){var O=A.result;O.onversionchange=function(W){W.target.close()},m(O),te(h)}})}function Ve(h){return Te(h,!1)}function ne(h){return Te(h,!0)}function ze(h,v){if(!h.db)return!0;var m=!h.db.objectStoreNames.contains(h.storeName),E=h.version<h.db.version,y=h.version>h.db.version;if(E&&(h.version!==v,h.version=h.db.version),y||m){if(m){var A=h.db.version+1;A>h.version&&(h.version=A)}return!0}return!1}function Se(h){return new H(function(v,m){var E=new FileReader;E.onerror=m,E.onloadend=function(y){var A=btoa(y.target.result||"");v({__local_forage_encoded_blob:!0,data:A,type:h.type})},E.readAsBinaryString(h)})}function gt(h){var v=oe(atob(h.data));return ut([v],{type:h.type})}function St(h){return h&&h.__local_forage_encoded_blob}function Ze(h){var v=this,m=v._initReady().then(function(){var E=Pe[v._dbInfo.name];if(E&&E.dbReady)return E.dbReady});return ye(m,h,h),m}function Tn(h){Q(h);for(var v=Pe[h.name],m=v.forages,E=0;E<m.length;E++){var y=m[E];y._dbInfo.db&&(y._dbInfo.db.close(),y._dbInfo.db=null)}return h.db=null,Ve(h).then(function(A){return h.db=A,ze(h)?ne(h):A}).then(function(A){h.db=v.db=A;for(var O=0;O<m.length;O++)m[O]._dbInfo.db=A}).catch(function(A){throw _e(h,A),A})}function kt(h,v,m,E){E===void 0&&(E=1);try{var y=h.db.transaction(h.storeName,v);m(null,y)}catch(A){if(E>0&&(!h.db||A.name==="InvalidStateError"||A.name==="NotFoundError"))return H.resolve().then(function(){if(!h.db||A.name==="NotFoundError"&&!h.db.objectStoreNames.contains(h.storeName)&&h.version<=h.db.version)return h.db&&(h.version=h.db.version+1),ne(h)}).then(function(){return Tn(h).then(function(){kt(h,v,m,E-1)})}).catch(m);m(A)}}function ur(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function mn(h){var v=this,m={db:null};if(h)for(var E in h)m[E]=h[E];var y=Pe[m.name];y||(y=ur(),Pe[m.name]=y),y.forages.push(v),v._initReady||(v._initReady=v.ready,v.ready=Ze);var A=[];function O(){return H.resolve()}for(var W=0;W<y.forages.length;W++){var D=y.forages[W];D!==v&&A.push(D._initReady().catch(O))}var B=y.forages.slice(0);return H.all(A).then(function(){return m.db=y.db,Ve(m)}).then(function(F){return m.db=F,ze(m,v._defaultConfig.version)?ne(m):F}).then(function(F){m.db=y.db=F,v._dbInfo=m;for(var $=0;$<B.length;$++){var ie=B[$];ie!==v&&(ie._dbInfo.db=m.db,ie._dbInfo.version=m.version)}})}function Gn(h,v){var m=this;h=he(h);var E=new H(function(y,A){m.ready().then(function(){kt(m._dbInfo,st,function(O,W){if(O)return A(O);try{var D=W.objectStore(m._dbInfo.storeName),B=D.get(h);B.onsuccess=function(){var F=B.result;F===void 0&&(F=null),St(F)&&(F=gt(F)),y(F)},B.onerror=function(){A(B.error)}}catch(F){A(F)}})}).catch(A)});return X(E,v),E}function Pr(h,v){var m=this,E=new H(function(y,A){m.ready().then(function(){kt(m._dbInfo,st,function(O,W){if(O)return A(O);try{var D=W.objectStore(m._dbInfo.storeName),B=D.openCursor(),F=1;B.onsuccess=function(){var $=B.result;if($){var ie=$.value;St(ie)&&(ie=gt(ie));var xe=h(ie,$.key,F++);xe!==void 0?y(xe):$.continue()}else y()},B.onerror=function(){A(B.error)}}catch($){A($)}})}).catch(A)});return X(E,v),E}function gn(h,v,m){var E=this;h=he(h);var y=new H(function(A,O){var W;E.ready().then(function(){return W=E._dbInfo,_t.call(v)==="[object Blob]"?z(W.db).then(function(D){return D?v:Se(v)}):v}).then(function(D){kt(E._dbInfo,Y,function(B,F){if(B)return O(B);try{var $=F.objectStore(E._dbInfo.storeName);D===null&&(D=void 0);var ie=$.put(D,h);F.oncomplete=function(){D===void 0&&(D=null),A(D)},F.onabort=F.onerror=function(){var xe=ie.error?ie.error:ie.transaction.error;O(xe)}}catch(xe){O(xe)}})}).catch(O)});return X(y,m),y}function Vt(h,v){var m=this;h=he(h);var E=new H(function(y,A){m.ready().then(function(){kt(m._dbInfo,Y,function(O,W){if(O)return A(O);try{var D=W.objectStore(m._dbInfo.storeName),B=D.delete(h);W.oncomplete=function(){y()},W.onerror=function(){A(B.error)},W.onabort=function(){var F=B.error?B.error:B.transaction.error;A(F)}}catch(F){A(F)}})}).catch(A)});return X(E,v),E}function ai(h){var v=this,m=new H(function(E,y){v.ready().then(function(){kt(v._dbInfo,Y,function(A,O){if(A)return y(A);try{var W=O.objectStore(v._dbInfo.storeName),D=W.clear();O.oncomplete=function(){E()},O.onabort=O.onerror=function(){var B=D.error?D.error:D.transaction.error;y(B)}}catch(B){y(B)}})}).catch(y)});return X(m,h),m}function Kn(h){var v=this,m=new H(function(E,y){v.ready().then(function(){kt(v._dbInfo,st,function(A,O){if(A)return y(A);try{var W=O.objectStore(v._dbInfo.storeName),D=W.count();D.onsuccess=function(){E(D.result)},D.onerror=function(){y(D.error)}}catch(B){y(B)}})}).catch(y)});return X(m,h),m}function vn(h,v){var m=this,E=new H(function(y,A){if(h<0){y(null);return}m.ready().then(function(){kt(m._dbInfo,st,function(O,W){if(O)return A(O);try{var D=W.objectStore(m._dbInfo.storeName),B=!1,F=D.openKeyCursor();F.onsuccess=function(){var $=F.result;if(!$){y(null);return}h===0||B?y($.key):(B=!0,$.advance(h))},F.onerror=function(){A(F.error)}}catch($){A($)}})}).catch(A)});return X(E,v),E}function Nr(h){var v=this,m=new H(function(E,y){v.ready().then(function(){kt(v._dbInfo,st,function(A,O){if(A)return y(A);try{var W=O.objectStore(v._dbInfo.storeName),D=W.openKeyCursor(),B=[];D.onsuccess=function(){var F=D.result;if(!F){E(B);return}B.push(F.key),F.continue()},D.onerror=function(){y(D.error)}}catch(F){y(F)}})}).catch(y)});return X(m,h),m}function Tt(h,v){v=$e.apply(this,arguments);var m=this.config();h=typeof h!="function"&&h||{},h.name||(h.name=h.name||m.name,h.storeName=h.storeName||m.storeName);var E=this,y;if(!h.name)y=H.reject("Invalid arguments");else{var A=h.name===m.name&&E._dbInfo.db,O=A?H.resolve(E._dbInfo.db):Ve(h).then(function(W){var D=Pe[h.name],B=D.forages;D.db=W;for(var F=0;F<B.length;F++)B[F]._dbInfo.db=W;return W});h.storeName?y=O.then(function(W){if(!!W.objectStoreNames.contains(h.storeName)){var D=W.version+1;Q(h);var B=Pe[h.name],F=B.forages;W.close();for(var $=0;$<F.length;$++){var ie=F[$];ie._dbInfo.db=null,ie._dbInfo.version=D}var xe=new H(function(ve,je){var Qe=Ke.open(h.name,D);Qe.onerror=function(xt){var sn=Qe.result;sn.close(),je(xt)},Qe.onupgradeneeded=function(){var xt=Qe.result;xt.deleteObjectStore(h.storeName)},Qe.onsuccess=function(){var xt=Qe.result;xt.close(),ve(xt)}});return xe.then(function(ve){B.db=ve;for(var je=0;je<F.length;je++){var Qe=F[je];Qe._dbInfo.db=ve,te(Qe._dbInfo)}}).catch(function(ve){throw(_e(h,ve)||H.resolve()).catch(function(){}),ve})}}):y=O.then(function(W){Q(h);var D=Pe[h.name],B=D.forages;W.close();for(var F=0;F<B.length;F++){var $=B[F];$._dbInfo.db=null}var ie=new H(function(xe,ve){var je=Ke.deleteDatabase(h.name);je.onerror=function(){var Qe=je.result;Qe&&Qe.close(),ve(je.error)},je.onblocked=function(){},je.onsuccess=function(){var Qe=je.result;Qe&&Qe.close(),xe(Qe)}});return ie.then(function(xe){D.db=xe;for(var ve=0;ve<B.length;ve++){var je=B[ve];te(je._dbInfo)}}).catch(function(xe){throw(_e(h,xe)||H.resolve()).catch(function(){}),xe})})}return X(y,v),y}var pn={_driver:"asyncStorage",_initStorage:mn,_support:Ce(),iterate:Pr,getItem:Gn,setItem:gn,removeItem:Vt,clear:ai,length:Kn,key:vn,keys:Nr,dropInstance:Tt};function oi(){return typeof openDatabase=="function"}var ct="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ur="~~local_forage_type~",He=/^~~local_forage_type~([^~]+)~/,jt="__lfsc__:",vt=jt.length,bn="arbf",fe="blob",cr="si08",Ln="ui08",li="uic8",On="si16",Ut="si32",$n="ur16",Vn="ui32",dr="fl32",hr="fl64",_r=vt+bn.length,Qt=Object.prototype.toString;function fr(h){var v=h.length*.75,m=h.length,E,y=0,A,O,W,D;h[h.length-1]==="="&&(v--,h[h.length-2]==="="&&v--);var B=new ArrayBuffer(v),F=new Uint8Array(B);for(E=0;E<m;E+=4)A=ct.indexOf(h[E]),O=ct.indexOf(h[E+1]),W=ct.indexOf(h[E+2]),D=ct.indexOf(h[E+3]),F[y++]=A<<2|O>>4,F[y++]=(O&15)<<4|W>>2,F[y++]=(W&3)<<6|D&63;return B}function Pn(h){var v=new Uint8Array(h),m="",E;for(E=0;E<v.length;E+=3)m+=ct[v[E]>>2],m+=ct[(v[E]&3)<<4|v[E+1]>>4],m+=ct[(v[E+1]&15)<<2|v[E+2]>>6],m+=ct[v[E+2]&63];return v.length%3===2?m=m.substring(0,m.length-1)+"=":v.length%3===1&&(m=m.substring(0,m.length-2)+"=="),m}function Rr(h,v){var m="";if(h&&(m=Qt.call(h)),h&&(m==="[object ArrayBuffer]"||h.buffer&&Qt.call(h.buffer)==="[object ArrayBuffer]")){var E,y=jt;h instanceof ArrayBuffer?(E=h,y+=bn):(E=h.buffer,m==="[object Int8Array]"?y+=cr:m==="[object Uint8Array]"?y+=Ln:m==="[object Uint8ClampedArray]"?y+=li:m==="[object Int16Array]"?y+=On:m==="[object Uint16Array]"?y+=$n:m==="[object Int32Array]"?y+=Ut:m==="[object Uint32Array]"?y+=Vn:m==="[object Float32Array]"?y+=dr:m==="[object Float64Array]"?y+=hr:v(new Error("Failed to get type for BinaryArray"))),v(y+Pn(E))}else if(m==="[object Blob]"){var A=new FileReader;A.onload=function(){var O=Ur+h.type+"~"+Pn(this.result);v(jt+fe+O)},A.readAsArrayBuffer(h)}else try{v(JSON.stringify(h))}catch(O){v(null,O)}}function Vi(h){if(h.substring(0,vt)!==jt)return JSON.parse(h);var v=h.substring(_r),m=h.substring(vt,_r),E;if(m===fe&&He.test(v)){var y=v.match(He);E=y[1],v=v.substring(y[0].length)}var A=fr(v);switch(m){case bn:return A;case fe:return ut([A],{type:E});case cr:return new Int8Array(A);case Ln:return new Uint8Array(A);case li:return new Uint8ClampedArray(A);case On:return new Int16Array(A);case $n:return new Uint16Array(A);case Ut:return new Int32Array(A);case Vn:return new Uint32Array(A);case dr:return new Float32Array(A);case hr:return new Float64Array(A);default:throw new Error("Unkown type: "+m)}}var Wr={serialize:Rr,deserialize:Vi,stringToBuffer:fr,bufferToString:Pn};function jn(h,v,m,E){h.executeSql("CREATE TABLE IF NOT EXISTS "+v.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],m,E)}function ui(h){var v=this,m={db:null};if(h)for(var E in h)m[E]=typeof h[E]!="string"?h[E].toString():h[E];var y=new H(function(A,O){try{m.db=openDatabase(m.name,String(m.version),m.description,m.size)}catch(W){return O(W)}m.db.transaction(function(W){jn(W,m,function(){v._dbInfo=m,A()},function(D,B){O(B)})},O)});return m.serializer=Wr,y}function Xt(h,v,m,E,y,A){h.executeSql(m,E,y,function(O,W){W.code===W.SYNTAX_ERR?O.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[v.storeName],function(D,B){B.rows.length?A(D,W):jn(D,v,function(){D.executeSql(m,E,y,A)},A)},A):A(O,W)},A)}function ji(h,v){var m=this;h=he(h);var E=new H(function(y,A){m.ready().then(function(){var O=m._dbInfo;O.db.transaction(function(W){Xt(W,O,"SELECT * FROM "+O.storeName+" WHERE key = ? LIMIT 1",[h],function(D,B){var F=B.rows.length?B.rows.item(0).value:null;F&&(F=O.serializer.deserialize(F)),y(F)},function(D,B){A(B)})})}).catch(A)});return X(E,v),E}function Qi(h,v){var m=this,E=new H(function(y,A){m.ready().then(function(){var O=m._dbInfo;O.db.transaction(function(W){Xt(W,O,"SELECT * FROM "+O.storeName,[],function(D,B){for(var F=B.rows,$=F.length,ie=0;ie<$;ie++){var xe=F.item(ie),ve=xe.value;if(ve&&(ve=O.serializer.deserialize(ve)),ve=h(ve,xe.key,ie+1),ve!==void 0){y(ve);return}}y()},function(D,B){A(B)})})}).catch(A)});return X(E,v),E}function ci(h,v,m,E){var y=this;h=he(h);var A=new H(function(O,W){y.ready().then(function(){v===void 0&&(v=null);var D=v,B=y._dbInfo;B.serializer.serialize(v,function(F,$){$?W($):B.db.transaction(function(ie){Xt(ie,B,"INSERT OR REPLACE INTO "+B.storeName+" (key, value) VALUES (?, ?)",[h,F],function(){O(D)},function(xe,ve){W(ve)})},function(ie){if(ie.code===ie.QUOTA_ERR){if(E>0){O(ci.apply(y,[h,D,m,E-1]));return}W(ie)}})})}).catch(W)});return X(A,m),A}function Xi(h,v,m){return ci.apply(this,[h,v,m,1])}function di(h,v){var m=this;h=he(h);var E=new H(function(y,A){m.ready().then(function(){var O=m._dbInfo;O.db.transaction(function(W){Xt(W,O,"DELETE FROM "+O.storeName+" WHERE key = ?",[h],function(){y()},function(D,B){A(B)})})}).catch(A)});return X(E,v),E}function Zi(h){var v=this,m=new H(function(E,y){v.ready().then(function(){var A=v._dbInfo;A.db.transaction(function(O){Xt(O,A,"DELETE FROM "+A.storeName,[],function(){E()},function(W,D){y(D)})})}).catch(y)});return X(m,h),m}function Ji(h){var v=this,m=new H(function(E,y){v.ready().then(function(){var A=v._dbInfo;A.db.transaction(function(O){Xt(O,A,"SELECT COUNT(key) as c FROM "+A.storeName,[],function(W,D){var B=D.rows.item(0).c;E(B)},function(W,D){y(D)})})}).catch(y)});return X(m,h),m}function hi(h,v){var m=this,E=new H(function(y,A){m.ready().then(function(){var O=m._dbInfo;O.db.transaction(function(W){Xt(W,O,"SELECT key FROM "+O.storeName+" WHERE id = ? LIMIT 1",[h+1],function(D,B){var F=B.rows.length?B.rows.item(0).key:null;y(F)},function(D,B){A(B)})})}).catch(A)});return X(E,v),E}function Mr(h){var v=this,m=new H(function(E,y){v.ready().then(function(){var A=v._dbInfo;A.db.transaction(function(O){Xt(O,A,"SELECT key FROM "+A.storeName,[],function(W,D){for(var B=[],F=0;F<D.rows.length;F++)B.push(D.rows.item(F).key);E(B)},function(W,D){y(D)})})}).catch(y)});return X(m,h),m}function _i(h){return new H(function(v,m){h.transaction(function(E){E.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(y,A){for(var O=[],W=0;W<A.rows.length;W++)O.push(A.rows.item(W).name);v({db:h,storeNames:O})},function(y,A){m(A)})},function(E){m(E)})})}function mr(h,v){v=$e.apply(this,arguments);var m=this.config();h=typeof h!="function"&&h||{},h.name||(h.name=h.name||m.name,h.storeName=h.storeName||m.storeName);var E=this,y;return h.name?y=new H(function(A){var O;h.name===m.name?O=E._dbInfo.db:O=openDatabase(h.name,"","",0),h.storeName?A({db:O,storeNames:[h.storeName]}):A(_i(O))}).then(function(A){return new H(function(O,W){A.db.transaction(function(D){function B(xe){return new H(function(ve,je){D.executeSql("DROP TABLE IF EXISTS "+xe,[],function(){ve()},function(Qe,xt){je(xt)})})}for(var F=[],$=0,ie=A.storeNames.length;$<ie;$++)F.push(B(A.storeNames[$]));H.all(F).then(function(){O()}).catch(function(xe){W(xe)})},function(D){W(D)})})}):y=H.reject("Invalid arguments"),X(y,v),y}var fi={_driver:"webSQLStorage",_initStorage:ui,_support:oi(),iterate:Qi,getItem:ji,setItem:Xi,removeItem:di,clear:Zi,length:Ji,key:hi,keys:Mr,dropInstance:mr};function mi(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(h){return!1}}function gr(h,v){var m=h.name+"/";return h.storeName!==v.storeName&&(m+=h.storeName+"/"),m}function gi(){var h="_localforage_support_test";try{return localStorage.setItem(h,!0),localStorage.removeItem(h),!1}catch(v){return!0}}function vi(){return!gi()||localStorage.length>0}function Br(h){var v=this,m={};if(h)for(var E in h)m[E]=h[E];return m.keyPrefix=gr(h,v._defaultConfig),vi()?(v._dbInfo=m,m.serializer=Wr,H.resolve()):H.reject()}function pi(h){var v=this,m=v.ready().then(function(){for(var E=v._dbInfo.keyPrefix,y=localStorage.length-1;y>=0;y--){var A=localStorage.key(y);A.indexOf(E)===0&&localStorage.removeItem(A)}});return X(m,h),m}function bi(h,v){var m=this;h=he(h);var E=m.ready().then(function(){var y=m._dbInfo,A=localStorage.getItem(y.keyPrefix+h);return A&&(A=y.serializer.deserialize(A)),A});return X(E,v),E}function Lt(h,v){var m=this,E=m.ready().then(function(){for(var y=m._dbInfo,A=y.keyPrefix,O=A.length,W=localStorage.length,D=1,B=0;B<W;B++){var F=localStorage.key(B);if(F.indexOf(A)===0){var $=localStorage.getItem(F);if($&&($=y.serializer.deserialize($)),$=h($,F.substring(O),D++),$!==void 0)return $}}});return X(E,v),E}function xi(h,v){var m=this,E=m.ready().then(function(){var y=m._dbInfo,A;try{A=localStorage.key(h)}catch(O){A=null}return A&&(A=A.substring(y.keyPrefix.length)),A});return X(E,v),E}function wi(h){var v=this,m=v.ready().then(function(){for(var E=v._dbInfo,y=localStorage.length,A=[],O=0;O<y;O++){var W=localStorage.key(O);W.indexOf(E.keyPrefix)===0&&A.push(W.substring(E.keyPrefix.length))}return A});return X(m,h),m}function es(h){var v=this,m=v.keys().then(function(E){return E.length});return X(m,h),m}function vr(h,v){var m=this;h=he(h);var E=m.ready().then(function(){var y=m._dbInfo;localStorage.removeItem(y.keyPrefix+h)});return X(E,v),E}function Ii(h,v,m){var E=this;h=he(h);var y=E.ready().then(function(){v===void 0&&(v=null);var A=v;return new H(function(O,W){var D=E._dbInfo;D.serializer.serialize(v,function(B,F){if(F)W(F);else try{localStorage.setItem(D.keyPrefix+h,B),O(A)}catch($){($.name==="QuotaExceededError"||$.name==="NS_ERROR_DOM_QUOTA_REACHED")&&W($),W($)}})})});return X(y,m),y}function Ai(h,v){if(v=$e.apply(this,arguments),h=typeof h!="function"&&h||{},!h.name){var m=this.config();h.name=h.name||m.name,h.storeName=h.storeName||m.storeName}var E=this,y;return h.name?y=new H(function(A){h.storeName?A(gr(h,E._defaultConfig)):A(h.name+"/")}).then(function(A){for(var O=localStorage.length-1;O>=0;O--){var W=localStorage.key(O);W.indexOf(A)===0&&localStorage.removeItem(W)}}):y=H.reject("Invalid arguments"),X(y,v),y}var Qn={_driver:"localStorageWrapper",_initStorage:Br,_support:mi(),iterate:Lt,getItem:bi,setItem:Ii,removeItem:vr,clear:pi,length:es,key:xi,keys:wi,dropInstance:Ai},Dr=function(v,m){return v===m||typeof v=="number"&&typeof m=="number"&&isNaN(v)&&isNaN(m)},Xn=function(v,m){for(var E=v.length,y=0;y<E;){if(Dr(v[y],m))return!0;y++}return!1},Fr=Array.isArray||function(h){return Object.prototype.toString.call(h)==="[object Array]"},xn={},Nn={},Yt={INDEXEDDB:pn,WEBSQL:fi,LOCALSTORAGE:Qn},be=[Yt.INDEXEDDB._driver,Yt.WEBSQL._driver,Yt.LOCALSTORAGE._driver],Un=["dropInstance"],pr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Un),Ei={description:"",driver:be.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function kr(h,v){h[v]=function(){var m=arguments;return h.ready().then(function(){return h[v].apply(h,m)})}}function br(){for(var h=1;h<arguments.length;h++){var v=arguments[h];if(v)for(var m in v)v.hasOwnProperty(m)&&(Fr(v[m])?arguments[0][m]=v[m].slice():arguments[0][m]=v[m])}return arguments[0]}var Yr=function(){function h(v){Be(this,h);for(var m in Yt)if(Yt.hasOwnProperty(m)){var E=Yt[m],y=E._driver;this[m]=y,xn[y]||this.defineDriver(E)}this._defaultConfig=br({},Ei),this._config=br({},this._defaultConfig,v),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return h.prototype.config=function(m){if((typeof m=="undefined"?"undefined":Me(m))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var E in m){if(E==="storeName"&&(m[E]=m[E].replace(/\W/g,"_")),E==="version"&&typeof m[E]!="number")return new Error("Database version must be a number.");this._config[E]=m[E]}return"driver"in m&&m.driver?this.setDriver(this._config.driver):!0}else return typeof m=="string"?this._config[m]:this._config},h.prototype.defineDriver=function(m,E,y){var A=new H(function(O,W){try{var D=m._driver,B=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!m._driver){W(B);return}for(var F=pr.concat("_initStorage"),$=0,ie=F.length;$<ie;$++){var xe=F[$],ve=!Xn(Un,xe);if((ve||m[xe])&&typeof m[xe]!="function"){W(B);return}}var je=function(){for(var sn=function(Ci){return function(){var Le=new Error("Method "+Ci+" is not implemented by the current driver"),wr=H.reject(Le);return X(wr,arguments[arguments.length-1]),wr}},Zn=0,zr=Un.length;Zn<zr;Zn++){var Ee=Un[Zn];m[Ee]||(m[Ee]=sn(Ee))}};je();var Qe=function(sn){xn[D],xn[D]=m,Nn[D]=sn,O()};"_support"in m?m._support&&typeof m._support=="function"?m._support().then(Qe,W):Qe(!!m._support):Qe(!0)}catch(xt){W(xt)}});return ye(A,E,y),A},h.prototype.driver=function(){return this._driver||null},h.prototype.getDriver=function(m,E,y){var A=xn[m]?H.resolve(xn[m]):H.reject(new Error("Driver not found."));return ye(A,E,y),A},h.prototype.getSerializer=function(m){var E=H.resolve(Wr);return ye(E,m),E},h.prototype.ready=function(m){var E=this,y=E._driverSet.then(function(){return E._ready===null&&(E._ready=E._initDriver()),E._ready});return ye(y,m,m),y},h.prototype.setDriver=function(m,E,y){var A=this;Fr(m)||(m=[m]);var O=this._getSupportedDrivers(m);function W(){A._config.driver=A.driver()}function D($){return A._extend($),W(),A._ready=A._initStorage(A._config),A._ready}function B($){return function(){var ie=0;function xe(){for(;ie<$.length;){var ve=$[ie];return ie++,A._dbInfo=null,A._ready=null,A.getDriver(ve).then(D).catch(xe)}W();var je=new Error("No available storage method found.");return A._driverSet=H.reject(je),A._driverSet}return xe()}}var F=this._driverSet!==null?this._driverSet.catch(function(){return H.resolve()}):H.resolve();return this._driverSet=F.then(function(){var $=O[0];return A._dbInfo=null,A._ready=null,A.getDriver($).then(function(ie){A._driver=ie._driver,W(),A._wrapLibraryMethodsWithReady(),A._initDriver=B(O)})}).catch(function(){W();var $=new Error("No available storage method found.");return A._driverSet=H.reject($),A._driverSet}),ye(this._driverSet,E,y),this._driverSet},h.prototype.supports=function(m){return!!Nn[m]},h.prototype._extend=function(m){br(this,m)},h.prototype._getSupportedDrivers=function(m){for(var E=[],y=0,A=m.length;y<A;y++){var O=m[y];this.supports(O)&&E.push(O)}return E},h.prototype._wrapLibraryMethodsWithReady=function(){for(var m=0,E=pr.length;m<E;m++)kr(this,pr[m])},h.prototype.createInstance=function(m){return new h(m)},h}(),xr=new Yr;lt.exports=xr},{"3":3}]},{},[4])(4)})},3760:function(Ie,c,ue){Ie=ue.nmd(Ie);var fn;/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(){var b,lr="4.17.21",K=200,lt="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",Ye="Expected a function",Me="Invalid `variable` option passed into `_.template`",Be="__lodash_hash_undefined__",ge=500,Ke="__lodash_placeholder__",Ce=1,ut=2,H=4,X=1,ye=2,he=1,$e=2,Re=4,De=8,Pe=16,_t=32,st=64,Y=128,oe=256,R=512,z=30,Q="...",te=800,_e=16,Te=1,Ve=2,ne=3,ze=1/0,Se=9007199254740991,gt=17976931348623157e292,St=0/0,Ze=4294967295,Tn=Ze-1,kt=Ze>>>1,ur=[["ary",Y],["bind",he],["bindKey",$e],["curry",De],["curryRight",Pe],["flip",R],["partial",_t],["partialRight",st],["rearg",oe]],mn="[object Arguments]",Gn="[object Array]",Pr="[object AsyncFunction]",gn="[object Boolean]",Vt="[object Date]",ai="[object DOMException]",Kn="[object Error]",vn="[object Function]",Nr="[object GeneratorFunction]",Tt="[object Map]",pn="[object Number]",oi="[object Null]",ct="[object Object]",Ur="[object Promise]",He="[object Proxy]",jt="[object RegExp]",vt="[object Set]",bn="[object String]",fe="[object Symbol]",cr="[object Undefined]",Ln="[object WeakMap]",li="[object WeakSet]",On="[object ArrayBuffer]",Ut="[object DataView]",$n="[object Float32Array]",Vn="[object Float64Array]",dr="[object Int8Array]",hr="[object Int16Array]",_r="[object Int32Array]",Qt="[object Uint8Array]",fr="[object Uint8ClampedArray]",Pn="[object Uint16Array]",Rr="[object Uint32Array]",Vi=/\b__p \+= '';/g,Wr=/\b(__p \+=) '' \+/g,jn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ui=/&(?:amp|lt|gt|quot|#39);/g,Xt=/[&<>"']/g,ji=RegExp(ui.source),Qi=RegExp(Xt.source),ci=/<%-([\s\S]+?)%>/g,Xi=/<%([\s\S]+?)%>/g,di=/<%=([\s\S]+?)%>/g,Zi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ji=/^\w*$/,hi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mr=/[\\^$.*+?()[\]{}|]/g,_i=RegExp(Mr.source),mr=/^\s+/,fi=/\s/,mi=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,gr=/\{\n\/\* \[wrapped with (.+)\] \*/,gi=/,? & /,vi=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Br=/[()=,{}\[\]\/\s]/,pi=/\\(\\)?/g,bi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Lt=/\w*$/,xi=/^[-+]0x[0-9a-f]+$/i,wi=/^0b[01]+$/i,es=/^\[object .+?Constructor\]$/,vr=/^0o[0-7]+$/i,Ii=/^(?:0|[1-9]\d*)$/,Ai=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qn=/($^)/,Dr=/['\n\r\u2028\u2029\\]/g,Xn="\\ud800-\\udfff",Fr="\\u0300-\\u036f",xn="\\ufe20-\\ufe2f",Nn="\\u20d0-\\u20ff",Yt=Fr+xn+Nn,be="\\u2700-\\u27bf",Un="a-z\\xdf-\\xf6\\xf8-\\xff",pr="\\xac\\xb1\\xd7\\xf7",Ei="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",kr="\\u2000-\\u206f",br=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Yr="A-Z\\xc0-\\xd6\\xd8-\\xde",xr="\\ufe0e\\ufe0f",h=pr+Ei+kr+br,v="['\u2019]",m="["+Xn+"]",E="["+h+"]",y="["+Yt+"]",A="\\d+",O="["+be+"]",W="["+Un+"]",D="[^"+Xn+h+A+be+Un+Yr+"]",B="\\ud83c[\\udffb-\\udfff]",F="(?:"+y+"|"+B+")",$="[^"+Xn+"]",ie="(?:\\ud83c[\\udde6-\\uddff]){2}",xe="[\\ud800-\\udbff][\\udc00-\\udfff]",ve="["+Yr+"]",je="\\u200d",Qe="(?:"+W+"|"+D+")",xt="(?:"+ve+"|"+D+")",sn="(?:"+v+"(?:d|ll|m|re|s|t|ve))?",Zn="(?:"+v+"(?:D|LL|M|RE|S|T|VE))?",zr=F+"?",Ee="["+xr+"]?",ts="(?:"+je+"(?:"+[$,ie,xe].join("|")+")"+Ee+zr+")*",Ci="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Le="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",wr=Ee+zr+ts,Qs="(?:"+[O,ie,xe].join("|")+")"+wr,Hr="(?:"+[$+y+"?",y,ie,xe,m].join("|")+")",yi=RegExp(v,"g"),Xs=RegExp(y,"g"),tt=RegExp(B+"(?="+B+")|"+Hr+wr,"g"),qr=RegExp([ve+"?"+W+"+"+sn+"(?="+[E,ve,"$"].join("|")+")",xt+"+"+Zn+"(?="+[E,ve+Qe,"$"].join("|")+")",ve+"?"+Qe+"+"+sn,ve+"+"+Zn,Le,Ci,A,Qs].join("|"),"g"),Si=RegExp("["+je+Xn+Yt+xr+"]"),Zs=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Js=-1,qe={};qe[$n]=qe[Vn]=qe[dr]=qe[hr]=qe[_r]=qe[Qt]=qe[fr]=qe[Pn]=qe[Rr]=!0,qe[mn]=qe[Gn]=qe[On]=qe[gn]=qe[Ut]=qe[Vt]=qe[Kn]=qe[vn]=qe[Tt]=qe[pn]=qe[ct]=qe[jt]=qe[vt]=qe[bn]=qe[Ln]=!1;var Fe={};Fe[mn]=Fe[Gn]=Fe[On]=Fe[Ut]=Fe[gn]=Fe[Vt]=Fe[$n]=Fe[Vn]=Fe[dr]=Fe[hr]=Fe[_r]=Fe[Tt]=Fe[pn]=Fe[ct]=Fe[jt]=Fe[vt]=Fe[bn]=Fe[fe]=Fe[Qt]=Fe[fr]=Fe[Pn]=Fe[Rr]=!0,Fe[Kn]=Fe[vn]=Fe[Ln]=!1;var ea={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},ta={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},na={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},wt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ns=parseFloat,rs=parseInt,wn=typeof ue.g=="object"&&ue.g&&ue.g.Object===Object&&ue.g,In=typeof self=="object"&&self&&self.Object===Object&&self,Je=wn||In||Function("return this")(),Rn=c&&!c.nodeType&&c,nt=Rn&&!0&&Ie&&!Ie.nodeType&&Ie,k=nt&&nt.exports===Rn,ce=k&&wn.process,Ne=function(){try{var C=nt&&nt.require&&nt.require("util").types;return C||ce&&ce.binding&&ce.binding("util")}catch(P){}}(),Kr=Ne&&Ne.isArrayBuffer,is=Ne&&Ne.isDate,ss=Ne&&Ne.isMap,an=Ne&&Ne.isRegExp,Jn=Ne&&Ne.isSet,on=Ne&&Ne.isTypedArray;function ft(C,P,L){switch(L.length){case 0:return C.call(P);case 1:return C.call(P,L[0]);case 2:return C.call(P,L[0],L[1]);case 3:return C.call(P,L[0],L[1],L[2])}return C.apply(P,L)}function $r(C,P,L,G){for(var se=-1,Oe=C==null?0:C.length;++se<Oe;){var dt=C[se];P(G,dt,L(dt),C)}return G}function Rt(C,P){for(var L=-1,G=C==null?0:C.length;++L<G&&P(C[L],L,C)!==!1;);return C}function ra(C,P){for(var L=C==null?0:C.length;L--&&P(C[L],L,C)!==!1;);return C}function as(C,P){for(var L=-1,G=C==null?0:C.length;++L<G;)if(!P(C[L],L,C))return!1;return!0}function An(C,P){for(var L=-1,G=C==null?0:C.length,se=0,Oe=[];++L<G;){var dt=C[L];P(dt,L,C)&&(Oe[se++]=dt)}return Oe}function Vr(C,P){var L=C==null?0:C.length;return!!L&&tr(C,P,0)>-1}function Ti(C,P,L){for(var G=-1,se=C==null?0:C.length;++G<se;)if(L(P,C[G]))return!0;return!1}function Xe(C,P){for(var L=-1,G=C==null?0:C.length,se=Array(G);++L<G;)se[L]=P(C[L],L,C);return se}function ln(C,P){for(var L=-1,G=P.length,se=C.length;++L<G;)C[se+L]=P[L];return C}function Li(C,P,L,G){var se=-1,Oe=C==null?0:C.length;for(G&&Oe&&(L=C[++se]);++se<Oe;)L=P(L,C[se],se,C);return L}function os(C,P,L,G){var se=C==null?0:C.length;for(G&&se&&(L=C[--se]);se--;)L=P(L,C[se],se,C);return L}function Oi(C,P){for(var L=-1,G=C==null?0:C.length;++L<G;)if(P(C[L],L,C))return!0;return!1}var ia=Pi("length");function sa(C){return C.split("")}function aa(C){return C.match(vi)||[]}function ls(C,P,L){var G;return L(C,function(se,Oe,dt){if(P(se,Oe,dt))return G=Oe,!1}),G}function er(C,P,L,G){for(var se=C.length,Oe=L+(G?1:-1);G?Oe--:++Oe<se;)if(P(C[Oe],Oe,C))return Oe;return-1}function tr(C,P,L){return P===P?Wn(C,P,L):er(C,us,L)}function oa(C,P,L,G){for(var se=L-1,Oe=C.length;++se<Oe;)if(G(C[se],P))return se;return-1}function us(C){return C!==C}function cs(C,P){var L=C==null?0:C.length;return L?Qr(C,P)/L:St}function Pi(C){return function(P){return P==null?b:P[C]}}function jr(C){return function(P){return C==null?b:C[P]}}function Ni(C,P,L,G,se){return se(C,function(Oe,dt,Ge){L=G?(G=!1,Oe):P(L,Oe,dt,Ge)}),L}function la(C,P){var L=C.length;for(C.sort(P);L--;)C[L]=C[L].value;return C}function Qr(C,P){for(var L,G=-1,se=C.length;++G<se;){var Oe=P(C[G]);Oe!==b&&(L=L===b?Oe:L+Oe)}return L}function Ui(C,P){for(var L=-1,G=Array(C);++L<C;)G[L]=P(L);return G}function ds(C,P){return Xe(P,function(L){return[L,C[L]]})}function hs(C){return C&&C.slice(0,cn(C)+1).replace(mr,"")}function u(C){return function(P){return C(P)}}function n(C,P){return Xe(P,function(L){return C[L]})}function r(C,P){return C.has(P)}function s(C,P){for(var L=-1,G=C.length;++L<G&&tr(P,C[L],0)>-1;);return L}function l(C,P){for(var L=C.length;L--&&tr(P,C[L],0)>-1;);return L}function g(C,P){for(var L=C.length,G=0;L--;)C[L]===P&&++G;return G}var p=jr(ea),w=jr(ta);function f(C){return"\\"+wt[C]}function T(C,P){return C==null?b:C[P]}function re(C){return Si.test(C)}function j(C){return Zs.test(C)}function ke(C){for(var P,L=[];!(P=C.next()).done;)L.push(P.value);return L}function et(C){var P=-1,L=Array(C.size);return C.forEach(function(G,se){L[++P]=[se,G]}),L}function It(C,P){return function(L){return C(P(L))}}function At(C,P){for(var L=-1,G=C.length,se=0,Oe=[];++L<G;){var dt=C[L];(dt===P||dt===Ke)&&(C[L]=Ke,Oe[se++]=L)}return Oe}function un(C){var P=-1,L=Array(C.size);return C.forEach(function(G){L[++P]=G}),L}function En(C){var P=-1,L=Array(C.size);return C.forEach(function(G){L[++P]=[G,G]}),L}function Wn(C,P,L){for(var G=L-1,se=C.length;++G<se;)if(C[G]===P)return G;return-1}function Ir(C,P,L){for(var G=L+1;G--;)if(C[G]===P)return G;return G}function zt(C){return re(C)?Ht(C):ia(C)}function pt(C){return re(C)?ua(C):sa(C)}function cn(C){for(var P=C.length;P--&&fi.test(C.charAt(P)););return P}var Et=jr(na);function Ht(C){for(var P=tt.lastIndex=0;tt.test(C);)++P;return P}function ua(C){return C.match(tt)||[]}function ca(C){return C.match(qr)||[]}var da=function C(P){P=P==null?Je:_s.defaults(Je.Object(),P,_s.pick(Je,Gr));var L=P.Array,G=P.Date,se=P.Error,Oe=P.Function,dt=P.Math,Ge=P.Object,ha=P.RegExp,Zl=P.String,Zt=P.TypeError,fs=L.prototype,Jl=Oe.prototype,Xr=Ge.prototype,ms=P["__core-js_shared__"],gs=Jl.toString,We=Xr.hasOwnProperty,eu=0,oo=function(){var e=/[^.]+$/.exec(ms&&ms.keys&&ms.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),vs=Xr.toString,tu=gs.call(Ge),nu=Je._,ru=ha("^"+gs.call(We).replace(Mr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ps=k?P.Buffer:b,nr=P.Symbol,bs=P.Uint8Array,lo=ps?ps.allocUnsafe:b,xs=It(Ge.getPrototypeOf,Ge),uo=Ge.create,co=Xr.propertyIsEnumerable,ws=fs.splice,ho=nr?nr.isConcatSpreadable:b,Ri=nr?nr.iterator:b,Ar=nr?nr.toStringTag:b,Is=function(){try{var e=Tr(Ge,"defineProperty");return e({},"",{}),e}catch(t){}}(),iu=P.clearTimeout!==Je.clearTimeout&&P.clearTimeout,su=G&&G.now!==Je.Date.now&&G.now,au=P.setTimeout!==Je.setTimeout&&P.setTimeout,As=dt.ceil,Es=dt.floor,_a=Ge.getOwnPropertySymbols,ou=ps?ps.isBuffer:b,_o=P.isFinite,lu=fs.join,uu=It(Ge.keys,Ge),ht=dt.max,Ct=dt.min,cu=G.now,du=P.parseInt,fo=dt.random,hu=fs.reverse,fa=Tr(P,"DataView"),Wi=Tr(P,"Map"),ma=Tr(P,"Promise"),Zr=Tr(P,"Set"),Mi=Tr(P,"WeakMap"),Bi=Tr(Ge,"create"),Cs=Mi&&new Mi,Jr={},_u=Lr(fa),fu=Lr(Wi),mu=Lr(ma),gu=Lr(Zr),vu=Lr(Mi),ys=nr?nr.prototype:b,Di=ys?ys.valueOf:b,mo=ys?ys.toString:b;function d(e){if(it(e)&&!ae(e)&&!(e instanceof we)){if(e instanceof Jt)return e;if(We.call(e,"__wrapped__"))return gl(e)}return new Jt(e)}var ei=function(){function e(){}return function(t){if(!rt(t))return{};if(uo)return uo(t);e.prototype=t;var i=new e;return e.prototype=b,i}}();function Ss(){}function Jt(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=b}d.templateSettings={escape:ci,evaluate:Xi,interpolate:di,variable:"",imports:{_:d}},d.prototype=Ss.prototype,d.prototype.constructor=d,Jt.prototype=ei(Ss.prototype),Jt.prototype.constructor=Jt;function we(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ze,this.__views__=[]}function pu(){var e=new we(this.__wrapped__);return e.__actions__=Wt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Wt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Wt(this.__views__),e}function bu(){if(this.__filtered__){var e=new we(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function xu(){var e=this.__wrapped__.value(),t=this.__dir__,i=ae(e),a=t<0,o=i?e.length:0,_=Nc(0,o,this.__views__),x=_.start,I=_.end,S=I-x,N=a?I:x-1,U=this.__iteratees__,M=U.length,q=0,V=Ct(S,this.__takeCount__);if(!i||!a&&o==S&&V==S)return Fo(e,this.__actions__);var J=[];e:for(;S--&&q<V;){N+=t;for(var de=-1,ee=e[N];++de<M;){var pe=U[de],Ae=pe.iteratee,Kt=pe.type,Nt=Ae(ee);if(Kt==Ve)ee=Nt;else if(!Nt){if(Kt==Te)continue e;break e}}J[q++]=ee}return J}we.prototype=ei(Ss.prototype),we.prototype.constructor=we;function Er(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}function wu(){this.__data__=Bi?Bi(null):{},this.size=0}function Iu(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Au(e){var t=this.__data__;if(Bi){var i=t[e];return i===Be?b:i}return We.call(t,e)?t[e]:b}function Eu(e){var t=this.__data__;return Bi?t[e]!==b:We.call(t,e)}function Cu(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Bi&&t===b?Be:t,this}Er.prototype.clear=wu,Er.prototype.delete=Iu,Er.prototype.get=Au,Er.prototype.has=Eu,Er.prototype.set=Cu;function Mn(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}function yu(){this.__data__=[],this.size=0}function Su(e){var t=this.__data__,i=Ts(t,e);if(i<0)return!1;var a=t.length-1;return i==a?t.pop():ws.call(t,i,1),--this.size,!0}function Tu(e){var t=this.__data__,i=Ts(t,e);return i<0?b:t[i][1]}function Lu(e){return Ts(this.__data__,e)>-1}function Ou(e,t){var i=this.__data__,a=Ts(i,e);return a<0?(++this.size,i.push([e,t])):i[a][1]=t,this}Mn.prototype.clear=yu,Mn.prototype.delete=Su,Mn.prototype.get=Tu,Mn.prototype.has=Lu,Mn.prototype.set=Ou;function Bn(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}function Pu(){this.size=0,this.__data__={hash:new Er,map:new(Wi||Mn),string:new Er}}function Nu(e){var t=ks(this,e).delete(e);return this.size-=t?1:0,t}function Uu(e){return ks(this,e).get(e)}function Ru(e){return ks(this,e).has(e)}function Wu(e,t){var i=ks(this,e),a=i.size;return i.set(e,t),this.size+=i.size==a?0:1,this}Bn.prototype.clear=Pu,Bn.prototype.delete=Nu,Bn.prototype.get=Uu,Bn.prototype.has=Ru,Bn.prototype.set=Wu;function Cr(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new Bn;++t<i;)this.add(e[t])}function Mu(e){return this.__data__.set(e,Be),this}function Bu(e){return this.__data__.has(e)}Cr.prototype.add=Cr.prototype.push=Mu,Cr.prototype.has=Bu;function dn(e){var t=this.__data__=new Mn(e);this.size=t.size}function Du(){this.__data__=new Mn,this.size=0}function Fu(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function ku(e){return this.__data__.get(e)}function Yu(e){return this.__data__.has(e)}function zu(e,t){var i=this.__data__;if(i instanceof Mn){var a=i.__data__;if(!Wi||a.length<K-1)return a.push([e,t]),this.size=++i.size,this;i=this.__data__=new Bn(a)}return i.set(e,t),this.size=i.size,this}dn.prototype.clear=Du,dn.prototype.delete=Fu,dn.prototype.get=ku,dn.prototype.has=Yu,dn.prototype.set=zu;function go(e,t){var i=ae(e),a=!i&&Or(e),o=!i&&!a&&or(e),_=!i&&!a&&!o&&ii(e),x=i||a||o||_,I=x?Ui(e.length,Zl):[],S=I.length;for(var N in e)(t||We.call(e,N))&&!(x&&(N=="length"||o&&(N=="offset"||N=="parent")||_&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||Yn(N,S)))&&I.push(N);return I}function vo(e){var t=e.length;return t?e[ya(0,t-1)]:b}function Hu(e,t){return Ys(Wt(e),yr(t,0,e.length))}function qu(e){return Ys(Wt(e))}function ga(e,t,i){(i!==b&&!hn(e[t],i)||i===b&&!(t in e))&&Dn(e,t,i)}function Fi(e,t,i){var a=e[t];(!(We.call(e,t)&&hn(a,i))||i===b&&!(t in e))&&Dn(e,t,i)}function Ts(e,t){for(var i=e.length;i--;)if(hn(e[i][0],t))return i;return-1}function Gu(e,t,i,a){return rr(e,function(o,_,x){t(a,o,i(o),x)}),a}function po(e,t){return e&&yn(t,mt(t),e)}function Ku(e,t){return e&&yn(t,Bt(t),e)}function Dn(e,t,i){t=="__proto__"&&Is?Is(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function va(e,t){for(var i=-1,a=t.length,o=L(a),_=e==null;++i<a;)o[i]=_?b:Xa(e,t[i]);return o}function yr(e,t,i){return e===e&&(i!==b&&(e=e<=i?e:i),t!==b&&(e=e>=t?e:t)),e}function en(e,t,i,a,o,_){var x,I=t&Ce,S=t&ut,N=t&H;if(i&&(x=o?i(e,a,o,_):i(e)),x!==b)return x;if(!rt(e))return e;var U=ae(e);if(U){if(x=Rc(e),!I)return Wt(e,x)}else{var M=yt(e),q=M==vn||M==Nr;if(or(e))return zo(e,I);if(M==ct||M==mn||q&&!o){if(x=S||q?{}:ol(e),!I)return S?Ac(e,Ku(x,e)):Ic(e,po(x,e))}else{if(!Fe[M])return o?e:{};x=Wc(e,M,I)}}_||(_=new dn);var V=_.get(e);if(V)return V;_.set(e,x),Ml(e)?e.forEach(function(ee){x.add(en(ee,t,i,ee,e,_))}):Rl(e)&&e.forEach(function(ee,pe){x.set(pe,en(ee,t,i,pe,e,_))});var J=N?S?Ba:Ma:S?Bt:mt,de=U?b:J(e);return Rt(de||e,function(ee,pe){de&&(pe=ee,ee=e[pe]),Fi(x,pe,en(ee,t,i,pe,e,_))}),x}function $u(e){var t=mt(e);return function(i){return bo(i,e,t)}}function bo(e,t,i){var a=i.length;if(e==null)return!a;for(e=Ge(e);a--;){var o=i[a],_=t[o],x=e[o];if(x===b&&!(o in e)||!_(x))return!1}return!0}function xo(e,t,i){if(typeof e!="function")throw new Zt(Ye);return Ki(function(){e.apply(b,i)},t)}function ki(e,t,i,a){var o=-1,_=Vr,x=!0,I=e.length,S=[],N=t.length;if(!I)return S;i&&(t=Xe(t,u(i))),a?(_=Ti,x=!1):t.length>=K&&(_=r,x=!1,t=new Cr(t));e:for(;++o<I;){var U=e[o],M=i==null?U:i(U);if(U=a||U!==0?U:0,x&&M===M){for(var q=N;q--;)if(t[q]===M)continue e;S.push(U)}else _(t,M,a)||S.push(U)}return S}var rr=$o(Cn),wo=$o(ba,!0);function Vu(e,t){var i=!0;return rr(e,function(a,o,_){return i=!!t(a,o,_),i}),i}function Ls(e,t,i){for(var a=-1,o=e.length;++a<o;){var _=e[a],x=t(_);if(x!=null&&(I===b?x===x&&!Gt(x):i(x,I)))var I=x,S=_}return S}function ju(e,t,i,a){var o=e.length;for(i=le(i),i<0&&(i=-i>o?0:o+i),a=a===b||a>o?o:le(a),a<0&&(a+=o),a=i>a?0:Dl(a);i<a;)e[i++]=t;return e}function Io(e,t){var i=[];return rr(e,function(a,o,_){t(a,o,_)&&i.push(a)}),i}function bt(e,t,i,a,o){var _=-1,x=e.length;for(i||(i=Bc),o||(o=[]);++_<x;){var I=e[_];t>0&&i(I)?t>1?bt(I,t-1,i,a,o):ln(o,I):a||(o[o.length]=I)}return o}var pa=Vo(),Ao=Vo(!0);function Cn(e,t){return e&&pa(e,t,mt)}function ba(e,t){return e&&Ao(e,t,mt)}function Os(e,t){return An(t,function(i){return zn(e[i])})}function Sr(e,t){t=sr(t,e);for(var i=0,a=t.length;e!=null&&i<a;)e=e[Sn(t[i++])];return i&&i==a?e:b}function Eo(e,t,i){var a=t(e);return ae(e)?a:ln(a,i(e))}function Ot(e){return e==null?e===b?cr:oi:Ar&&Ar in Ge(e)?Pc(e):qc(e)}function xa(e,t){return e>t}function Qu(e,t){return e!=null&&We.call(e,t)}function Xu(e,t){return e!=null&&t in Ge(e)}function Zu(e,t,i){return e>=Ct(t,i)&&e<ht(t,i)}function wa(e,t,i){for(var a=i?Ti:Vr,o=e[0].length,_=e.length,x=_,I=L(_),S=1/0,N=[];x--;){var U=e[x];x&&t&&(U=Xe(U,u(t))),S=Ct(U.length,S),I[x]=!i&&(t||o>=120&&U.length>=120)?new Cr(x&&U):b}U=e[0];var M=-1,q=I[0];e:for(;++M<o&&N.length<S;){var V=U[M],J=t?t(V):V;if(V=i||V!==0?V:0,!(q?r(q,J):a(N,J,i))){for(x=_;--x;){var de=I[x];if(!(de?r(de,J):a(e[x],J,i)))continue e}q&&q.push(J),N.push(V)}}return N}function Ju(e,t,i,a){return Cn(e,function(o,_,x){t(a,i(o),_,x)}),a}function Yi(e,t,i){t=sr(t,e),e=dl(e,t);var a=e==null?e:e[Sn(nn(t))];return a==null?b:ft(a,e,i)}function Co(e){return it(e)&&Ot(e)==mn}function ec(e){return it(e)&&Ot(e)==On}function tc(e){return it(e)&&Ot(e)==Vt}function zi(e,t,i,a,o){return e===t?!0:e==null||t==null||!it(e)&&!it(t)?e!==e&&t!==t:nc(e,t,i,a,zi,o)}function nc(e,t,i,a,o,_){var x=ae(e),I=ae(t),S=x?Gn:yt(e),N=I?Gn:yt(t);S=S==mn?ct:S,N=N==mn?ct:N;var U=S==ct,M=N==ct,q=S==N;if(q&&or(e)){if(!or(t))return!1;x=!0,U=!1}if(q&&!U)return _||(_=new dn),x||ii(e)?il(e,t,i,a,o,_):Lc(e,t,S,i,a,o,_);if(!(i&X)){var V=U&&We.call(e,"__wrapped__"),J=M&&We.call(t,"__wrapped__");if(V||J){var de=V?e.value():e,ee=J?t.value():t;return _||(_=new dn),o(de,ee,i,a,_)}}return q?(_||(_=new dn),Oc(e,t,i,a,o,_)):!1}function rc(e){return it(e)&&yt(e)==Tt}function Ia(e,t,i,a){var o=i.length,_=o,x=!a;if(e==null)return!_;for(e=Ge(e);o--;){var I=i[o];if(x&&I[2]?I[1]!==e[I[0]]:!(I[0]in e))return!1}for(;++o<_;){I=i[o];var S=I[0],N=e[S],U=I[1];if(x&&I[2]){if(N===b&&!(S in e))return!1}else{var M=new dn;if(a)var q=a(N,U,S,e,t,M);if(!(q===b?zi(U,N,X|ye,a,M):q))return!1}}return!0}function yo(e){if(!rt(e)||Fc(e))return!1;var t=zn(e)?ru:es;return t.test(Lr(e))}function ic(e){return it(e)&&Ot(e)==jt}function sc(e){return it(e)&&yt(e)==vt}function ac(e){return it(e)&&$s(e.length)&&!!qe[Ot(e)]}function So(e){return typeof e=="function"?e:e==null?Dt:typeof e=="object"?ae(e)?Oo(e[0],e[1]):Lo(e):jl(e)}function Aa(e){if(!Gi(e))return uu(e);var t=[];for(var i in Ge(e))We.call(e,i)&&i!="constructor"&&t.push(i);return t}function oc(e){if(!rt(e))return Hc(e);var t=Gi(e),i=[];for(var a in e)a=="constructor"&&(t||!We.call(e,a))||i.push(a);return i}function Ea(e,t){return e<t}function To(e,t){var i=-1,a=Mt(e)?L(e.length):[];return rr(e,function(o,_,x){a[++i]=t(o,_,x)}),a}function Lo(e){var t=Fa(e);return t.length==1&&t[0][2]?ul(t[0][0],t[0][1]):function(i){return i===e||Ia(i,e,t)}}function Oo(e,t){return Ya(e)&&ll(t)?ul(Sn(e),t):function(i){var a=Xa(i,e);return a===b&&a===t?Za(i,e):zi(t,a,X|ye)}}function Ps(e,t,i,a,o){e!==t&&pa(t,function(_,x){if(o||(o=new dn),rt(_))lc(e,t,x,i,Ps,a,o);else{var I=a?a(Ha(e,x),_,x+"",e,t,o):b;I===b&&(I=_),ga(e,x,I)}},Bt)}function lc(e,t,i,a,o,_,x){var I=Ha(e,i),S=Ha(t,i),N=x.get(S);if(N){ga(e,i,N);return}var U=_?_(I,S,i+"",e,t,x):b,M=U===b;if(M){var q=ae(S),V=!q&&or(S),J=!q&&!V&&ii(S);U=S,q||V||J?ae(I)?U=I:at(I)?U=Wt(I):V?(M=!1,U=zo(S,!0)):J?(M=!1,U=Ho(S,!0)):U=[]:$i(S)||Or(S)?(U=I,Or(I)?U=Fl(I):(!rt(I)||zn(I))&&(U=ol(S))):M=!1}M&&(x.set(S,U),o(U,S,a,_,x),x.delete(S)),ga(e,i,U)}function Po(e,t){var i=e.length;if(!!i)return t+=t<0?i:0,Yn(t,i)?e[t]:b}function No(e,t,i){t.length?t=Xe(t,function(_){return ae(_)?function(x){return Sr(x,_.length===1?_[0]:_)}:_}):t=[Dt];var a=-1;t=Xe(t,u(Z()));var o=To(e,function(_,x,I){var S=Xe(t,function(N){return N(_)});return{criteria:S,index:++a,value:_}});return la(o,function(_,x){return wc(_,x,i)})}function uc(e,t){return Uo(e,t,function(i,a){return Za(e,a)})}function Uo(e,t,i){for(var a=-1,o=t.length,_={};++a<o;){var x=t[a],I=Sr(e,x);i(I,x)&&Hi(_,sr(x,e),I)}return _}function cc(e){return function(t){return Sr(t,e)}}function Ca(e,t,i,a){var o=a?oa:tr,_=-1,x=t.length,I=e;for(e===t&&(t=Wt(t)),i&&(I=Xe(e,u(i)));++_<x;)for(var S=0,N=t[_],U=i?i(N):N;(S=o(I,U,S,a))>-1;)I!==e&&ws.call(I,S,1),ws.call(e,S,1);return e}function Ro(e,t){for(var i=e?t.length:0,a=i-1;i--;){var o=t[i];if(i==a||o!==_){var _=o;Yn(o)?ws.call(e,o,1):La(e,o)}}return e}function ya(e,t){return e+Es(fo()*(t-e+1))}function dc(e,t,i,a){for(var o=-1,_=ht(As((t-e)/(i||1)),0),x=L(_);_--;)x[a?_:++o]=e,e+=i;return x}function Sa(e,t){var i="";if(!e||t<1||t>Se)return i;do t%2&&(i+=e),t=Es(t/2),t&&(e+=e);while(t);return i}function me(e,t){return qa(cl(e,t,Dt),e+"")}function hc(e){return vo(si(e))}function _c(e,t){var i=si(e);return Ys(i,yr(t,0,i.length))}function Hi(e,t,i,a){if(!rt(e))return e;t=sr(t,e);for(var o=-1,_=t.length,x=_-1,I=e;I!=null&&++o<_;){var S=Sn(t[o]),N=i;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(o!=x){var U=I[S];N=a?a(U,S,I):b,N===b&&(N=rt(U)?U:Yn(t[o+1])?[]:{})}Fi(I,S,N),I=I[S]}return e}var Wo=Cs?function(e,t){return Cs.set(e,t),e}:Dt,fc=Is?function(e,t){return Is(e,"toString",{configurable:!0,enumerable:!1,value:eo(t),writable:!0})}:Dt;function mc(e){return Ys(si(e))}function tn(e,t,i){var a=-1,o=e.length;t<0&&(t=-t>o?0:o+t),i=i>o?o:i,i<0&&(i+=o),o=t>i?0:i-t>>>0,t>>>=0;for(var _=L(o);++a<o;)_[a]=e[a+t];return _}function gc(e,t){var i;return rr(e,function(a,o,_){return i=t(a,o,_),!i}),!!i}function Ns(e,t,i){var a=0,o=e==null?a:e.length;if(typeof t=="number"&&t===t&&o<=kt){for(;a<o;){var _=a+o>>>1,x=e[_];x!==null&&!Gt(x)&&(i?x<=t:x<t)?a=_+1:o=_}return o}return Ta(e,t,Dt,i)}function Ta(e,t,i,a){var o=0,_=e==null?0:e.length;if(_===0)return 0;t=i(t);for(var x=t!==t,I=t===null,S=Gt(t),N=t===b;o<_;){var U=Es((o+_)/2),M=i(e[U]),q=M!==b,V=M===null,J=M===M,de=Gt(M);if(x)var ee=a||J;else N?ee=J&&(a||q):I?ee=J&&q&&(a||!V):S?ee=J&&q&&!V&&(a||!de):V||de?ee=!1:ee=a?M<=t:M<t;ee?o=U+1:_=U}return Ct(_,Tn)}function Mo(e,t){for(var i=-1,a=e.length,o=0,_=[];++i<a;){var x=e[i],I=t?t(x):x;if(!i||!hn(I,S)){var S=I;_[o++]=x===0?0:x}}return _}function Bo(e){return typeof e=="number"?e:Gt(e)?St:+e}function qt(e){if(typeof e=="string")return e;if(ae(e))return Xe(e,qt)+"";if(Gt(e))return mo?mo.call(e):"";var t=e+"";return t=="0"&&1/e==-ze?"-0":t}function ir(e,t,i){var a=-1,o=Vr,_=e.length,x=!0,I=[],S=I;if(i)x=!1,o=Ti;else if(_>=K){var N=t?null:Sc(e);if(N)return un(N);x=!1,o=r,S=new Cr}else S=t?[]:I;e:for(;++a<_;){var U=e[a],M=t?t(U):U;if(U=i||U!==0?U:0,x&&M===M){for(var q=S.length;q--;)if(S[q]===M)continue e;t&&S.push(M),I.push(U)}else o(S,M,i)||(S!==I&&S.push(M),I.push(U))}return I}function La(e,t){return t=sr(t,e),e=dl(e,t),e==null||delete e[Sn(nn(t))]}function Do(e,t,i,a){return Hi(e,t,i(Sr(e,t)),a)}function Us(e,t,i,a){for(var o=e.length,_=a?o:-1;(a?_--:++_<o)&&t(e[_],_,e););return i?tn(e,a?0:_,a?_+1:o):tn(e,a?_+1:0,a?o:_)}function Fo(e,t){var i=e;return i instanceof we&&(i=i.value()),Li(t,function(a,o){return o.func.apply(o.thisArg,ln([a],o.args))},i)}function Oa(e,t,i){var a=e.length;if(a<2)return a?ir(e[0]):[];for(var o=-1,_=L(a);++o<a;)for(var x=e[o],I=-1;++I<a;)I!=o&&(_[o]=ki(_[o]||x,e[I],t,i));return ir(bt(_,1),t,i)}function ko(e,t,i){for(var a=-1,o=e.length,_=t.length,x={};++a<o;){var I=a<_?t[a]:b;i(x,e[a],I)}return x}function Pa(e){return at(e)?e:[]}function Na(e){return typeof e=="function"?e:Dt}function sr(e,t){return ae(e)?e:Ya(e,t)?[e]:ml(Ue(e))}var vc=me;function ar(e,t,i){var a=e.length;return i=i===b?a:i,!t&&i>=a?e:tn(e,t,i)}var Yo=iu||function(e){return Je.clearTimeout(e)};function zo(e,t){if(t)return e.slice();var i=e.length,a=lo?lo(i):new e.constructor(i);return e.copy(a),a}function Ua(e){var t=new e.constructor(e.byteLength);return new bs(t).set(new bs(e)),t}function pc(e,t){var i=t?Ua(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}function bc(e){var t=new e.constructor(e.source,Lt.exec(e));return t.lastIndex=e.lastIndex,t}function xc(e){return Di?Ge(Di.call(e)):{}}function Ho(e,t){var i=t?Ua(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function qo(e,t){if(e!==t){var i=e!==b,a=e===null,o=e===e,_=Gt(e),x=t!==b,I=t===null,S=t===t,N=Gt(t);if(!I&&!N&&!_&&e>t||_&&x&&S&&!I&&!N||a&&x&&S||!i&&S||!o)return 1;if(!a&&!_&&!N&&e<t||N&&i&&o&&!a&&!_||I&&i&&o||!x&&o||!S)return-1}return 0}function wc(e,t,i){for(var a=-1,o=e.criteria,_=t.criteria,x=o.length,I=i.length;++a<x;){var S=qo(o[a],_[a]);if(S){if(a>=I)return S;var N=i[a];return S*(N=="desc"?-1:1)}}return e.index-t.index}function Go(e,t,i,a){for(var o=-1,_=e.length,x=i.length,I=-1,S=t.length,N=ht(_-x,0),U=L(S+N),M=!a;++I<S;)U[I]=t[I];for(;++o<x;)(M||o<_)&&(U[i[o]]=e[o]);for(;N--;)U[I++]=e[o++];return U}function Ko(e,t,i,a){for(var o=-1,_=e.length,x=-1,I=i.length,S=-1,N=t.length,U=ht(_-I,0),M=L(U+N),q=!a;++o<U;)M[o]=e[o];for(var V=o;++S<N;)M[V+S]=t[S];for(;++x<I;)(q||o<_)&&(M[V+i[x]]=e[o++]);return M}function Wt(e,t){var i=-1,a=e.length;for(t||(t=L(a));++i<a;)t[i]=e[i];return t}function yn(e,t,i,a){var o=!i;i||(i={});for(var _=-1,x=t.length;++_<x;){var I=t[_],S=a?a(i[I],e[I],I,i,e):b;S===b&&(S=e[I]),o?Dn(i,I,S):Fi(i,I,S)}return i}function Ic(e,t){return yn(e,ka(e),t)}function Ac(e,t){return yn(e,sl(e),t)}function Rs(e,t){return function(i,a){var o=ae(i)?$r:Gu,_=t?t():{};return o(i,e,Z(a,2),_)}}function ti(e){return me(function(t,i){var a=-1,o=i.length,_=o>1?i[o-1]:b,x=o>2?i[2]:b;for(_=e.length>3&&typeof _=="function"?(o--,_):b,x&&Pt(i[0],i[1],x)&&(_=o<3?b:_,o=1),t=Ge(t);++a<o;){var I=i[a];I&&e(t,I,a,_)}return t})}function $o(e,t){return function(i,a){if(i==null)return i;if(!Mt(i))return e(i,a);for(var o=i.length,_=t?o:-1,x=Ge(i);(t?_--:++_<o)&&a(x[_],_,x)!==!1;);return i}}function Vo(e){return function(t,i,a){for(var o=-1,_=Ge(t),x=a(t),I=x.length;I--;){var S=x[e?I:++o];if(i(_[S],S,_)===!1)break}return t}}function Ec(e,t,i){var a=t&he,o=qi(e);function _(){var x=this&&this!==Je&&this instanceof _?o:e;return x.apply(a?i:this,arguments)}return _}function jo(e){return function(t){t=Ue(t);var i=re(t)?pt(t):b,a=i?i[0]:t.charAt(0),o=i?ar(i,1).join(""):t.slice(1);return a[e]()+o}}function ni(e){return function(t){return Li($l(Kl(t).replace(yi,"")),e,"")}}function qi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=ei(e.prototype),a=e.apply(i,t);return rt(a)?a:i}}function Cc(e,t,i){var a=qi(e);function o(){for(var _=arguments.length,x=L(_),I=_,S=ri(o);I--;)x[I]=arguments[I];var N=_<3&&x[0]!==S&&x[_-1]!==S?[]:At(x,S);if(_-=N.length,_<i)return el(e,t,Ws,o.placeholder,b,x,N,b,b,i-_);var U=this&&this!==Je&&this instanceof o?a:e;return ft(U,this,x)}return o}function Qo(e){return function(t,i,a){var o=Ge(t);if(!Mt(t)){var _=Z(i,3);t=mt(t),i=function(I){return _(o[I],I,o)}}var x=e(t,i,a);return x>-1?o[_?t[x]:x]:b}}function Xo(e){return kn(function(t){var i=t.length,a=i,o=Jt.prototype.thru;for(e&&t.reverse();a--;){var _=t[a];if(typeof _!="function")throw new Zt(Ye);if(o&&!x&&Fs(_)=="wrapper")var x=new Jt([],!0)}for(a=x?a:i;++a<i;){_=t[a];var I=Fs(_),S=I=="wrapper"?Da(_):b;S&&za(S[0])&&S[1]==(Y|De|_t|oe)&&!S[4].length&&S[9]==1?x=x[Fs(S[0])].apply(x,S[3]):x=_.length==1&&za(_)?x[I]():x.thru(_)}return function(){var N=arguments,U=N[0];if(x&&N.length==1&&ae(U))return x.plant(U).value();for(var M=0,q=i?t[M].apply(this,N):U;++M<i;)q=t[M].call(this,q);return q}})}function Ws(e,t,i,a,o,_,x,I,S,N){var U=t&Y,M=t&he,q=t&$e,V=t&(De|Pe),J=t&R,de=q?b:qi(e);function ee(){for(var pe=arguments.length,Ae=L(pe),Kt=pe;Kt--;)Ae[Kt]=arguments[Kt];if(V)var Nt=ri(ee),$t=g(Ae,Nt);if(a&&(Ae=Go(Ae,a,o,V)),_&&(Ae=Ko(Ae,_,x,V)),pe-=$t,V&&pe<N){var ot=At(Ae,Nt);return el(e,t,Ws,ee.placeholder,i,Ae,ot,I,S,N-pe)}var _n=M?i:this,qn=q?_n[e]:e;return pe=Ae.length,I?Ae=Gc(Ae,I):J&&pe>1&&Ae.reverse(),U&&S<pe&&(Ae.length=S),this&&this!==Je&&this instanceof ee&&(qn=de||qi(qn)),qn.apply(_n,Ae)}return ee}function Zo(e,t){return function(i,a){return Ju(i,e,t(a),{})}}function Ms(e,t){return function(i,a){var o;if(i===b&&a===b)return t;if(i!==b&&(o=i),a!==b){if(o===b)return a;typeof i=="string"||typeof a=="string"?(i=qt(i),a=qt(a)):(i=Bo(i),a=Bo(a)),o=e(i,a)}return o}}function Ra(e){return kn(function(t){return t=Xe(t,u(Z())),me(function(i){var a=this;return e(t,function(o){return ft(o,a,i)})})})}function Bs(e,t){t=t===b?" ":qt(t);var i=t.length;if(i<2)return i?Sa(t,e):t;var a=Sa(t,As(e/zt(t)));return re(t)?ar(pt(a),0,e).join(""):a.slice(0,e)}function yc(e,t,i,a){var o=t&he,_=qi(e);function x(){for(var I=-1,S=arguments.length,N=-1,U=a.length,M=L(U+S),q=this&&this!==Je&&this instanceof x?_:e;++N<U;)M[N]=a[N];for(;S--;)M[N++]=arguments[++I];return ft(q,o?i:this,M)}return x}function Jo(e){return function(t,i,a){return a&&typeof a!="number"&&Pt(t,i,a)&&(i=a=b),t=Hn(t),i===b?(i=t,t=0):i=Hn(i),a=a===b?t<i?1:-1:Hn(a),dc(t,i,a,e)}}function Ds(e){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=rn(t),i=rn(i)),e(t,i)}}function el(e,t,i,a,o,_,x,I,S,N){var U=t&De,M=U?x:b,q=U?b:x,V=U?_:b,J=U?b:_;t|=U?_t:st,t&=~(U?st:_t),t&Re||(t&=~(he|$e));var de=[e,t,o,V,M,J,q,I,S,N],ee=i.apply(b,de);return za(e)&&hl(ee,de),ee.placeholder=a,_l(ee,e,t)}function Wa(e){var t=dt[e];return function(i,a){if(i=rn(i),a=a==null?0:Ct(le(a),292),a&&_o(i)){var o=(Ue(i)+"e").split("e"),_=t(o[0]+"e"+(+o[1]+a));return o=(Ue(_)+"e").split("e"),+(o[0]+"e"+(+o[1]-a))}return t(i)}}var Sc=Zr&&1/un(new Zr([,-0]))[1]==ze?function(e){return new Zr(e)}:ro;function tl(e){return function(t){var i=yt(t);return i==Tt?et(t):i==vt?En(t):ds(t,e(t))}}function Fn(e,t,i,a,o,_,x,I){var S=t&$e;if(!S&&typeof e!="function")throw new Zt(Ye);var N=a?a.length:0;if(N||(t&=~(_t|st),a=o=b),x=x===b?x:ht(le(x),0),I=I===b?I:le(I),N-=o?o.length:0,t&st){var U=a,M=o;a=o=b}var q=S?b:Da(e),V=[e,t,i,a,o,U,M,_,x,I];if(q&&zc(V,q),e=V[0],t=V[1],i=V[2],a=V[3],o=V[4],I=V[9]=V[9]===b?S?0:e.length:ht(V[9]-N,0),!I&&t&(De|Pe)&&(t&=~(De|Pe)),!t||t==he)var J=Ec(e,t,i);else t==De||t==Pe?J=Cc(e,t,I):(t==_t||t==(he|_t))&&!o.length?J=yc(e,t,i,a):J=Ws.apply(b,V);var de=q?Wo:hl;return _l(de(J,V),e,t)}function nl(e,t,i,a){return e===b||hn(e,Xr[i])&&!We.call(a,i)?t:e}function rl(e,t,i,a,o,_){return rt(e)&&rt(t)&&(_.set(t,e),Ps(e,t,b,rl,_),_.delete(t)),e}function Tc(e){return $i(e)?b:e}function il(e,t,i,a,o,_){var x=i&X,I=e.length,S=t.length;if(I!=S&&!(x&&S>I))return!1;var N=_.get(e),U=_.get(t);if(N&&U)return N==t&&U==e;var M=-1,q=!0,V=i&ye?new Cr:b;for(_.set(e,t),_.set(t,e);++M<I;){var J=e[M],de=t[M];if(a)var ee=x?a(de,J,M,t,e,_):a(J,de,M,e,t,_);if(ee!==b){if(ee)continue;q=!1;break}if(V){if(!Oi(t,function(pe,Ae){if(!r(V,Ae)&&(J===pe||o(J,pe,i,a,_)))return V.push(Ae)})){q=!1;break}}else if(!(J===de||o(J,de,i,a,_))){q=!1;break}}return _.delete(e),_.delete(t),q}function Lc(e,t,i,a,o,_,x){switch(i){case Ut:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case On:return!(e.byteLength!=t.byteLength||!_(new bs(e),new bs(t)));case gn:case Vt:case pn:return hn(+e,+t);case Kn:return e.name==t.name&&e.message==t.message;case jt:case bn:return e==t+"";case Tt:var I=et;case vt:var S=a&X;if(I||(I=un),e.size!=t.size&&!S)return!1;var N=x.get(e);if(N)return N==t;a|=ye,x.set(e,t);var U=il(I(e),I(t),a,o,_,x);return x.delete(e),U;case fe:if(Di)return Di.call(e)==Di.call(t)}return!1}function Oc(e,t,i,a,o,_){var x=i&X,I=Ma(e),S=I.length,N=Ma(t),U=N.length;if(S!=U&&!x)return!1;for(var M=S;M--;){var q=I[M];if(!(x?q in t:We.call(t,q)))return!1}var V=_.get(e),J=_.get(t);if(V&&J)return V==t&&J==e;var de=!0;_.set(e,t),_.set(t,e);for(var ee=x;++M<S;){q=I[M];var pe=e[q],Ae=t[q];if(a)var Kt=x?a(Ae,pe,q,t,e,_):a(pe,Ae,q,e,t,_);if(!(Kt===b?pe===Ae||o(pe,Ae,i,a,_):Kt)){de=!1;break}ee||(ee=q=="constructor")}if(de&&!ee){var Nt=e.constructor,$t=t.constructor;Nt!=$t&&"constructor"in e&&"constructor"in t&&!(typeof Nt=="function"&&Nt instanceof Nt&&typeof $t=="function"&&$t instanceof $t)&&(de=!1)}return _.delete(e),_.delete(t),de}function kn(e){return qa(cl(e,b,bl),e+"")}function Ma(e){return Eo(e,mt,ka)}function Ba(e){return Eo(e,Bt,sl)}var Da=Cs?function(e){return Cs.get(e)}:ro;function Fs(e){for(var t=e.name+"",i=Jr[t],a=We.call(Jr,t)?i.length:0;a--;){var o=i[a],_=o.func;if(_==null||_==e)return o.name}return t}function ri(e){var t=We.call(d,"placeholder")?d:e;return t.placeholder}function Z(){var e=d.iteratee||to;return e=e===to?So:e,arguments.length?e(arguments[0],arguments[1]):e}function ks(e,t){var i=e.__data__;return Dc(t)?i[typeof t=="string"?"string":"hash"]:i.map}function Fa(e){for(var t=mt(e),i=t.length;i--;){var a=t[i],o=e[a];t[i]=[a,o,ll(o)]}return t}function Tr(e,t){var i=T(e,t);return yo(i)?i:b}function Pc(e){var t=We.call(e,Ar),i=e[Ar];try{e[Ar]=b;var a=!0}catch(_){}var o=vs.call(e);return a&&(t?e[Ar]=i:delete e[Ar]),o}var ka=_a?function(e){return e==null?[]:(e=Ge(e),An(_a(e),function(t){return co.call(e,t)}))}:io,sl=_a?function(e){for(var t=[];e;)ln(t,ka(e)),e=xs(e);return t}:io,yt=Ot;(fa&&yt(new fa(new ArrayBuffer(1)))!=Ut||Wi&&yt(new Wi)!=Tt||ma&&yt(ma.resolve())!=Ur||Zr&&yt(new Zr)!=vt||Mi&&yt(new Mi)!=Ln)&&(yt=function(e){var t=Ot(e),i=t==ct?e.constructor:b,a=i?Lr(i):"";if(a)switch(a){case _u:return Ut;case fu:return Tt;case mu:return Ur;case gu:return vt;case vu:return Ln}return t});function Nc(e,t,i){for(var a=-1,o=i.length;++a<o;){var _=i[a],x=_.size;switch(_.type){case"drop":e+=x;break;case"dropRight":t-=x;break;case"take":t=Ct(t,e+x);break;case"takeRight":e=ht(e,t-x);break}}return{start:e,end:t}}function Uc(e){var t=e.match(gr);return t?t[1].split(gi):[]}function al(e,t,i){t=sr(t,e);for(var a=-1,o=t.length,_=!1;++a<o;){var x=Sn(t[a]);if(!(_=e!=null&&i(e,x)))break;e=e[x]}return _||++a!=o?_:(o=e==null?0:e.length,!!o&&$s(o)&&Yn(x,o)&&(ae(e)||Or(e)))}function Rc(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&We.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function ol(e){return typeof e.constructor=="function"&&!Gi(e)?ei(xs(e)):{}}function Wc(e,t,i){var a=e.constructor;switch(t){case On:return Ua(e);case gn:case Vt:return new a(+e);case Ut:return pc(e,i);case $n:case Vn:case dr:case hr:case _r:case Qt:case fr:case Pn:case Rr:return Ho(e,i);case Tt:return new a;case pn:case bn:return new a(e);case jt:return bc(e);case vt:return new a;case fe:return xc(e)}}function Mc(e,t){var i=t.length;if(!i)return e;var a=i-1;return t[a]=(i>1?"& ":"")+t[a],t=t.join(i>2?", ":" "),e.replace(mi,`{
/* [wrapped with `+t+`] */
`)}function Bc(e){return ae(e)||Or(e)||!!(ho&&e&&e[ho])}function Yn(e,t){var i=typeof e;return t=t==null?Se:t,!!t&&(i=="number"||i!="symbol"&&Ii.test(e))&&e>-1&&e%1==0&&e<t}function Pt(e,t,i){if(!rt(i))return!1;var a=typeof t;return(a=="number"?Mt(i)&&Yn(t,i.length):a=="string"&&t in i)?hn(i[t],e):!1}function Ya(e,t){if(ae(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||Gt(e)?!0:Ji.test(e)||!Zi.test(e)||t!=null&&e in Ge(t)}function Dc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function za(e){var t=Fs(e),i=d[t];if(typeof i!="function"||!(t in we.prototype))return!1;if(e===i)return!0;var a=Da(i);return!!a&&e===a[0]}function Fc(e){return!!oo&&oo in e}var kc=ms?zn:so;function Gi(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||Xr;return e===i}function ll(e){return e===e&&!rt(e)}function ul(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==b||e in Ge(i))}}function Yc(e){var t=Gs(e,function(a){return i.size===ge&&i.clear(),a}),i=t.cache;return t}function zc(e,t){var i=e[1],a=t[1],o=i|a,_=o<(he|$e|Y),x=a==Y&&i==De||a==Y&&i==oe&&e[7].length<=t[8]||a==(Y|oe)&&t[7].length<=t[8]&&i==De;if(!(_||x))return e;a&he&&(e[2]=t[2],o|=i&he?0:Re);var I=t[3];if(I){var S=e[3];e[3]=S?Go(S,I,t[4]):I,e[4]=S?At(e[3],Ke):t[4]}return I=t[5],I&&(S=e[5],e[5]=S?Ko(S,I,t[6]):I,e[6]=S?At(e[5],Ke):t[6]),I=t[7],I&&(e[7]=I),a&Y&&(e[8]=e[8]==null?t[8]:Ct(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=o,e}function Hc(e){var t=[];if(e!=null)for(var i in Ge(e))t.push(i);return t}function qc(e){return vs.call(e)}function cl(e,t,i){return t=ht(t===b?e.length-1:t,0),function(){for(var a=arguments,o=-1,_=ht(a.length-t,0),x=L(_);++o<_;)x[o]=a[t+o];o=-1;for(var I=L(t+1);++o<t;)I[o]=a[o];return I[t]=i(x),ft(e,this,I)}}function dl(e,t){return t.length<2?e:Sr(e,tn(t,0,-1))}function Gc(e,t){for(var i=e.length,a=Ct(t.length,i),o=Wt(e);a--;){var _=t[a];e[a]=Yn(_,i)?o[_]:b}return e}function Ha(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var hl=fl(Wo),Ki=au||function(e,t){return Je.setTimeout(e,t)},qa=fl(fc);function _l(e,t,i){var a=t+"";return qa(e,Mc(a,Kc(Uc(a),i)))}function fl(e){var t=0,i=0;return function(){var a=cu(),o=_e-(a-i);if(i=a,o>0){if(++t>=te)return arguments[0]}else t=0;return e.apply(b,arguments)}}function Ys(e,t){var i=-1,a=e.length,o=a-1;for(t=t===b?a:t;++i<t;){var _=ya(i,o),x=e[_];e[_]=e[i],e[i]=x}return e.length=t,e}var ml=Yc(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(hi,function(i,a,o,_){t.push(o?_.replace(pi,"$1"):a||i)}),t});function Sn(e){if(typeof e=="string"||Gt(e))return e;var t=e+"";return t=="0"&&1/e==-ze?"-0":t}function Lr(e){if(e!=null){try{return gs.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Kc(e,t){return Rt(ur,function(i){var a="_."+i[0];t&i[1]&&!Vr(e,a)&&e.push(a)}),e.sort()}function gl(e){if(e instanceof we)return e.clone();var t=new Jt(e.__wrapped__,e.__chain__);return t.__actions__=Wt(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function $c(e,t,i){(i?Pt(e,t,i):t===b)?t=1:t=ht(le(t),0);var a=e==null?0:e.length;if(!a||t<1)return[];for(var o=0,_=0,x=L(As(a/t));o<a;)x[_++]=tn(e,o,o+=t);return x}function Vc(e){for(var t=-1,i=e==null?0:e.length,a=0,o=[];++t<i;){var _=e[t];_&&(o[a++]=_)}return o}function jc(){var e=arguments.length;if(!e)return[];for(var t=L(e-1),i=arguments[0],a=e;a--;)t[a-1]=arguments[a];return ln(ae(i)?Wt(i):[i],bt(t,1))}var Qc=me(function(e,t){return at(e)?ki(e,bt(t,1,at,!0)):[]}),Xc=me(function(e,t){var i=nn(t);return at(i)&&(i=b),at(e)?ki(e,bt(t,1,at,!0),Z(i,2)):[]}),Zc=me(function(e,t){var i=nn(t);return at(i)&&(i=b),at(e)?ki(e,bt(t,1,at,!0),b,i):[]});function Jc(e,t,i){var a=e==null?0:e.length;return a?(t=i||t===b?1:le(t),tn(e,t<0?0:t,a)):[]}function ed(e,t,i){var a=e==null?0:e.length;return a?(t=i||t===b?1:le(t),t=a-t,tn(e,0,t<0?0:t)):[]}function td(e,t){return e&&e.length?Us(e,Z(t,3),!0,!0):[]}function nd(e,t){return e&&e.length?Us(e,Z(t,3),!0):[]}function rd(e,t,i,a){var o=e==null?0:e.length;return o?(i&&typeof i!="number"&&Pt(e,t,i)&&(i=0,a=o),ju(e,t,i,a)):[]}function vl(e,t,i){var a=e==null?0:e.length;if(!a)return-1;var o=i==null?0:le(i);return o<0&&(o=ht(a+o,0)),er(e,Z(t,3),o)}function pl(e,t,i){var a=e==null?0:e.length;if(!a)return-1;var o=a-1;return i!==b&&(o=le(i),o=i<0?ht(a+o,0):Ct(o,a-1)),er(e,Z(t,3),o,!0)}function bl(e){var t=e==null?0:e.length;return t?bt(e,1):[]}function id(e){var t=e==null?0:e.length;return t?bt(e,ze):[]}function sd(e,t){var i=e==null?0:e.length;return i?(t=t===b?1:le(t),bt(e,t)):[]}function ad(e){for(var t=-1,i=e==null?0:e.length,a={};++t<i;){var o=e[t];a[o[0]]=o[1]}return a}function xl(e){return e&&e.length?e[0]:b}function od(e,t,i){var a=e==null?0:e.length;if(!a)return-1;var o=i==null?0:le(i);return o<0&&(o=ht(a+o,0)),tr(e,t,o)}function ld(e){var t=e==null?0:e.length;return t?tn(e,0,-1):[]}var ud=me(function(e){var t=Xe(e,Pa);return t.length&&t[0]===e[0]?wa(t):[]}),cd=me(function(e){var t=nn(e),i=Xe(e,Pa);return t===nn(i)?t=b:i.pop(),i.length&&i[0]===e[0]?wa(i,Z(t,2)):[]}),dd=me(function(e){var t=nn(e),i=Xe(e,Pa);return t=typeof t=="function"?t:b,t&&i.pop(),i.length&&i[0]===e[0]?wa(i,b,t):[]});function hd(e,t){return e==null?"":lu.call(e,t)}function nn(e){var t=e==null?0:e.length;return t?e[t-1]:b}function _d(e,t,i){var a=e==null?0:e.length;if(!a)return-1;var o=a;return i!==b&&(o=le(i),o=o<0?ht(a+o,0):Ct(o,a-1)),t===t?Ir(e,t,o):er(e,us,o,!0)}function fd(e,t){return e&&e.length?Po(e,le(t)):b}var md=me(wl);function wl(e,t){return e&&e.length&&t&&t.length?Ca(e,t):e}function gd(e,t,i){return e&&e.length&&t&&t.length?Ca(e,t,Z(i,2)):e}function vd(e,t,i){return e&&e.length&&t&&t.length?Ca(e,t,b,i):e}var pd=kn(function(e,t){var i=e==null?0:e.length,a=va(e,t);return Ro(e,Xe(t,function(o){return Yn(o,i)?+o:o}).sort(qo)),a});function bd(e,t){var i=[];if(!(e&&e.length))return i;var a=-1,o=[],_=e.length;for(t=Z(t,3);++a<_;){var x=e[a];t(x,a,e)&&(i.push(x),o.push(a))}return Ro(e,o),i}function Ga(e){return e==null?e:hu.call(e)}function xd(e,t,i){var a=e==null?0:e.length;return a?(i&&typeof i!="number"&&Pt(e,t,i)?(t=0,i=a):(t=t==null?0:le(t),i=i===b?a:le(i)),tn(e,t,i)):[]}function wd(e,t){return Ns(e,t)}function Id(e,t,i){return Ta(e,t,Z(i,2))}function Ad(e,t){var i=e==null?0:e.length;if(i){var a=Ns(e,t);if(a<i&&hn(e[a],t))return a}return-1}function Ed(e,t){return Ns(e,t,!0)}function Cd(e,t,i){return Ta(e,t,Z(i,2),!0)}function yd(e,t){var i=e==null?0:e.length;if(i){var a=Ns(e,t,!0)-1;if(hn(e[a],t))return a}return-1}function Sd(e){return e&&e.length?Mo(e):[]}function Td(e,t){return e&&e.length?Mo(e,Z(t,2)):[]}function Ld(e){var t=e==null?0:e.length;return t?tn(e,1,t):[]}function Od(e,t,i){return e&&e.length?(t=i||t===b?1:le(t),tn(e,0,t<0?0:t)):[]}function Pd(e,t,i){var a=e==null?0:e.length;return a?(t=i||t===b?1:le(t),t=a-t,tn(e,t<0?0:t,a)):[]}function Nd(e,t){return e&&e.length?Us(e,Z(t,3),!1,!0):[]}function Ud(e,t){return e&&e.length?Us(e,Z(t,3)):[]}var Rd=me(function(e){return ir(bt(e,1,at,!0))}),Wd=me(function(e){var t=nn(e);return at(t)&&(t=b),ir(bt(e,1,at,!0),Z(t,2))}),Md=me(function(e){var t=nn(e);return t=typeof t=="function"?t:b,ir(bt(e,1,at,!0),b,t)});function Bd(e){return e&&e.length?ir(e):[]}function Dd(e,t){return e&&e.length?ir(e,Z(t,2)):[]}function Fd(e,t){return t=typeof t=="function"?t:b,e&&e.length?ir(e,b,t):[]}function Ka(e){if(!(e&&e.length))return[];var t=0;return e=An(e,function(i){if(at(i))return t=ht(i.length,t),!0}),Ui(t,function(i){return Xe(e,Pi(i))})}function Il(e,t){if(!(e&&e.length))return[];var i=Ka(e);return t==null?i:Xe(i,function(a){return ft(t,b,a)})}var kd=me(function(e,t){return at(e)?ki(e,t):[]}),Yd=me(function(e){return Oa(An(e,at))}),zd=me(function(e){var t=nn(e);return at(t)&&(t=b),Oa(An(e,at),Z(t,2))}),Hd=me(function(e){var t=nn(e);return t=typeof t=="function"?t:b,Oa(An(e,at),b,t)}),qd=me(Ka);function Gd(e,t){return ko(e||[],t||[],Fi)}function Kd(e,t){return ko(e||[],t||[],Hi)}var $d=me(function(e){var t=e.length,i=t>1?e[t-1]:b;return i=typeof i=="function"?(e.pop(),i):b,Il(e,i)});function Al(e){var t=d(e);return t.__chain__=!0,t}function Vd(e,t){return t(e),e}function zs(e,t){return t(e)}var jd=kn(function(e){var t=e.length,i=t?e[0]:0,a=this.__wrapped__,o=function(_){return va(_,e)};return t>1||this.__actions__.length||!(a instanceof we)||!Yn(i)?this.thru(o):(a=a.slice(i,+i+(t?1:0)),a.__actions__.push({func:zs,args:[o],thisArg:b}),new Jt(a,this.__chain__).thru(function(_){return t&&!_.length&&_.push(b),_}))});function Qd(){return Al(this)}function Xd(){return new Jt(this.value(),this.__chain__)}function Zd(){this.__values__===b&&(this.__values__=Bl(this.value()));var e=this.__index__>=this.__values__.length,t=e?b:this.__values__[this.__index__++];return{done:e,value:t}}function Jd(){return this}function eh(e){for(var t,i=this;i instanceof Ss;){var a=gl(i);a.__index__=0,a.__values__=b,t?o.__wrapped__=a:t=a;var o=a;i=i.__wrapped__}return o.__wrapped__=e,t}function th(){var e=this.__wrapped__;if(e instanceof we){var t=e;return this.__actions__.length&&(t=new we(this)),t=t.reverse(),t.__actions__.push({func:zs,args:[Ga],thisArg:b}),new Jt(t,this.__chain__)}return this.thru(Ga)}function nh(){return Fo(this.__wrapped__,this.__actions__)}var rh=Rs(function(e,t,i){We.call(e,i)?++e[i]:Dn(e,i,1)});function ih(e,t,i){var a=ae(e)?as:Vu;return i&&Pt(e,t,i)&&(t=b),a(e,Z(t,3))}function sh(e,t){var i=ae(e)?An:Io;return i(e,Z(t,3))}var ah=Qo(vl),oh=Qo(pl);function lh(e,t){return bt(Hs(e,t),1)}function uh(e,t){return bt(Hs(e,t),ze)}function ch(e,t,i){return i=i===b?1:le(i),bt(Hs(e,t),i)}function El(e,t){var i=ae(e)?Rt:rr;return i(e,Z(t,3))}function Cl(e,t){var i=ae(e)?ra:wo;return i(e,Z(t,3))}var dh=Rs(function(e,t,i){We.call(e,i)?e[i].push(t):Dn(e,i,[t])});function hh(e,t,i,a){e=Mt(e)?e:si(e),i=i&&!a?le(i):0;var o=e.length;return i<0&&(i=ht(o+i,0)),Vs(e)?i<=o&&e.indexOf(t,i)>-1:!!o&&tr(e,t,i)>-1}var _h=me(function(e,t,i){var a=-1,o=typeof t=="function",_=Mt(e)?L(e.length):[];return rr(e,function(x){_[++a]=o?ft(t,x,i):Yi(x,t,i)}),_}),fh=Rs(function(e,t,i){Dn(e,i,t)});function Hs(e,t){var i=ae(e)?Xe:To;return i(e,Z(t,3))}function mh(e,t,i,a){return e==null?[]:(ae(t)||(t=t==null?[]:[t]),i=a?b:i,ae(i)||(i=i==null?[]:[i]),No(e,t,i))}var gh=Rs(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});function vh(e,t,i){var a=ae(e)?Li:Ni,o=arguments.length<3;return a(e,Z(t,4),i,o,rr)}function ph(e,t,i){var a=ae(e)?os:Ni,o=arguments.length<3;return a(e,Z(t,4),i,o,wo)}function bh(e,t){var i=ae(e)?An:Io;return i(e,Ks(Z(t,3)))}function xh(e){var t=ae(e)?vo:hc;return t(e)}function wh(e,t,i){(i?Pt(e,t,i):t===b)?t=1:t=le(t);var a=ae(e)?Hu:_c;return a(e,t)}function Ih(e){var t=ae(e)?qu:mc;return t(e)}function Ah(e){if(e==null)return 0;if(Mt(e))return Vs(e)?zt(e):e.length;var t=yt(e);return t==Tt||t==vt?e.size:Aa(e).length}function Eh(e,t,i){var a=ae(e)?Oi:gc;return i&&Pt(e,t,i)&&(t=b),a(e,Z(t,3))}var Ch=me(function(e,t){if(e==null)return[];var i=t.length;return i>1&&Pt(e,t[0],t[1])?t=[]:i>2&&Pt(t[0],t[1],t[2])&&(t=[t[0]]),No(e,bt(t,1),[])}),qs=su||function(){return Je.Date.now()};function yh(e,t){if(typeof t!="function")throw new Zt(Ye);return e=le(e),function(){if(--e<1)return t.apply(this,arguments)}}function yl(e,t,i){return t=i?b:t,t=e&&t==null?e.length:t,Fn(e,Y,b,b,b,b,t)}function Sl(e,t){var i;if(typeof t!="function")throw new Zt(Ye);return e=le(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=b),i}}var $a=me(function(e,t,i){var a=he;if(i.length){var o=At(i,ri($a));a|=_t}return Fn(e,a,t,i,o)}),Tl=me(function(e,t,i){var a=he|$e;if(i.length){var o=At(i,ri(Tl));a|=_t}return Fn(t,a,e,i,o)});function Ll(e,t,i){t=i?b:t;var a=Fn(e,De,b,b,b,b,b,t);return a.placeholder=Ll.placeholder,a}function Ol(e,t,i){t=i?b:t;var a=Fn(e,Pe,b,b,b,b,b,t);return a.placeholder=Ol.placeholder,a}function Pl(e,t,i){var a,o,_,x,I,S,N=0,U=!1,M=!1,q=!0;if(typeof e!="function")throw new Zt(Ye);t=rn(t)||0,rt(i)&&(U=!!i.leading,M="maxWait"in i,_=M?ht(rn(i.maxWait)||0,t):_,q="trailing"in i?!!i.trailing:q);function V(ot){var _n=a,qn=o;return a=o=b,N=ot,x=e.apply(qn,_n),x}function J(ot){return N=ot,I=Ki(pe,t),U?V(ot):x}function de(ot){var _n=ot-S,qn=ot-N,Ql=t-_n;return M?Ct(Ql,_-qn):Ql}function ee(ot){var _n=ot-S,qn=ot-N;return S===b||_n>=t||_n<0||M&&qn>=_}function pe(){var ot=qs();if(ee(ot))return Ae(ot);I=Ki(pe,de(ot))}function Ae(ot){return I=b,q&&a?V(ot):(a=o=b,x)}function Kt(){I!==b&&Yo(I),N=0,a=S=o=I=b}function Nt(){return I===b?x:Ae(qs())}function $t(){var ot=qs(),_n=ee(ot);if(a=arguments,o=this,S=ot,_n){if(I===b)return J(S);if(M)return Yo(I),I=Ki(pe,t),V(S)}return I===b&&(I=Ki(pe,t)),x}return $t.cancel=Kt,$t.flush=Nt,$t}var Sh=me(function(e,t){return xo(e,1,t)}),Th=me(function(e,t,i){return xo(e,rn(t)||0,i)});function Lh(e){return Fn(e,R)}function Gs(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Zt(Ye);var i=function(){var a=arguments,o=t?t.apply(this,a):a[0],_=i.cache;if(_.has(o))return _.get(o);var x=e.apply(this,a);return i.cache=_.set(o,x)||_,x};return i.cache=new(Gs.Cache||Bn),i}Gs.Cache=Bn;function Ks(e){if(typeof e!="function")throw new Zt(Ye);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Oh(e){return Sl(2,e)}var Ph=vc(function(e,t){t=t.length==1&&ae(t[0])?Xe(t[0],u(Z())):Xe(bt(t,1),u(Z()));var i=t.length;return me(function(a){for(var o=-1,_=Ct(a.length,i);++o<_;)a[o]=t[o].call(this,a[o]);return ft(e,this,a)})}),Va=me(function(e,t){var i=At(t,ri(Va));return Fn(e,_t,b,t,i)}),Nl=me(function(e,t){var i=At(t,ri(Nl));return Fn(e,st,b,t,i)}),Nh=kn(function(e,t){return Fn(e,oe,b,b,b,t)});function Uh(e,t){if(typeof e!="function")throw new Zt(Ye);return t=t===b?t:le(t),me(e,t)}function Rh(e,t){if(typeof e!="function")throw new Zt(Ye);return t=t==null?0:ht(le(t),0),me(function(i){var a=i[t],o=ar(i,0,t);return a&&ln(o,a),ft(e,this,o)})}function Wh(e,t,i){var a=!0,o=!0;if(typeof e!="function")throw new Zt(Ye);return rt(i)&&(a="leading"in i?!!i.leading:a,o="trailing"in i?!!i.trailing:o),Pl(e,t,{leading:a,maxWait:t,trailing:o})}function Mh(e){return yl(e,1)}function Bh(e,t){return Va(Na(t),e)}function Dh(){if(!arguments.length)return[];var e=arguments[0];return ae(e)?e:[e]}function Fh(e){return en(e,H)}function kh(e,t){return t=typeof t=="function"?t:b,en(e,H,t)}function Yh(e){return en(e,Ce|H)}function zh(e,t){return t=typeof t=="function"?t:b,en(e,Ce|H,t)}function Hh(e,t){return t==null||bo(e,t,mt(t))}function hn(e,t){return e===t||e!==e&&t!==t}var qh=Ds(xa),Gh=Ds(function(e,t){return e>=t}),Or=Co(function(){return arguments}())?Co:function(e){return it(e)&&We.call(e,"callee")&&!co.call(e,"callee")},ae=L.isArray,Kh=Kr?u(Kr):ec;function Mt(e){return e!=null&&$s(e.length)&&!zn(e)}function at(e){return it(e)&&Mt(e)}function $h(e){return e===!0||e===!1||it(e)&&Ot(e)==gn}var or=ou||so,Vh=is?u(is):tc;function jh(e){return it(e)&&e.nodeType===1&&!$i(e)}function Qh(e){if(e==null)return!0;if(Mt(e)&&(ae(e)||typeof e=="string"||typeof e.splice=="function"||or(e)||ii(e)||Or(e)))return!e.length;var t=yt(e);if(t==Tt||t==vt)return!e.size;if(Gi(e))return!Aa(e).length;for(var i in e)if(We.call(e,i))return!1;return!0}function Xh(e,t){return zi(e,t)}function Zh(e,t,i){i=typeof i=="function"?i:b;var a=i?i(e,t):b;return a===b?zi(e,t,b,i):!!a}function ja(e){if(!it(e))return!1;var t=Ot(e);return t==Kn||t==ai||typeof e.message=="string"&&typeof e.name=="string"&&!$i(e)}function Jh(e){return typeof e=="number"&&_o(e)}function zn(e){if(!rt(e))return!1;var t=Ot(e);return t==vn||t==Nr||t==Pr||t==He}function Ul(e){return typeof e=="number"&&e==le(e)}function $s(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Se}function rt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function it(e){return e!=null&&typeof e=="object"}var Rl=ss?u(ss):rc;function e_(e,t){return e===t||Ia(e,t,Fa(t))}function t_(e,t,i){return i=typeof i=="function"?i:b,Ia(e,t,Fa(t),i)}function n_(e){return Wl(e)&&e!=+e}function r_(e){if(kc(e))throw new se(lt);return yo(e)}function i_(e){return e===null}function s_(e){return e==null}function Wl(e){return typeof e=="number"||it(e)&&Ot(e)==pn}function $i(e){if(!it(e)||Ot(e)!=ct)return!1;var t=xs(e);if(t===null)return!0;var i=We.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&gs.call(i)==tu}var Qa=an?u(an):ic;function a_(e){return Ul(e)&&e>=-Se&&e<=Se}var Ml=Jn?u(Jn):sc;function Vs(e){return typeof e=="string"||!ae(e)&&it(e)&&Ot(e)==bn}function Gt(e){return typeof e=="symbol"||it(e)&&Ot(e)==fe}var ii=on?u(on):ac;function o_(e){return e===b}function l_(e){return it(e)&&yt(e)==Ln}function u_(e){return it(e)&&Ot(e)==li}var c_=Ds(Ea),d_=Ds(function(e,t){return e<=t});function Bl(e){if(!e)return[];if(Mt(e))return Vs(e)?pt(e):Wt(e);if(Ri&&e[Ri])return ke(e[Ri]());var t=yt(e),i=t==Tt?et:t==vt?un:si;return i(e)}function Hn(e){if(!e)return e===0?e:0;if(e=rn(e),e===ze||e===-ze){var t=e<0?-1:1;return t*gt}return e===e?e:0}function le(e){var t=Hn(e),i=t%1;return t===t?i?t-i:t:0}function Dl(e){return e?yr(le(e),0,Ze):0}function rn(e){if(typeof e=="number")return e;if(Gt(e))return St;if(rt(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=rt(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=hs(e);var i=wi.test(e);return i||vr.test(e)?rs(e.slice(2),i?2:8):xi.test(e)?St:+e}function Fl(e){return yn(e,Bt(e))}function h_(e){return e?yr(le(e),-Se,Se):e===0?e:0}function Ue(e){return e==null?"":qt(e)}var __=ti(function(e,t){if(Gi(t)||Mt(t)){yn(t,mt(t),e);return}for(var i in t)We.call(t,i)&&Fi(e,i,t[i])}),kl=ti(function(e,t){yn(t,Bt(t),e)}),js=ti(function(e,t,i,a){yn(t,Bt(t),e,a)}),f_=ti(function(e,t,i,a){yn(t,mt(t),e,a)}),m_=kn(va);function g_(e,t){var i=ei(e);return t==null?i:po(i,t)}var v_=me(function(e,t){e=Ge(e);var i=-1,a=t.length,o=a>2?t[2]:b;for(o&&Pt(t[0],t[1],o)&&(a=1);++i<a;)for(var _=t[i],x=Bt(_),I=-1,S=x.length;++I<S;){var N=x[I],U=e[N];(U===b||hn(U,Xr[N])&&!We.call(e,N))&&(e[N]=_[N])}return e}),p_=me(function(e){return e.push(b,rl),ft(Yl,b,e)});function b_(e,t){return ls(e,Z(t,3),Cn)}function x_(e,t){return ls(e,Z(t,3),ba)}function w_(e,t){return e==null?e:pa(e,Z(t,3),Bt)}function I_(e,t){return e==null?e:Ao(e,Z(t,3),Bt)}function A_(e,t){return e&&Cn(e,Z(t,3))}function E_(e,t){return e&&ba(e,Z(t,3))}function C_(e){return e==null?[]:Os(e,mt(e))}function y_(e){return e==null?[]:Os(e,Bt(e))}function Xa(e,t,i){var a=e==null?b:Sr(e,t);return a===b?i:a}function S_(e,t){return e!=null&&al(e,t,Qu)}function Za(e,t){return e!=null&&al(e,t,Xu)}var T_=Zo(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=vs.call(t)),e[t]=i},eo(Dt)),L_=Zo(function(e,t,i){t!=null&&typeof t.toString!="function"&&(t=vs.call(t)),We.call(e,t)?e[t].push(i):e[t]=[i]},Z),O_=me(Yi);function mt(e){return Mt(e)?go(e):Aa(e)}function Bt(e){return Mt(e)?go(e,!0):oc(e)}function P_(e,t){var i={};return t=Z(t,3),Cn(e,function(a,o,_){Dn(i,t(a,o,_),a)}),i}function N_(e,t){var i={};return t=Z(t,3),Cn(e,function(a,o,_){Dn(i,o,t(a,o,_))}),i}var U_=ti(function(e,t,i){Ps(e,t,i)}),Yl=ti(function(e,t,i,a){Ps(e,t,i,a)}),R_=kn(function(e,t){var i={};if(e==null)return i;var a=!1;t=Xe(t,function(_){return _=sr(_,e),a||(a=_.length>1),_}),yn(e,Ba(e),i),a&&(i=en(i,Ce|ut|H,Tc));for(var o=t.length;o--;)La(i,t[o]);return i});function W_(e,t){return zl(e,Ks(Z(t)))}var M_=kn(function(e,t){return e==null?{}:uc(e,t)});function zl(e,t){if(e==null)return{};var i=Xe(Ba(e),function(a){return[a]});return t=Z(t),Uo(e,i,function(a,o){return t(a,o[0])})}function B_(e,t,i){t=sr(t,e);var a=-1,o=t.length;for(o||(o=1,e=b);++a<o;){var _=e==null?b:e[Sn(t[a])];_===b&&(a=o,_=i),e=zn(_)?_.call(e):_}return e}function D_(e,t,i){return e==null?e:Hi(e,t,i)}function F_(e,t,i,a){return a=typeof a=="function"?a:b,e==null?e:Hi(e,t,i,a)}var Hl=tl(mt),ql=tl(Bt);function k_(e,t,i){var a=ae(e),o=a||or(e)||ii(e);if(t=Z(t,4),i==null){var _=e&&e.constructor;o?i=a?new _:[]:rt(e)?i=zn(_)?ei(xs(e)):{}:i={}}return(o?Rt:Cn)(e,function(x,I,S){return t(i,x,I,S)}),i}function Y_(e,t){return e==null?!0:La(e,t)}function z_(e,t,i){return e==null?e:Do(e,t,Na(i))}function H_(e,t,i,a){return a=typeof a=="function"?a:b,e==null?e:Do(e,t,Na(i),a)}function si(e){return e==null?[]:n(e,mt(e))}function q_(e){return e==null?[]:n(e,Bt(e))}function G_(e,t,i){return i===b&&(i=t,t=b),i!==b&&(i=rn(i),i=i===i?i:0),t!==b&&(t=rn(t),t=t===t?t:0),yr(rn(e),t,i)}function K_(e,t,i){return t=Hn(t),i===b?(i=t,t=0):i=Hn(i),e=rn(e),Zu(e,t,i)}function $_(e,t,i){if(i&&typeof i!="boolean"&&Pt(e,t,i)&&(t=i=b),i===b&&(typeof t=="boolean"?(i=t,t=b):typeof e=="boolean"&&(i=e,e=b)),e===b&&t===b?(e=0,t=1):(e=Hn(e),t===b?(t=e,e=0):t=Hn(t)),e>t){var a=e;e=t,t=a}if(i||e%1||t%1){var o=fo();return Ct(e+o*(t-e+ns("1e-"+((o+"").length-1))),t)}return ya(e,t)}var V_=ni(function(e,t,i){return t=t.toLowerCase(),e+(i?Gl(t):t)});function Gl(e){return Ja(Ue(e).toLowerCase())}function Kl(e){return e=Ue(e),e&&e.replace(Ai,p).replace(Xs,"")}function j_(e,t,i){e=Ue(e),t=qt(t);var a=e.length;i=i===b?a:yr(le(i),0,a);var o=i;return i-=t.length,i>=0&&e.slice(i,o)==t}function Q_(e){return e=Ue(e),e&&Qi.test(e)?e.replace(Xt,w):e}function X_(e){return e=Ue(e),e&&_i.test(e)?e.replace(Mr,"\\$&"):e}var Z_=ni(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),J_=ni(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),ef=jo("toLowerCase");function tf(e,t,i){e=Ue(e),t=le(t);var a=t?zt(e):0;if(!t||a>=t)return e;var o=(t-a)/2;return Bs(Es(o),i)+e+Bs(As(o),i)}function nf(e,t,i){e=Ue(e),t=le(t);var a=t?zt(e):0;return t&&a<t?e+Bs(t-a,i):e}function rf(e,t,i){e=Ue(e),t=le(t);var a=t?zt(e):0;return t&&a<t?Bs(t-a,i)+e:e}function sf(e,t,i){return i||t==null?t=0:t&&(t=+t),du(Ue(e).replace(mr,""),t||0)}function af(e,t,i){return(i?Pt(e,t,i):t===b)?t=1:t=le(t),Sa(Ue(e),t)}function of(){var e=arguments,t=Ue(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var lf=ni(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});function uf(e,t,i){return i&&typeof i!="number"&&Pt(e,t,i)&&(t=i=b),i=i===b?Ze:i>>>0,i?(e=Ue(e),e&&(typeof t=="string"||t!=null&&!Qa(t))&&(t=qt(t),!t&&re(e))?ar(pt(e),0,i):e.split(t,i)):[]}var cf=ni(function(e,t,i){return e+(i?" ":"")+Ja(t)});function df(e,t,i){return e=Ue(e),i=i==null?0:yr(le(i),0,e.length),t=qt(t),e.slice(i,i+t.length)==t}function hf(e,t,i){var a=d.templateSettings;i&&Pt(e,t,i)&&(t=b),e=Ue(e),t=js({},t,a,nl);var o=js({},t.imports,a.imports,nl),_=mt(o),x=n(o,_),I,S,N=0,U=t.interpolate||Qn,M="__p += '",q=ha((t.escape||Qn).source+"|"+U.source+"|"+(U===di?bi:Qn).source+"|"+(t.evaluate||Qn).source+"|$","g"),V="//# sourceURL="+(We.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Js+"]")+`
`;e.replace(q,function(ee,pe,Ae,Kt,Nt,$t){return Ae||(Ae=Kt),M+=e.slice(N,$t).replace(Dr,f),pe&&(I=!0,M+=`' +
__e(`+pe+`) +
'`),Nt&&(S=!0,M+=`';
`+Nt+`;
__p += '`),Ae&&(M+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),N=$t+ee.length,ee}),M+=`';
`;var J=We.call(t,"variable")&&t.variable;if(!J)M=`with (obj) {
`+M+`
}
`;else if(Br.test(J))throw new se(Me);M=(S?M.replace(Vi,""):M).replace(Wr,"$1").replace(jn,"$1;"),M="function("+(J||"obj")+`) {
`+(J?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(S?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+M+`return __p
}`;var de=Vl(function(){return Oe(_,V+"return "+M).apply(b,x)});if(de.source=M,ja(de))throw de;return de}function _f(e){return Ue(e).toLowerCase()}function ff(e){return Ue(e).toUpperCase()}function mf(e,t,i){if(e=Ue(e),e&&(i||t===b))return hs(e);if(!e||!(t=qt(t)))return e;var a=pt(e),o=pt(t),_=s(a,o),x=l(a,o)+1;return ar(a,_,x).join("")}function gf(e,t,i){if(e=Ue(e),e&&(i||t===b))return e.slice(0,cn(e)+1);if(!e||!(t=qt(t)))return e;var a=pt(e),o=l(a,pt(t))+1;return ar(a,0,o).join("")}function vf(e,t,i){if(e=Ue(e),e&&(i||t===b))return e.replace(mr,"");if(!e||!(t=qt(t)))return e;var a=pt(e),o=s(a,pt(t));return ar(a,o).join("")}function pf(e,t){var i=z,a=Q;if(rt(t)){var o="separator"in t?t.separator:o;i="length"in t?le(t.length):i,a="omission"in t?qt(t.omission):a}e=Ue(e);var _=e.length;if(re(e)){var x=pt(e);_=x.length}if(i>=_)return e;var I=i-zt(a);if(I<1)return a;var S=x?ar(x,0,I).join(""):e.slice(0,I);if(o===b)return S+a;if(x&&(I+=S.length-I),Qa(o)){if(e.slice(I).search(o)){var N,U=S;for(o.global||(o=ha(o.source,Ue(Lt.exec(o))+"g")),o.lastIndex=0;N=o.exec(U);)var M=N.index;S=S.slice(0,M===b?I:M)}}else if(e.indexOf(qt(o),I)!=I){var q=S.lastIndexOf(o);q>-1&&(S=S.slice(0,q))}return S+a}function bf(e){return e=Ue(e),e&&ji.test(e)?e.replace(ui,Et):e}var xf=ni(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),Ja=jo("toUpperCase");function $l(e,t,i){return e=Ue(e),t=i?b:t,t===b?j(e)?ca(e):aa(e):e.match(t)||[]}var Vl=me(function(e,t){try{return ft(e,b,t)}catch(i){return ja(i)?i:new se(i)}}),wf=kn(function(e,t){return Rt(t,function(i){i=Sn(i),Dn(e,i,$a(e[i],e))}),e});function If(e){var t=e==null?0:e.length,i=Z();return e=t?Xe(e,function(a){if(typeof a[1]!="function")throw new Zt(Ye);return[i(a[0]),a[1]]}):[],me(function(a){for(var o=-1;++o<t;){var _=e[o];if(ft(_[0],this,a))return ft(_[1],this,a)}})}function Af(e){return $u(en(e,Ce))}function eo(e){return function(){return e}}function Ef(e,t){return e==null||e!==e?t:e}var Cf=Xo(),yf=Xo(!0);function Dt(e){return e}function to(e){return So(typeof e=="function"?e:en(e,Ce))}function Sf(e){return Lo(en(e,Ce))}function Tf(e,t){return Oo(e,en(t,Ce))}var Lf=me(function(e,t){return function(i){return Yi(i,e,t)}}),Of=me(function(e,t){return function(i){return Yi(e,i,t)}});function no(e,t,i){var a=mt(t),o=Os(t,a);i==null&&!(rt(t)&&(o.length||!a.length))&&(i=t,t=e,e=this,o=Os(t,mt(t)));var _=!(rt(i)&&"chain"in i)||!!i.chain,x=zn(e);return Rt(o,function(I){var S=t[I];e[I]=S,x&&(e.prototype[I]=function(){var N=this.__chain__;if(_||N){var U=e(this.__wrapped__),M=U.__actions__=Wt(this.__actions__);return M.push({func:S,args:arguments,thisArg:e}),U.__chain__=N,U}return S.apply(e,ln([this.value()],arguments))})}),e}function Pf(){return Je._===this&&(Je._=nu),this}function ro(){}function Nf(e){return e=le(e),me(function(t){return Po(t,e)})}var Uf=Ra(Xe),Rf=Ra(as),Wf=Ra(Oi);function jl(e){return Ya(e)?Pi(Sn(e)):cc(e)}function Mf(e){return function(t){return e==null?b:Sr(e,t)}}var Bf=Jo(),Df=Jo(!0);function io(){return[]}function so(){return!1}function Ff(){return{}}function kf(){return""}function Yf(){return!0}function zf(e,t){if(e=le(e),e<1||e>Se)return[];var i=Ze,a=Ct(e,Ze);t=Z(t),e-=Ze;for(var o=Ui(a,t);++i<e;)t(i);return o}function Hf(e){return ae(e)?Xe(e,Sn):Gt(e)?[e]:Wt(ml(Ue(e)))}function qf(e){var t=++eu;return Ue(e)+t}var Gf=Ms(function(e,t){return e+t},0),Kf=Wa("ceil"),$f=Ms(function(e,t){return e/t},1),Vf=Wa("floor");function jf(e){return e&&e.length?Ls(e,Dt,xa):b}function Qf(e,t){return e&&e.length?Ls(e,Z(t,2),xa):b}function Xf(e){return cs(e,Dt)}function Zf(e,t){return cs(e,Z(t,2))}function Jf(e){return e&&e.length?Ls(e,Dt,Ea):b}function em(e,t){return e&&e.length?Ls(e,Z(t,2),Ea):b}var tm=Ms(function(e,t){return e*t},1),nm=Wa("round"),rm=Ms(function(e,t){return e-t},0);function im(e){return e&&e.length?Qr(e,Dt):0}function sm(e,t){return e&&e.length?Qr(e,Z(t,2)):0}return d.after=yh,d.ary=yl,d.assign=__,d.assignIn=kl,d.assignInWith=js,d.assignWith=f_,d.at=m_,d.before=Sl,d.bind=$a,d.bindAll=wf,d.bindKey=Tl,d.castArray=Dh,d.chain=Al,d.chunk=$c,d.compact=Vc,d.concat=jc,d.cond=If,d.conforms=Af,d.constant=eo,d.countBy=rh,d.create=g_,d.curry=Ll,d.curryRight=Ol,d.debounce=Pl,d.defaults=v_,d.defaultsDeep=p_,d.defer=Sh,d.delay=Th,d.difference=Qc,d.differenceBy=Xc,d.differenceWith=Zc,d.drop=Jc,d.dropRight=ed,d.dropRightWhile=td,d.dropWhile=nd,d.fill=rd,d.filter=sh,d.flatMap=lh,d.flatMapDeep=uh,d.flatMapDepth=ch,d.flatten=bl,d.flattenDeep=id,d.flattenDepth=sd,d.flip=Lh,d.flow=Cf,d.flowRight=yf,d.fromPairs=ad,d.functions=C_,d.functionsIn=y_,d.groupBy=dh,d.initial=ld,d.intersection=ud,d.intersectionBy=cd,d.intersectionWith=dd,d.invert=T_,d.invertBy=L_,d.invokeMap=_h,d.iteratee=to,d.keyBy=fh,d.keys=mt,d.keysIn=Bt,d.map=Hs,d.mapKeys=P_,d.mapValues=N_,d.matches=Sf,d.matchesProperty=Tf,d.memoize=Gs,d.merge=U_,d.mergeWith=Yl,d.method=Lf,d.methodOf=Of,d.mixin=no,d.negate=Ks,d.nthArg=Nf,d.omit=R_,d.omitBy=W_,d.once=Oh,d.orderBy=mh,d.over=Uf,d.overArgs=Ph,d.overEvery=Rf,d.overSome=Wf,d.partial=Va,d.partialRight=Nl,d.partition=gh,d.pick=M_,d.pickBy=zl,d.property=jl,d.propertyOf=Mf,d.pull=md,d.pullAll=wl,d.pullAllBy=gd,d.pullAllWith=vd,d.pullAt=pd,d.range=Bf,d.rangeRight=Df,d.rearg=Nh,d.reject=bh,d.remove=bd,d.rest=Uh,d.reverse=Ga,d.sampleSize=wh,d.set=D_,d.setWith=F_,d.shuffle=Ih,d.slice=xd,d.sortBy=Ch,d.sortedUniq=Sd,d.sortedUniqBy=Td,d.split=uf,d.spread=Rh,d.tail=Ld,d.take=Od,d.takeRight=Pd,d.takeRightWhile=Nd,d.takeWhile=Ud,d.tap=Vd,d.throttle=Wh,d.thru=zs,d.toArray=Bl,d.toPairs=Hl,d.toPairsIn=ql,d.toPath=Hf,d.toPlainObject=Fl,d.transform=k_,d.unary=Mh,d.union=Rd,d.unionBy=Wd,d.unionWith=Md,d.uniq=Bd,d.uniqBy=Dd,d.uniqWith=Fd,d.unset=Y_,d.unzip=Ka,d.unzipWith=Il,d.update=z_,d.updateWith=H_,d.values=si,d.valuesIn=q_,d.without=kd,d.words=$l,d.wrap=Bh,d.xor=Yd,d.xorBy=zd,d.xorWith=Hd,d.zip=qd,d.zipObject=Gd,d.zipObjectDeep=Kd,d.zipWith=$d,d.entries=Hl,d.entriesIn=ql,d.extend=kl,d.extendWith=js,no(d,d),d.add=Gf,d.attempt=Vl,d.camelCase=V_,d.capitalize=Gl,d.ceil=Kf,d.clamp=G_,d.clone=Fh,d.cloneDeep=Yh,d.cloneDeepWith=zh,d.cloneWith=kh,d.conformsTo=Hh,d.deburr=Kl,d.defaultTo=Ef,d.divide=$f,d.endsWith=j_,d.eq=hn,d.escape=Q_,d.escapeRegExp=X_,d.every=ih,d.find=ah,d.findIndex=vl,d.findKey=b_,d.findLast=oh,d.findLastIndex=pl,d.findLastKey=x_,d.floor=Vf,d.forEach=El,d.forEachRight=Cl,d.forIn=w_,d.forInRight=I_,d.forOwn=A_,d.forOwnRight=E_,d.get=Xa,d.gt=qh,d.gte=Gh,d.has=S_,d.hasIn=Za,d.head=xl,d.identity=Dt,d.includes=hh,d.indexOf=od,d.inRange=K_,d.invoke=O_,d.isArguments=Or,d.isArray=ae,d.isArrayBuffer=Kh,d.isArrayLike=Mt,d.isArrayLikeObject=at,d.isBoolean=$h,d.isBuffer=or,d.isDate=Vh,d.isElement=jh,d.isEmpty=Qh,d.isEqual=Xh,d.isEqualWith=Zh,d.isError=ja,d.isFinite=Jh,d.isFunction=zn,d.isInteger=Ul,d.isLength=$s,d.isMap=Rl,d.isMatch=e_,d.isMatchWith=t_,d.isNaN=n_,d.isNative=r_,d.isNil=s_,d.isNull=i_,d.isNumber=Wl,d.isObject=rt,d.isObjectLike=it,d.isPlainObject=$i,d.isRegExp=Qa,d.isSafeInteger=a_,d.isSet=Ml,d.isString=Vs,d.isSymbol=Gt,d.isTypedArray=ii,d.isUndefined=o_,d.isWeakMap=l_,d.isWeakSet=u_,d.join=hd,d.kebabCase=Z_,d.last=nn,d.lastIndexOf=_d,d.lowerCase=J_,d.lowerFirst=ef,d.lt=c_,d.lte=d_,d.max=jf,d.maxBy=Qf,d.mean=Xf,d.meanBy=Zf,d.min=Jf,d.minBy=em,d.stubArray=io,d.stubFalse=so,d.stubObject=Ff,d.stubString=kf,d.stubTrue=Yf,d.multiply=tm,d.nth=fd,d.noConflict=Pf,d.noop=ro,d.now=qs,d.pad=tf,d.padEnd=nf,d.padStart=rf,d.parseInt=sf,d.random=$_,d.reduce=vh,d.reduceRight=ph,d.repeat=af,d.replace=of,d.result=B_,d.round=nm,d.runInContext=C,d.sample=xh,d.size=Ah,d.snakeCase=lf,d.some=Eh,d.sortedIndex=wd,d.sortedIndexBy=Id,d.sortedIndexOf=Ad,d.sortedLastIndex=Ed,d.sortedLastIndexBy=Cd,d.sortedLastIndexOf=yd,d.startCase=cf,d.startsWith=df,d.subtract=rm,d.sum=im,d.sumBy=sm,d.template=hf,d.times=zf,d.toFinite=Hn,d.toInteger=le,d.toLength=Dl,d.toLower=_f,d.toNumber=rn,d.toSafeInteger=h_,d.toString=Ue,d.toUpper=ff,d.trim=mf,d.trimEnd=gf,d.trimStart=vf,d.truncate=pf,d.unescape=bf,d.uniqueId=qf,d.upperCase=xf,d.upperFirst=Ja,d.each=El,d.eachRight=Cl,d.first=xl,no(d,function(){var e={};return Cn(d,function(t,i){We.call(d.prototype,i)||(e[i]=t)}),e}(),{chain:!1}),d.VERSION=lr,Rt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),Rt(["drop","take"],function(e,t){we.prototype[e]=function(i){i=i===b?1:ht(le(i),0);var a=this.__filtered__&&!t?new we(this):this.clone();return a.__filtered__?a.__takeCount__=Ct(i,a.__takeCount__):a.__views__.push({size:Ct(i,Ze),type:e+(a.__dir__<0?"Right":"")}),a},we.prototype[e+"Right"]=function(i){return this.reverse()[e](i).reverse()}}),Rt(["filter","map","takeWhile"],function(e,t){var i=t+1,a=i==Te||i==ne;we.prototype[e]=function(o){var _=this.clone();return _.__iteratees__.push({iteratee:Z(o,3),type:i}),_.__filtered__=_.__filtered__||a,_}}),Rt(["head","last"],function(e,t){var i="take"+(t?"Right":"");we.prototype[e]=function(){return this[i](1).value()[0]}}),Rt(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");we.prototype[e]=function(){return this.__filtered__?new we(this):this[i](1)}}),we.prototype.compact=function(){return this.filter(Dt)},we.prototype.find=function(e){return this.filter(e).head()},we.prototype.findLast=function(e){return this.reverse().find(e)},we.prototype.invokeMap=me(function(e,t){return typeof e=="function"?new we(this):this.map(function(i){return Yi(i,e,t)})}),we.prototype.reject=function(e){return this.filter(Ks(Z(e)))},we.prototype.slice=function(e,t){e=le(e);var i=this;return i.__filtered__&&(e>0||t<0)?new we(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==b&&(t=le(t),i=t<0?i.dropRight(-t):i.take(t-e)),i)},we.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},we.prototype.toArray=function(){return this.take(Ze)},Cn(we.prototype,function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),o=d[a?"take"+(t=="last"?"Right":""):t],_=a||/^find/.test(t);!o||(d.prototype[t]=function(){var x=this.__wrapped__,I=a?[1]:arguments,S=x instanceof we,N=I[0],U=S||ae(x),M=function(pe){var Ae=o.apply(d,ln([pe],I));return a&&q?Ae[0]:Ae};U&&i&&typeof N=="function"&&N.length!=1&&(S=U=!1);var q=this.__chain__,V=!!this.__actions__.length,J=_&&!q,de=S&&!V;if(!_&&U){x=de?x:new we(this);var ee=e.apply(x,I);return ee.__actions__.push({func:zs,args:[M],thisArg:b}),new Jt(ee,q)}return J&&de?e.apply(this,I):(ee=this.thru(M),J?a?ee.value()[0]:ee.value():ee)})}),Rt(["pop","push","shift","sort","splice","unshift"],function(e){var t=fs[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var o=arguments;if(a&&!this.__chain__){var _=this.value();return t.apply(ae(_)?_:[],o)}return this[i](function(x){return t.apply(ae(x)?x:[],o)})}}),Cn(we.prototype,function(e,t){var i=d[t];if(i){var a=i.name+"";We.call(Jr,a)||(Jr[a]=[]),Jr[a].push({name:t,func:i})}}),Jr[Ws(b,$e).name]=[{name:"wrapper",func:b}],we.prototype.clone=pu,we.prototype.reverse=bu,we.prototype.value=xu,d.prototype.at=jd,d.prototype.chain=Qd,d.prototype.commit=Xd,d.prototype.next=Zd,d.prototype.plant=eh,d.prototype.reverse=th,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=nh,d.prototype.first=d.prototype.head,Ri&&(d.prototype[Ri]=Jd),d},_s=da();Je._=_s,fn=function(){return _s}.call(c,ue,c,Ie),fn!==b&&(Ie.exports=fn)}).call(this)},278:function(Ie,c){var ue,fn,b;(function(lr,K){if(!0)fn=[Ie],ue=K,b=typeof ue=="function"?ue.apply(c,fn):ue,b!==void 0&&(Ie.exports=b);else var lt})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:this,function(lr){var K,lt;if(!((lt=(K=globalThis.chrome)==null?void 0:K.runtime)==null?void 0:lt.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser=="undefined"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const Ye="The message port closed before a response was received.",Me=Be=>{const ge={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(ge).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class Ke extends WeakMap{constructor(z,Q=void 0){super(Q);this.createItem=z}get(z){return this.has(z)||this.set(z,this.createItem(z)),super.get(z)}}const Ce=R=>R&&typeof R=="object"&&typeof R.then=="function",ut=(R,z)=>(...Q)=>{Be.runtime.lastError?R.reject(new Error(Be.runtime.lastError.message)):z.singleCallbackArg||Q.length<=1&&z.singleCallbackArg!==!1?R.resolve(Q[0]):R.resolve(Q)},H=R=>R==1?"argument":"arguments",X=(R,z)=>function(te,..._e){if(_e.length<z.minArgs)throw new Error(`Expected at least ${z.minArgs} ${H(z.minArgs)} for ${R}(), got ${_e.length}`);if(_e.length>z.maxArgs)throw new Error(`Expected at most ${z.maxArgs} ${H(z.maxArgs)} for ${R}(), got ${_e.length}`);return new Promise((Te,Ve)=>{if(z.fallbackToNoCallback)try{te[R](..._e,ut({resolve:Te,reject:Ve},z))}catch(ne){te[R](..._e),z.fallbackToNoCallback=!1,z.noCallback=!0,Te()}else z.noCallback?(te[R](..._e),Te()):te[R](..._e,ut({resolve:Te,reject:Ve},z))})},ye=(R,z,Q)=>new Proxy(z,{apply(te,_e,Te){return Q.call(_e,R,...Te)}});let he=Function.call.bind(Object.prototype.hasOwnProperty);const $e=(R,z={},Q={})=>{let te=Object.create(null),_e={has(Ve,ne){return ne in R||ne in te},get(Ve,ne,ze){if(ne in te)return te[ne];if(!(ne in R))return;let Se=R[ne];if(typeof Se=="function")if(typeof z[ne]=="function")Se=ye(R,R[ne],z[ne]);else if(he(Q,ne)){let gt=X(ne,Q[ne]);Se=ye(R,R[ne],gt)}else Se=Se.bind(R);else if(typeof Se=="object"&&Se!==null&&(he(z,ne)||he(Q,ne)))Se=$e(Se,z[ne],Q[ne]);else if(he(Q,"*"))Se=$e(Se,z[ne],Q["*"]);else return Object.defineProperty(te,ne,{configurable:!0,enumerable:!0,get(){return R[ne]},set(gt){R[ne]=gt}}),Se;return te[ne]=Se,Se},set(Ve,ne,ze,Se){return ne in te?te[ne]=ze:R[ne]=ze,!0},defineProperty(Ve,ne,ze){return Reflect.defineProperty(te,ne,ze)},deleteProperty(Ve,ne){return Reflect.deleteProperty(te,ne)}},Te=Object.create(R);return new Proxy(Te,_e)},Re=R=>({addListener(z,Q,...te){z.addListener(R.get(Q),...te)},hasListener(z,Q){return z.hasListener(R.get(Q))},removeListener(z,Q){z.removeListener(R.get(Q))}}),De=new Ke(R=>typeof R!="function"?R:function(Q){const te=$e(Q,{},{getContent:{minArgs:0,maxArgs:0}});R(te)}),Pe=new Ke(R=>typeof R!="function"?R:function(Q,te,_e){let Te=!1,Ve,ne=new Promise(St=>{Ve=function(Ze){Te=!0,St(Ze)}}),ze;try{ze=R(Q,te,Ve)}catch(St){ze=Promise.reject(St)}const Se=ze!==!0&&Ce(ze);if(ze!==!0&&!Se&&!Te)return!1;const gt=St=>{St.then(Ze=>{_e(Ze)},Ze=>{let Tn;Ze&&(Ze instanceof Error||typeof Ze.message=="string")?Tn=Ze.message:Tn="An unexpected error occurred",_e({__mozWebExtensionPolyfillReject__:!0,message:Tn})}).catch(Ze=>{})};return gt(Se?ze:ne),!0}),_t=({reject:R,resolve:z},Q)=>{Be.runtime.lastError?Be.runtime.lastError.message===Ye?z():R(new Error(Be.runtime.lastError.message)):Q&&Q.__mozWebExtensionPolyfillReject__?R(new Error(Q.message)):z(Q)},st=(R,z,Q,...te)=>{if(te.length<z.minArgs)throw new Error(`Expected at least ${z.minArgs} ${H(z.minArgs)} for ${R}(), got ${te.length}`);if(te.length>z.maxArgs)throw new Error(`Expected at most ${z.maxArgs} ${H(z.maxArgs)} for ${R}(), got ${te.length}`);return new Promise((_e,Te)=>{const Ve=_t.bind(null,{resolve:_e,reject:Te});te.push(Ve),Q.sendMessage(...te)})},Y={devtools:{network:{onRequestFinished:Re(De)}},runtime:{onMessage:Re(Pe),onMessageExternal:Re(Pe),sendMessage:st.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:st.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},oe={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return ge.privacy={network:{"*":oe},services:{"*":oe},websites:{"*":oe}},$e(Be,Y,ge)};lr.exports=Me(chrome)}else lr.exports=globalThis.browser})}},ao={};function Ft(Ie){var c=ao[Ie];if(c!==void 0)return c.exports;var ue=ao[Ie]={id:Ie,loaded:!1,exports:{}};return Xl[Ie].call(ue.exports,ue,ue.exports,Ft),ue.loaded=!0,ue.exports}Ft.n=Ie=>{var c=Ie&&Ie.__esModule?()=>Ie.default:()=>Ie;return Ft.d(c,{a:c}),c},Ft.d=(Ie,c)=>{for(var ue in c)Ft.o(c,ue)&&!Ft.o(Ie,ue)&&Object.defineProperty(Ie,ue,{enumerable:!0,get:c[ue]})},Ft.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(Ie){if(typeof window=="object")return window}}(),Ft.o=(Ie,c)=>Object.prototype.hasOwnProperty.call(Ie,c),Ft.nmd=Ie=>(Ie.paths=[],Ie.children||(Ie.children=[]),Ie);var am={};(()=>{"use strict";var Ie=Ft(278),c=Ft.n(Ie),ue=Ft(3760);const b={RECORD_WEBCAM:1,DISABLE_COPY_PASTE:2,MANUAL_REVIEW:3,STUDENT_PHOTO:4,STUDENT_ID:5,ROOM_SCAN:6,RECORD_AUDIO:7,DISABLE_PRINTING:9,SIMULATED_NOT_PROCTORED:10,AUDIT_EXAM:11,RECORD_SCREEN:12,SINGLE_DISPLAY:13,BROWSER_GUARD:14,DISABLE_TABS:15,CLOSE_TABS:16,FORCE_FULLSCREEN:17,FOCUS_WINDOW:18,BASIC_CALCULATOR:19,LIVE_POP_IN:20,SEARCH_AND_DESTROY:21,MULTI_DEVICE_DETECTION:22,RECORD_WEB_TRAFFIC:23,ALLOWED_SITE_URLS:24,NETWORK_SPEED_TEST:25,WEBCAM_FAILSAFE:26,ALLOWED_APPLICATIONS:27,SCIENTIFIC_CALCULATOR:28,PAUSE_EXAM_SESSION:29,ALLOW_DISALLOW_DOWNLOADING_VIDEOS:30,CAMERA_WINDOW:31,ON_OFF_ADMIN_DASHBOARD:32,STUDENT_TUTORIAL:35,NET_PROMOTER_SCORE:36,AUTH_STEPS_OBJECT_DETECTION:42,SUPPORT_CHAT:45,HOTKEY_DETECTION:100},K={NONE:"",PAUSED:"paused",INACTIVE:"inactive",PRELAUNCH:"prelaunch",ROOMSCAN:"roomscan",ACTIVE:"active",SUBMITTED:"submitted",OVERRIDE:"override",FRESH:"fresh"},lt="honorlockKeepAlive";let Ye,Me;function Be(){Ye=browser.runtime.connect({name:lt}),Ye.onDisconnect.addListener(Be),Ye.onMessage.addListener(ut)}function ge(){c().runtime.onConnect.hasListener(Ce)||c().runtime.onConnect.addListener(Ce)}function Ke(){!c().runtime.onConnect.hasListener(Ce)||c().runtime.onConnect.removeListener(Ce)}function Ce(u){Me=setTimeout(H,25e4,u),u.name===lt&&(u.onMessage.addListener(ut),u.onDisconnect.addListener(X))}function ut(u,n){}function H(u){X(),u.disconnect()}function X(){clearTimeout(Me)}var ye=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class he{constructor(n,r){this._isBackgroundInitialized=!1,this.handleExtensionOnInitialization=l=>ye(this,null,function*(){if(!this._isActivatingHonorlockExtension(l))return;const{extensionControl:g,userPermissionsControl:p}=this.moduleProxies;yield g.handleExtensionStartup(),yield p.checkIfRequiredPermissionsAreActive(),this.onStoreReady(this._clearStateAndReInitializeModules)}),this._clearStateAndReInitializeModules=()=>ye(this,null,function*(){yield this.clearStoreState(),this._resetModules()}),this._moduleInstances=r,this._backgroundStateStore=n,this._backgroundStateStore.setupStoreMemberProxies(this._moduleInstances);const{backgroundStateListeners:s}=this._moduleInstances;s.init(this.moduleProxies)}get isBackgroundInitialized(){return this._isBackgroundInitialized}set isBackgroundInitialized(n){this._isBackgroundInitialized=n}get moduleProxies(){return this._backgroundStateStore.storeMemberProxies}onStoreReady(n){this._backgroundStateStore.onReady(n)}rebuildState(){return ye(this,null,function*(){var n;if(!!((n=this._backgroundStateStore)==null?void 0:n.isReady))try{yield this._backgroundStateStore.rebuildStoreState()}catch(r){}})}clearStoreState(){return ye(this,null,function*(){var n;!((n=this._backgroundStateStore)==null?void 0:n.isReady)||(yield this._backgroundStateStore.clear())})}_isActivatingHonorlockExtension(n){const r=c().runtime.getManifest();return["install","update"].includes(n.reason)||n.id===c().runtime.id&&n.version===r.version}_resetModules(){for(const n in this.moduleProxies)typeof this.moduleProxies[n].resetState=="function"&&this.moduleProxies[n].resetState()}}const $e=he;var Re=Ft(8778),De=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class Pe{constructor(){this._indexedDbName="honorlock-background-state",this._storeName="honorlockBackgroundState",this._storeDescription="Honorlock extension background state",this._storeMemberProxies={},this._isReady=!1,this._store=Re.createInstance({name:this._indexedDbName,storeName:this._storeName,description:this._storeDescription,driver:Re.INDEXEDDB}),this._store.ready().then(()=>this._isReady=!0)}get isReady(){return this._isReady}get storeMemberProxies(){return this._storeMemberProxies}onReady(n){if(this._isReady){n();return}this._store.ready().then(()=>n())}rebuildStoreState(){return De(this,null,function*(){const n=yield this._store.keys();yield Promise.all(this._buildGetStatePromises(n))})}clear(){return De(this,null,function*(){try{yield this._store.clear()}catch(n){}})}setupStoreMemberProxies(n){for(const r in n)this._storeMemberProxies[r]=new Proxy(n[r],{set:(s,l,g)=>this._storeMemberProxySetTrap(r,s,String(l),g)})}_storeMemberProxySetTrap(n,r,s,l){return s.startsWith("_SYNC_")&&this._set(`${n}:${s}`,l).catch(g=>{}),r[s]=l,!0}_buildGetStatePromises(n){return n.map(r=>{const s=r.split(":"),l=s[0],g=s[1];if(!!this._storeMemberProxies[l])return new Promise((p,w)=>{this._get(r).then(f=>{typeof f!==void 0&&(this._storeMemberProxies[l][g]=f),p()}).catch(f=>{w(f)})})})}saveLocalStorageToBackgroundStateStore(){return De(this,null,function*(){const n=yield c().storage.local.get();this._set("localStorage",n)})}_set(n,r){return De(this,null,function*(){try{yield this._store.setItem(n,r)}catch(s){}})}_get(n){return De(this,null,function*(){try{return yield this._store.getItem(n)}catch(r){}})}}const _t=Pe;var st=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});function Y(){return st(this,null,function*(){return new Promise((u,n)=>{try{chrome.system.display.getInfo(r=>{u(r)})}catch(r){n(r)}})})}function oe(u,n){return st(this,null,function*(){return new Promise((r,s)=>{try{chrome.desktopCapture.chooseDesktopMedia(u,n,l=>{r(l)})}catch(l){s(l)}})})}function R(u){const n=(r,s)=>{var l;const g=r.message||r.action;if((s==null?void 0:s.id)!==((l=c().runtime)==null?void 0:l.id)||!g||!u[g])return;const p=u[g]({message:r,sender:s});if(!(0,ue.isUndefined)(p))return Promise.resolve(p)};c().runtime.onMessage.addListener(n)}function z(u){const n=(r,s)=>{var l;if(!((l=s.tab)==null?void 0:l.id)||!r.source||!u[r.source])return;const g=u[r.source]({message:r,sender:s});if(!(0,ue.isUndefined)(g))return Promise.resolve(g)};c().runtime.onMessageExternal.addListener(n)}function Q(u){c().webNavigation.onCompleted.hasListener(u)||c().webNavigation.onCompleted.addListener(u)}function te(u,n){return st(this,null,function*(){const r=yield c().tabs.query(u);if(!!(r==null?void 0:r.length))for(const s of r){if(!s.id)return;const l=yield c().webNavigation.getAllFrames({tabId:s.id});if(!(l==null?void 0:l.length))return;for(const g of l)n(s,g)}})}var _e=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class Te{constructor(){this._extensionMessageListenerHandlers={store_exam_tab_information:({sender:n})=>{var r;return(r=this._examControl)==null?void 0:r.storeExamTabInformation(n)},update_is_exam_currently_submitting:({message:n})=>{var r;return(r=this._examControl)==null?void 0:r.setIsExamCurrentlySubmitting(Boolean(n.is_exam_currently_submitting))},update_active_webcam_label:({message:n})=>{var r;return(r=this._examControl)==null?void 0:r.updateActiveInExamWebcamLabel(n)},update_is_exam_timer_expired:({message:n})=>{var r;return(r=this._examControl)==null?void 0:r.setIsExamTimerExpired(Boolean(n.is_exam_timer_expired))},update_exam_submission_log_data:({message:n})=>{var r;return(r=this._examControl)==null?void 0:r.setExamSubmissionLogData(n.exam_submission_log_data||null)},start_platform_watcher:({sender:n})=>{var r;return(r=this._platformWatcher)==null?void 0:r.start(n)},platform_acknowledge:({sender:n})=>{var r;return(r=this._platformWatcher)==null?void 0:r.handleAcknowledgeMessage(n)},stop_platform_watcher:({sender:n})=>{var r;return(r=this._platformWatcher)==null?void 0:r.stop(n)},disable_new_tabs:()=>{var n;return(n=this._allowedBrowserAccess)==null?void 0:n.enableBlockNewTabs()},enable_new_tabs:()=>{var n;return(n=this._allowedBrowserAccess)==null?void 0:n.disableBlockNewTabs()},add_whitelist_url:({message:n})=>{var r;return(r=this._allowedBrowserAccess)==null?void 0:r.addUrlToAllowList(n.url)},proctoring_init:({message:n})=>{var r;return(r=this._proctoringActions)==null?void 0:r.initializeProctoring(n)},proctoring_end:({message:n})=>{var r;return(r=this._proctoringActions)==null?void 0:r.endProctoring(n)},track_web_traffic:({message:n,sender:r})=>{var s;return(s=this._proctoringActions)==null?void 0:s.setupTrackWebTraffic(n,r)},enable_browser_guard:n=>_e(this,[n],function*({sender:r}){var s,l;return yield(l=this._browserGuard)==null?void 0:l.start((s=r.tab)==null?void 0:s.id)}),disable_browser_guard:n=>_e(this,[n],function*({message:r}){var s,l;return yield(l=this._browserGuard)==null?void 0:l.disableBrowserGuardAndUpdateExamState(!!((s=r.var)==null?void 0:s.skip_disable_allow_list))}),begin_fullscreen:()=>_e(this,null,function*(){var n;return yield(n=this._browserGuard)==null?void 0:n.fullscreen.start()}),resize_guard_window:()=>_e(this,null,function*(){var n;return yield(n=this._browserGuard)==null?void 0:n.fullscreen.start()}),exit_fullscreen:()=>_e(this,null,function*(){var n;return yield(n=this._browserGuard)==null?void 0:n.fullscreen.stop()}),stop_idle_browser_capture:()=>_e(this,null,function*(){var n;return yield(n=this._browserGuard)==null?void 0:n.stopIdleBrowserCapture()})},this._extensionMessageExternalListenerHandlers={HL_LAUNCH_PROCTORING:({message:n,sender:r})=>this._handleLaunchProctoringIframeMessage(n,r),HL_CAMERA_BLADE:({message:n,sender:r})=>this._handleCameraBladeMessage(n,r)},R(this._extensionMessageListenerHandlers),z(this._extensionMessageExternalListenerHandlers)}_handleLaunchProctoringIframeMessage(n,r){var s,l;(s=this._universalLaunchControl)==null||s.handleLaunchProctoringIframeMessage(n,r),(l=this._installedExtensionControl)==null||l.handleLaunchProctoringIframeMessage(n,r)}_handleCameraBladeMessage(n,r){var s;(s=this._installedExtensionControl)==null||s.handleCameraBladeMessage(n,r)}init(n){const{examControl:r,platformWatcher:s,allowedBrowserAccess:l,proctoringActions:g,browserGuard:p,universalLaunchControl:w,installedExtensionsControl:f}=n;this._examControl=r,this._platformWatcher=s,this._allowedBrowserAccess=l,this._proctoringActions=g,this._browserGuard=p,this._universalLaunchControl=w,this._installedExtensionControl=f}}const Ve=Te;var ne=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class ze{constructor(){this._translations=null}init(){this._translations||this._getTranslationsFromLocalStorage().catch(n=>{})}getTranslations(){return ne(this,null,function*(){return this._translations||(yield this._getTranslationsFromLocalStorage())})}getTranslation(n){return ne(this,null,function*(){return this._translations?(0,ue.get)(this._translations,n,""):(0,ue.get)(yield this._getTranslationsFromLocalStorage(),n,"")})}set _SYNC_translations(n){this._translations=n,c().storage.local.set({translations:n}).catch(r=>{})}setTranslations(n){this._SYNC_translations=n}_getTranslationsFromLocalStorage(){return ne(this,null,function*(){const n=yield c().storage.local.get(["translations"]);return(n==null?void 0:n.translations)&&(this._SYNC_translations=n.translations),this._translations})}resetState(){this._translations=null}}const Se=ze;var gt=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});function St(){const u=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return u?parseInt(u[2],10):0}function Ze(){var u;let n=((u=navigator.userAgentData)==null?void 0:u.platform)||navigator.platform;return n=n.toLowerCase(),n.indexOf("mac")>-1?"mac":n.indexOf("win")>-1?"win":"chrome"}function Tn(){return gt(this,null,function*(){return(yield Y()).filter(r=>r.isPrimary)[0].workArea})}var kt=Object.defineProperty,ur=Object.getOwnPropertySymbols,mn=Object.prototype.hasOwnProperty,Gn=Object.prototype.propertyIsEnumerable,Pr=(u,n,r)=>n in u?kt(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r,gn=(u,n)=>{for(var r in n||(n={}))mn.call(n,r)&&Pr(u,r,n[r]);if(ur)for(var r of ur(n))Gn.call(n,r)&&Pr(u,r,n[r]);return u},Vt=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class ai{constructor(){this._getUserChromeVersion=St,this._getUserDisplayBounds=Tn,this._getUserOperatingSystem=Ze,this._sessionData=null}init(){this._operatingSystem||(this._SYNC_operatingSystem=this._getUserOperatingSystem()),this._chromeBrowserVersion||(this._SYNC_chromeBrowserVersion=this._getUserChromeVersion())}get isMacUser(){return this._operatingSystem==="mac"}get isWindowsUser(){return this._operatingSystem==="win"}get isChromebookUser(){return this._operatingSystem==="chrome"}set _SYNC_operatingSystem(n){this._operatingSystem=n}set _SYNC_chromeBrowserVersion(n){this._chromeBrowserVersion=n}getDisplayBounds(){return Vt(this,null,function*(){return this._displayBounds||(yield this.resetDisplayBounds())})}set _SYNC_displayBounds(n){this._displayBounds=n}resetDisplayBounds(){return Vt(this,null,function*(){const n=yield this._getUserDisplayBounds();return this._SYNC_displayBounds=n,n})}getSessionData(){return Vt(this,null,function*(){return this._sessionData||(yield this._checkLocalStorageForUserSessionData())})}set _SYNC_sessionData(n){const r=gn(gn({},this._sessionData),n);c().storage.local.set(r).catch(s=>{}),this._sessionData=r}setSessionData(n){this._SYNC_sessionData=n}_checkLocalStorageForUserSessionData(){return Vt(this,null,function*(){const n=yield c().storage.local.get(["student_attempt","bypass_status","student_email","student_id","session_id","student_name","lms_student_id","lms_student_name"]);return Object.keys(n).length&&(this._SYNC_sessionData=n),this._sessionData})}resetState(){this._SYNC_operatingSystem=this._getUserOperatingSystem(),this._SYNC_chromeBrowserVersion=this._getUserChromeVersion(),delete this._displayBounds,this._sessionData=null}}const Kn=ai;var vn=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class Nr{constructor(){this._studentTutorialUrl="https://prep.honorlock.com",this._setupWebNavigationOnCompletedListener=Q,this._handleNavigationCompleteEvent=n=>vn(this,null,function*(){const r=n.tabId,s=n.url;!this._studentTutorialUrl||!s.includes(this._studentTutorialUrl)||(yield this._injectExtensionCheckScript(r))})}init(){!this._studentTutorialUrl||(this._checkIfOnStudentTutorial().then(()=>{this._setupWebNavigationOnCompletedListener(this._handleNavigationCompleteEvent)}),c().runtime.onConnect.addListener(n=>{n.onMessage.addListener(r=>{})}))}_checkIfOnStudentTutorial(){return vn(this,null,function*(){const n=yield c().tabs.query({url:`${this._studentTutorialUrl}/*`});if(!!(n==null?void 0:n.length))for(const r of n){if(!r.id)return;yield this._injectExtensionCheckScript(r.id),yield c().tabs.sendMessage(r.id,{action:"get_extID",data:c().runtime.id})}})}_injectExtensionCheckScript(n){return vn(this,null,function*(){!n||(yield c().scripting.executeScript({target:{tabId:n},files:["js/student_tutorial_check.js"]}))})}}const Tt=Nr;var pn=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class oi{constructor(){this._setupWebNavigationOnCompletedListener=Q,this._setupExtensionOnMessageListener=R,this._supportChat={regex:new RegExp(/\bhttps:\/\/.*\.honorlock\.com\/extension\/.*\/support-chat\b/i),tabId:null,frameId:null},this._extensionMessageListenerHandlers={chat_client_update_livechat_group_id:({message:n})=>this._handleUpdateLiveChatGroupId(n),chat_client_maximize_livechat:({message:n})=>this._sendMessageToChatClientIframe(n,this._supportChat),chat_client_minimize_livechat:({message:n})=>this._sendMessageToChatClientIframe(n,this._supportChat),chat_client_hide_livechat:({message:n})=>this._sendMessageToChatClientIframe(n,this._supportChat),chat_client_destroy_livechat:({message:n})=>this._sendMessageToChatClientIframe(n,this._supportChat)},this._handleNavigationCompleteEvent=n=>pn(this,null,function*(){const r=n.url,s=n.tabId,l=n.frameId,g=this._examControl&&this._examControl.isLaunchUnificationFlagOn&&this._examControl.universalLaunchTabId&&this._examControl.universalLaunchFrameId&&s===this._examControl.universalLaunchTabId&&l===this._examControl.universalLaunchFrameId;!(this._supportChat.regex.test(r)||g)||(this._SYNC_supportChatTabId=s,this._SYNC_supportChatFrameId=l,!(!this._supportChat.tabId||!this._supportChat.frameId)&&(yield this._injectChatClientMessagesScript(this._supportChat.tabId,this._supportChat.frameId)))}),this._handleOnMessageExternalEvent=(n,r)=>{var s;if(n.source!=="HL_CHAT_CLIENT"||!((s=r.tab)==null?void 0:s.id))return;const l=this._buildChatClientMessage(n);c().tabs.sendMessage(r.tab.id,l).catch(g=>{})}}init(n){const{examControl:r}=n;this._examControl=r,this._setupWebNavigationOnCompletedListener(this._handleNavigationCompleteEvent),this._setupExtensionOnMessageListener(this._extensionMessageListenerHandlers),this._setupExtensionOnMessageExternalListener()}set _SYNC_supportChatTabId(n){this._supportChat.tabId=n}set _SYNC_supportChatFrameId(n){this._supportChat.frameId=n}_handleUpdateLiveChatGroupId(n){!this._supportChat.tabId||(this._sendMessageToChatClientIframe(n,this._supportChat),c().tabs.update(this._supportChat.tabId,{active:!0}).catch(r=>{}))}_sendMessageToChatClientIframe(n,r){if(!r.tabId||!r.frameId)return;const s=this._buildChatClientMessage(n);c().tabs.sendMessage(r.tabId,s,{frameId:r.frameId}).catch(l=>{})}_injectChatClientMessagesScript(n,r){return pn(this,null,function*(){c().scripting.executeScript({target:{tabId:n,frameIds:[r]},files:["js/chat_client_messages.js"]}).catch(s=>{})})}_buildChatClientMessage(n){return{action:String(n.message),chat_client_data:n.chat_client_data}}_setupExtensionOnMessageExternalListener(){c().runtime.onMessageExternal.addListener(this._handleOnMessageExternalEvent)}resetState(){this._supportChat.tabId=null,this._supportChat.frameId=null}}const ct=oi;function Ur(u){return/\d$/.test(u)}var He=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class jt{constructor(){this._endsWithNumber=Ur,this._isOnRemovedEventBeingHandled=!1,this._isOnActivatedEventBeingHandled=!1,this._isUserPermissionsPageBeingForcedActive=!1,this._userOnboardingGlob=`chrome-extension://${c().runtime.id}/user-onboarding.html*`,this._extensionOnMessageExternalListenerHandlers={external_check_required_permissions_active:()=>He(this,null,function*(){return yield this._isAllUrlsOriginPermissionActive()}),external_request_all_urls_origin_permission:n=>He(this,[n],function*({message:r,sender:s}){var l;return yield this._requestAllUrlsOriginPermission(Boolean(r.reload_tab_after_permission_granted),(l=s.tab)==null?void 0:l.id)})},this._extensionOnMessageListenerHandlers={user_onboarding_init_checks:({sender:n})=>this._userOnboardingInitChecks(n),check_required_permissions_active:()=>He(this,null,function*(){return yield this._isAllUrlsOriginPermissionActive()}),request_all_urls_origin_permission:n=>He(this,[n],function*({message:r,sender:s}){var l;return yield this._requestAllUrlsOriginPermission(Boolean(r.reload_tab_after_permission_granted),(l=s.tab)==null?void 0:l.id)}),clear_active_camera_settings:()=>this.clearActiveCameraSettings(),set_camera_setting_active:({message:n})=>this._setBrowserCameraSettingActive(n)},this._handleSettingCameraActiveInExam=n=>r=>{if((r==null?void 0:r.setting)==="allow"||!n.url)return;const s=new URL(n.url),l=s.port?`*://${s.hostname}:*/*`:`*://${s.host}/*`;chrome.contentSettings.camera.set({primaryPattern:l,setting:"allow"})},this._handleTabsOnActivatedListenerEvent=n=>He(this,null,function*(){const r=yield this._getExistingUserOnboardingPage(),s=(r==null?void 0:r.id)===n.tabId;if(this._isOnboardingPageInDifferentWindowFromExamPage(s,n.windowId)){this._setupOnActiveTabChangedTimeout(()=>He(this,null,function*(){return yield this._closeAndFocusOnboardingPage(n.tabId)}));return}if(this._isOnActivatedEventBeingHandled){this._SYNC_isOnActivatedEventBeingHandled=s;return}this._SYNC_isOnActivatedEventBeingHandled=!0,this._setupOnActiveTabChangedTimeout(()=>He(this,null,function*(){return yield this._focusUserOnboardingPage(n.tabId)}))}),this._setupOnActiveTabChangedTimeout=(n,r=250)=>{this._onActiveTabChangedTimeout&&clearTimeout(this._onActiveTabChangedTimeout),this._onActiveTabChangedTimeout=setTimeout(()=>n(),r)},this._focusUserOnboardingPage=n=>He(this,null,function*(){try{const r=yield this._getExistingUserOnboardingPage();if((r==null?void 0:r.id)===n){yield c().tabs.update(r.id,{active:!0}),this._SYNC_isOnActivatedEventBeingHandled=!1;return}yield this.checkIfRequiredPermissionsAreActive(!0),this._SYNC_isOnActivatedEventBeingHandled=!1}catch(r){if(r.message!=="Tabs cannot be edited right now (user may be dragging a tab).")return;this._setupOnActiveTabChangedTimeout(()=>He(this,null,function*(){return yield this._focusUserOnboardingPage(n)}),1e3)}}),this._closeAndFocusOnboardingPage=n=>He(this,null,function*(){try{yield c().tabs.remove(n),this._SYNC_isOnActivatedEventBeingHandled=!0,this._setupOnActiveTabChangedTimeout(()=>He(this,null,function*(){return yield this._focusUserOnboardingPage(n)}))}catch(r){if(r.message!=="Tabs cannot be edited right now (user may be dragging a tab).")return;this._setupOnActiveTabChangedTimeout(()=>He(this,null,function*(){return yield this._closeAndFocusOnboardingPage(n)}),1e3)}}),this._handleExtensionOnInstalledEvent=n=>{const{reason:r}=n;r==="install"&&this.checkIfRequiredPermissionsAreActive().catch(s=>{})},this._handlePermissionOnRemovedEvent=()=>He(this,null,function*(){var n,r;if(this._isOnRemovedEventBeingHandled)return;if(this._SYNC_isOnRemovedEventBeingHandled=!0,yield this.checkIfRequiredPermissionsAreActive(!0),this._SYNC_isOnRemovedEventBeingHandled=!1,(n=this._examControl)==null?void 0:n.isExamActive){(r=this._cameraWindowControl)==null||r.sendMessageToWebcam("extension_permissions_removed_during_exam"),this._forceUserPermissionPageActive();return}const s=yield c().storage.local.get(["launch_proctoring_iframe_url","launch_url"]);(s.launch_proctoring_iframe_url||s.launch_url)&&this._forceUserPermissionPageActive()}),this._handlePermissionOnAddedListener=n=>He(this,null,function*(){const{origins:r}=n;if(r==null?void 0:r.includes("<all_urls>")){this._userOnboardingPermissionGranted().catch(s=>{});return}this._isOnRemovedEventBeingHandled||(yield this.checkIfRequiredPermissionsAreActive(!0))}),this._handleOnMessageExternalEvent=(n,r)=>{const s=n.message||n.type;if(!s||!this._extensionOnMessageExternalListenerHandlers[s])return;const l=this._extensionOnMessageExternalListenerHandlers[s]({message:n,sender:r});if(!!l)return Promise.resolve(l)},R(this._extensionOnMessageListenerHandlers),this._setupExtensionOnMessageExternalListener(),this._setupExtensionOnInstalledListener(),this._setupPermissionOnRemovedListener(),this._setupPermissionOnAddedListener()}init(n){this._examControl=n.examControl,this._cameraWindowControl=n.cameraWindowControl,this._examControl.isExamActive&&this.checkIfRequiredPermissionsAreActive().catch(r=>{})}set _SYNC_isOnRemovedEventBeingHandled(n){this._isOnRemovedEventBeingHandled=n}set _SYNC_isOnActivatedEventBeingHandled(n){this._isOnActivatedEventBeingHandled=n}get isUserPermissionsPageBeingForcedActive(){return this._isUserPermissionsPageBeingForcedActive}set _SYNC_isUserPermissionsPageBeingForcedActive(n){this._isUserPermissionsPageBeingForcedActive=n}checkIfRequiredPermissionsAreActive(n=!1){return He(this,null,function*(){var r,s,l;if(yield this._isAllUrlsOriginPermissionActive())return;const p=yield this._getExistingUserOnboardingPage();if((p==null?void 0:p.id)&&p.windowId===((r=this._examControl)==null?void 0:r.examWindowId)){yield c().tabs.update(p.id,{active:!0});return}const w="user-onboarding.html",f={active:!0,url:n?`${w}?removed=1`:w};((s=this._examControl)==null?void 0:s.examWindowId)&&(f.windowId=(l=this._examControl)==null?void 0:l.examWindowId),yield c().tabs.create(f)})}clearActiveCameraSettings(){chrome.contentSettings.camera.clear({scope:"regular"})}_setBrowserCameraSettingActive(n){const r=n.url;if(!r)return;const s=this._endsWithNumber(r)?`${r}/`:r;chrome.contentSettings.camera.get({primaryUrl:`${s}*`},this._handleSettingCameraActiveInExam(n))}_isAllUrlsOriginPermissionActive(){return He(this,null,function*(){const{permissions:n,origins:r}=yield c().permissions.getAll();return Boolean(n==null?void 0:n.length)&&Boolean(r==null?void 0:r.includes("<all_urls>"))})}_requestAllUrlsOriginPermission(n=!1,r){return He(this,null,function*(){const s=yield c().permissions.request({origins:["<all_urls>"]});return s&&n&&r&&c().tabs.reload(r).catch(l=>{}),s})}_userOnboardingInitChecks(n){return He(this,null,function*(){var r;yield this._removeExtraUserOnboardingPages((r=n==null?void 0:n.tab)==null?void 0:r.id),yield this._checkIfOnboardingCompleted()})}_removeExtraUserOnboardingPages(n){return He(this,null,function*(){const r=yield c().tabs.query({url:this._userOnboardingGlob});r.length<=1||r.forEach(s=>{!(s==null?void 0:s.id)||s.id===n||c().tabs.remove(s.id).catch(l=>{})})})}_checkIfOnboardingCompleted(){return He(this,null,function*(){!(yield this._isAllUrlsOriginPermissionActive())||this._userOnboardingPermissionGranted().catch(r=>{})})}_userOnboardingPermissionGranted(){return He(this,null,function*(){var n,r;const s=yield this._getExistingUserOnboardingPage();if(!(s==null?void 0:s.id))return;const g=(yield c().tabs.query({url:"https://prep.honorlock.com/*"})).length?"student_tutorial":"chrome_web_store";c().tabs.sendMessage(s.id,{action:"user_onboarding_completed",user_onboarding_type:g}).catch(p=>{}),this._isUserPermissionsPageBeingForcedActive&&(c().tabs.onActivated.removeListener(this._handleTabsOnActivatedListenerEvent),this._SYNC_isUserPermissionsPageBeingForcedActive=!1,(r=this._cameraWindowControl)==null||r.checkIfWebcamExistsDuringActiveExam((n=this._examControl)==null?void 0:n.examTabId))})}_getExistingUserOnboardingPage(){return He(this,null,function*(){return(yield c().tabs.query({url:this._userOnboardingGlob}))[0]})}_forceUserPermissionPageActive(){this._SYNC_isUserPermissionsPageBeingForcedActive=!0,c().tabs.onActivated.addListener(this._handleTabsOnActivatedListenerEvent)}_isOnboardingPageInDifferentWindowFromExamPage(n,r){var s;return Boolean(n&&((s=this._examControl)==null?void 0:s.examWindowId)&&r!==this._examControl.examWindowId)}_setupExtensionOnInstalledListener(){c().runtime.onInstalled.addListener(this._handleExtensionOnInstalledEvent)}_setupPermissionOnRemovedListener(){c().permissions.onRemoved.addListener(this._handlePermissionOnRemovedEvent)}_setupPermissionOnAddedListener(){c().permissions.onAdded.addListener(this._handlePermissionOnAddedListener)}_setupExtensionOnMessageExternalListener(){c().runtime.onMessageExternal.addListener(this._handleOnMessageExternalEvent)}resetState(){this._isOnRemovedEventBeingHandled=!1,this._isOnActivatedEventBeingHandled=!1,this._isUserPermissionsPageBeingForcedActive=!1,this._onActiveTabChangedTimeout&&(clearTimeout(this._onActiveTabChangedTimeout),delete this._onActiveTabChangedTimeout)}}const vt=jt,fe={BLACKBOARD_CLASSIC:1,CANVAS:2,ALEKS:3,D2L:4,UNIVERSAL:5,BLACKBOARD_ULTRA:6,INTELLUM:7,PARTNER:8},cr="quiz-lti-",li=1e4/250,On={START_EXAM:"start_exam",SUBMIT_EXAM:"submit_exam",EXTENSION_INSTALLED:"honorlock:extension:installedSuccessfully"};var Ut=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});function $n(u,n,r=null){const s={[fe.BLACKBOARD_CLASSIC]:[/\bwebapps\/assessment\/take\b|\bultra\/courses\/\b/i],[fe.CANVAS]:[/\bcourses\b.*\bquizzes\b.*\btake\b/i,/\bcourses\b.*\bquizzes/i,/\bcourses\b.*\bassignments\/[0-9]+/i],[fe.ALEKS]:[/\baleks\.com\/alekscgi\b/i],[fe.D2L]:[/\bd2l\/lms\/quizzing\/user\b|\bd2l\/le\/content\/.*\/viewContent\b/i],[fe.UNIVERSAL]:[/\bhttps:\/\/.*\.honorlock\.com\/launch\b/i],[fe.BLACKBOARD_ULTRA]:[/\bblackboard\.com\/ultra\/\b/i],[fe.INTELLUM]:[/\bstudent\/activity\b.*\b|\bstudent\/path\/\b.*\bactivity\b.*\b|\bstudent\/collection\/\b.*\/path\/\b.*\/activity\/\b.*\b/i],[fe.PARTNER]:[new RegExp(`${r}/{0,1}.*`,"i")]};return!n||!u||!s[u]?!1:s[u].some(l=>l.test(n))}function Vn(u){for(const n in fe)if($n(fe[n],u))return!0;return!1}function dr(u){const n={[LmsTypeId.BLACKBOARD_CLASSIC]:["*://*/webapps/assessment/take/*","*://*/ultra/courses/*"],[LmsTypeId.CANVAS]:["https://*/courses/*/quizzes/*"],[LmsTypeId.ALEKS]:["*://*.aleks.com/alekscgi*"],[LmsTypeId.D2L]:["*://*/d2l/lms/quizzing/*","*://*/d2l/le/content/*/viewContent/*"],[LmsTypeId.UNIVERSAL]:["https://*.honorlock.com/launch"],[LmsTypeId.BLACKBOARD_ULTRA]:["*://*.blackboard.com/ultra/*"],[LmsTypeId.INTELLUM]:["*://*/student/activity/*","*://*/student/path/*/activity/*","*://*/student/collection/*/path/*/activity/*","*://*/assessment_responses/take?*"]};return!u||!n[u]?[]:n[u]}function hr(u){const n=u||window.location.href;return/\bd2l\/lms\/quizzing\/user\/quiz_summary\.d2l\b/i.test(n)}function _r(u){const n=u||window.location.href,r=/\bd2l\/lms\/quizzing\/user\/attempt\/quiz_start_frame\.d2l\b/i,s=/\bd2l\/lms\/quizzing\/user\/attempt\/quiz_start_frame_auto\.d2l\b/i;return r.test(n)||s.test(n)}function Qt(u){const n=u||window.location.href,r=document.querySelector('form[id^="tool_form"]'),s=r==null?void 0:r.action;return jn(n)&&Boolean(s==null?void 0:s.includes(NEW_QUIZ_IDENTIFIER))}function fr(u){if(!Qt(u))return!1;const n=_i(),r=document.getElementById("roles"),s=n?n.current_user_is_student:!1,l=n?n.current_user_roles:[],g=r?r.value.toLowerCase():"";return!s&&(l.includes("instructor")||l.includes("teacher")||l.includes("contentdeveloper")||g.includes("instructor")||g.includes("teacher")||g.includes("contentdeveloper"))}function Pn(u){return Ut(this,null,function*(){if(!Qt(u))return!1;const{is_universal_lms_exam:n,launch_tab_id:r}=yield browser.storage.local.get(["is_universal_lms_exam","launch_tab_id"]);return Boolean(n&&r)})}function Rr(u){return Ut(this,null,function*(){if(!Qt(u)||(yield Pn(u)))return!1;const{exam_state:n,camera_state:r}=yield browser.storage.local.get(["exam_state","camera_state"]);return n===ExamState.ACTIVE&&r==="open"||n===ExamState.PAUSED})}function Vi(){return Qt()?globalThis.lti_unique_tool_form_ids&&globalThis.lti_tool_form_id?document.querySelector(`iframe[id="tool_content_${globalThis.lti_tool_form_id}"]`):document.querySelector('iframe[id^="tool_content"]'):document.querySelector('iframe[id="preview_frame"]')}function Wr(u,n=1e4){return Ut(this,null,function*(){const s=n/500;return new Promise(l=>{if(!Qt(u))return l(!1);let g=0;const p=setInterval(()=>Ut(this,null,function*(){const w=document.querySelector('[data-automation="sdk-access-code-textinput"]'),f=yield browser.runtime.sendMessage({message:"is_ncq_access_screen"});if(w||f)return clearInterval(p),l(!0);if(g>s)return clearInterval(p),l(!1);g+=1}),500)})})}function jn(u){const n=u||window.location.href;return/\bcourses\b.*\bassignments\b/i.test(n)||n.includes(cr)}function ui(){let u=document.querySelectorAll("[type=password]");if(u=[...u].filter(n=>n.offsetWidth>0&&n.offsetHeight>0),!u.length){const n=["app.edulastic.com"];for(const r of n)if(window.location.href.indexOf(r)>-1){u=document.querySelectorAll("input[type=text]"),u=[...u].filter(s=>s.offsetWidth>0&&s.offsetHeight>0&&s.id.toLowerCase().indexOf("password")>-1||s.className.toLowerCase().indexOf("password")>-1||s.placeholder.toLowerCase().indexOf("password")>-1);break}}return u}function Xt(u){browser.runtime.sendMessage({message:"alert",var:u}).catch(n=>{})}function ji(){browser.runtime.sendMessage({message:"focus_page"}).catch(u=>{})}function Qi(u,n,r=7500){if(typeof n!="function")return;const s=setInterval(()=>{!document.querySelector(u)||g(!0)},100),l=setTimeout(()=>g(!1),r),g=p=>{clearInterval(s),clearTimeout(l),n(p)}}function ci(u){if(typeof u!="function")return;const n=document.querySelector("body")||document.querySelector("html");if(!n)return;const r=document.createElement("button");r.id="hl-support-bypass-block",r.classList.add("hl-bypass-block"),r.innerText="Skip to the Honorlock support widget",r.setAttribute("tabindex","0"),n.prepend(r),r.addEventListener("click",u)}function Xi(){var u,n;const r=document.getElementById("preview-iframe");return(n=(u=r==null?void 0:r.contentWindow)==null?void 0:u.document)!=null?n:document}function di(){document.documentElement.classList.add("honorlock-a11y")}function Zi(u){if(!u)return;const n=document.getElementById("hl-exam-tools")||document.getElementById("hl-livechat-client");if(n==null?void 0:n.parentNode){n.parentNode.insertBefore(u,n);return}document.body.appendChild(u)}function Ji(u,n){if(!u.include)return;const r=document.createElement("li"),s=document.createElement("i");s.classList.add(u.iconClass,"hl-sidebar"),s.setAttribute("aria-hidden","true");const l=u.href?document.createElement("a"):document.createElement("button");if(l.id=u.id,l.innerText=u.title,l.prepend(s),l.classList.add("hlx-bg-transparent","hlx-block","hlx-w-full","hlx-font-bold","hlx-px-0","hlx-py-2","hlx-border-t-0","hlx-border-l-0","hlx-border-r-0","hlx-border-b","hlx-border-solid","hlx-border-[#c7cdd1]","hlx-text-black","hlx-text-left","hlx-text-base","hover:hlx-text-hl-blue-secondary","focus:hlx-text-hl-blue-secondary"),u.href&&"href"in l){l.href=u.href,l.setAttribute("target","_blank"),l.setAttribute("rel","noopener noreferrer"),l.classList.add("hover:hlx-underline","focus:hlx-underline");const g=document.createElement("i");g.classList.add("icon-external-link","hlx-ml-2"),g.setAttribute("aria-hidden","true"),l.append(g)}u.ariaExpandedControlsId&&(l.setAttribute("aria-expanded","false"),l.setAttribute("aria-controls",u.ariaExpandedControlsId)),u.ariaLabel&&l.setAttribute("aria-label",u.ariaLabel),r.append(l),n.append(r)}function hi(u){const{lmsTypeId:n,eventType:r,questionNumber:s,questionText:l,questionHtml:g,schoolIdentifier:p,examIdentifier:w,studentIdentifier:f,currentAttempt:T,isExamLoadedFromLaunch:re,userNameIdentifier:j,honorlockStudentIdentifier:ke,location:et,sessionUuid:It}=u;return{event_type:r,question_num:s||"",question_text:l||"",question_html:g||"",school_identifier:p,exam_identifier:w,student_identifier:f,current_attempt:Number(T),came_from_launch:Boolean(re),user_name:j,lms_id:Number(n),hl_student_id:ke,location:et||"",session_uuid:It}}function Mr(u){return new Proxy(new URLSearchParams(window.location.search),{get:(r,s)=>r.get(s)})[u]}function _i(){const n=Array.from(document.getElementsByTagName("script")).filter(p=>p.innerHTML.includes("INST ="));if(!n||n.length!==1)return null;const r=n[0].innerHTML;if(r.indexOf("ENV =")<0)return null;const s=r.indexOf("ENV =")+5,l=r.indexOf("};",s)+1,g=r.substring(s,l);return JSON.parse(g)}var mr=Object.defineProperty,fi=Object.defineProperties,mi=Object.getOwnPropertyDescriptors,gr=Object.getOwnPropertySymbols,gi=Object.prototype.hasOwnProperty,vi=Object.prototype.propertyIsEnumerable,Br=(u,n,r)=>n in u?mr(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r,pi=(u,n)=>{for(var r in n||(n={}))gi.call(n,r)&&Br(u,r,n[r]);if(gr)for(var r of gr(n))vi.call(n,r)&&Br(u,r,n[r]);return u},bi=(u,n)=>fi(u,mi(n)),Lt=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class xi{constructor(){this._checkIsLmsUrl=Vn,this._chromeDesktopCaptureChooseDesktopMedia=oe,this._isInitializingRecordingSession=!0,this._isExtensionUpdateAvailable=!1,this._openDeveloperToolsCount=0,this._currentBadgeIconState="inactive",this._extensionOnMessageListenerHandlers={get_extID:({sender:n})=>this._sendExtensionIdMessage(n),uninstall_self:()=>this._uninstallExtension(),uninstall_clear_page:()=>this._clearUninstallUrl(),append_script:({message:n,sender:r})=>this._appendScriptToSenderDom(n,r),check_update_available:()=>this.checkIfExtensionUpdateIsAvailable(),check_devtools_open:()=>this._handleCheckDeveloperToolsOpen(),highlight_page:({sender:n})=>this._handleHighlightPageMessage(n)},this._extensionOnMessageExternalListenerHandlers={version:()=>this._sendExtensionVersion(),uninstallme:()=>this._uninstallExtension(),showFrame:()=>this._sendShowHonorlockIframeMessage(),getSourceId:n=>Lt(this,[n],function*({sender:r}){return yield this._sendDesktopSourceId(r)}),isInstalled:()=>this._verifyIsInstalledStatus(),resume_all_tabs:()=>this._handleExternalResumeAllTabsMessage(),check_extension_health:()=>Lt(this,null,function*(){return{message:yield this.isLocalStorageHealthy()}})},this._extensionOnCommandListenerHandlers={nextstep:()=>this._sendLiveChatCommandNextStepMessage(),disableguard:()=>this._handleDisableGuardCommand(),clearlocalstorage:()=>this.clearLocalStorage()},this._handleTabsOnActivatedEvent=n=>{this._handleOutOfExamBadgeIconUpdates(n.tabId).catch(r=>{})},this._handleTabsOnUpdatedEvent=n=>{this._handleOutOfExamBadgeIconUpdates(n).catch(r=>{})},this._handleTabsOnAttachedEvent=(n,r)=>{var s;((s=this._examControl)==null?void 0:s.examTabId)===n&&this._examControl.setExamWindowId(r.newWindowId)},this._handleOnMessageExternalEvent=(n,r)=>{const s=n.message||n.type;if(!s||!this._extensionOnMessageExternalListenerHandlers[s])return;const l=this._extensionOnMessageExternalListenerHandlers[s]({message:n,sender:r});if(!!l)return Promise.resolve(l)},this._handleExtensionOnUpdateAvailableEvent=()=>{var n,r;if(!((n=this._examControl)==null?void 0:n.isExamActive)){c().runtime.reload();return}this.setIsExtensionUpdateAvailable(!0),!!((r=this._cameraWindowControl)==null?void 0:r.cameraTabId)&&c().tabs.sendMessage(this._cameraWindowControl.cameraTabId,{action:"extension_update_during_exam"}).catch(s=>{})},this._handleExtensionCommandEvents=n=>Lt(this,null,function*(){(yield c().management.getSelf()).installType!=="development"||!this._extensionOnCommandListenerHandlers[n]||this._extensionOnCommandListenerHandlers[n]()}),this._handleDeveloperToolsOnConnect=n=>{var r,s;n.name==="hl-developer-tools-connection"&&(this._SYNC_openDeveloperToolsCount=this._openDeveloperToolsCount+1,n.onDisconnect.addListener(this._handleDeveloperToolsOnDisconnect),[(r=this._examControl)==null?void 0:r.examTabId,(s=this._cameraWindowControl)==null?void 0:s.cameraTabId].forEach(l=>{l&&c().tabs.sendMessage(l,{action:"devtools_open"}).catch(g=>{})}))},this._handleDeveloperToolsOnDisconnect=()=>{var n,r;this._SYNC_openDeveloperToolsCount=this._openDeveloperToolsCount-1,this._openDeveloperToolsCount===0&&[(n=this._examControl)==null?void 0:n.examTabId,(r=this._cameraWindowControl)==null?void 0:r.cameraTabId].forEach(s=>{s&&c().tabs.sendMessage(s,{action:"devtools_closed"}).catch(l=>{})})},R(this._extensionOnMessageListenerHandlers),this._setupTabsOnActivatedListener(),this._setupTabsOnUpdatedListener(),this._setupTabsOnAttachedListener(),this._setupExtensionOnMessageExternalListener(),this._setupExtensionOnUpdateAvailableListener(),this._setupExtensionCommandListener(),this._setupDeveloperToolsListener()}init(n){const{clearStoreState:r,localizationControl:s,examControl:l,cameraWindowControl:g,allowedBrowserAccess:p,proctoringActions:w,browserGuard:f,installedExtensionsControl:T}=n;this._clearStoreState=r,this._localizationControl=s,this._examControl=l,this._cameraWindowControl=g,this._allowedBrowserAccess=p,this._proctoringActions=w,this._browserGuard=f,this._installedExtensionControl=T,this.setBadgeIconState(this._currentBadgeIconState,!0)}get isInitializingRecordingSession(){return this._isInitializingRecordingSession}set _SYNC_isInitializingRecordingSession(n){this._isInitializingRecordingSession=n}setIsInitializingRecordingSession(n){this._SYNC_isInitializingRecordingSession=n}get isExtensionUpdateAvailable(){return this._isExtensionUpdateAvailable}set _SYNC_isExtensionUpdateAvailable(n){this._isExtensionUpdateAvailable=n}setIsExtensionUpdateAvailable(n){this._SYNC_isExtensionUpdateAvailable=n}set _SYNC_openDeveloperToolsCount(n){this._openDeveloperToolsCount=n}set _SYNC_currentBadgeIconState(n){this._currentBadgeIconState=n}sendMessageToAllTabs(n){return Lt(this,null,function*(){const r=yield c().tabs.query({});for(const s of r)!s.id||c().tabs.sendMessage(s.id,n).catch(l=>{})})}handleExtensionUpdateRequiredOnExamInit(){c().runtime.reload()}checkIfExtensionUpdateIsAvailable(){!this._isExtensionUpdateAvailable||setTimeout(()=>c().runtime.reload(),5e3)}isLocalStorageHealthy(){return Lt(this,null,function*(){const n=yield c().storage.local.get(),r=Object.keys(n);return!["app_url","attempt","bypass_status","camera_blade_dimensions","exam_id","exam_state","exam_toggles","lms_id","session_id","toolbar_data","translations","usat"].filter(g=>!r.includes(g)).length})}clearLocalStorage(n){return Lt(this,null,function*(){var r;yield c().storage.local.clear(),this._clearStoreState&&(yield this._clearStoreState()),(r=this._installedExtensionControl)==null||r.stopWatching(),typeof n=="function"&&n()})}resetWindowsAndTabState(){var n,r,s,l,g,p,w,f;(n=this._examControl)==null||n.setUniversalPasswordInsertWindowId(null),(r=this._examControl)==null||r.setUniversalLaunchTabId(null),(s=this._examControl)==null||s.setUniversalLaunchWindowId(null),(l=this._examControl)==null||l.setExamTabId(null),(g=this._examControl)==null||g.setExamWindowId(null),(p=this._examControl)==null||p.setIsExamCurrentlySubmitting(!1),(w=this._cameraWindowControl)==null||w.setCameraTabId(null),(f=this._cameraWindowControl)==null||f.setCameraWindowId(null)}pinBrowserTabById(n){!n||c().tabs.update(n,{pinned:!0}).catch(r=>{})}setBadgeIconState(n="ready",r=!1){const s=new Set(["active","inactive","ready","recording"]);if(!(!r&&this._currentBadgeIconState===n||!s.has(n))){if(this._recordingBadgeIconInterval&&clearInterval(this._recordingBadgeIconInterval),this._SYNC_currentBadgeIconState=n,this._currentBadgeIconState==="recording"&&this._isInitializingRecordingSession){this._initRecordingBadgeIcon(),this._SYNC_isInitializingRecordingSession=!1;return}this._setBadgeIcon(`assets/build/badges/${n}.png`)}}handleExtensionStartup(){return Lt(this,null,function*(){yield this.clearLocalStorage();let n=!0;(yield c().tabs.query({})).forEach(s=>{var l;!s.id||((l=s.url)==null?void 0:l.includes("chrome://"))||(this._injectPlatformExtensionInstalledScript(s.id),n=this._reloadLmsTab(s.id,s.url,n),this._removeExtensionInstallTab(s.id,s.url))})})}_sendExtensionIdMessage(n){var r;!((r=n.tab)==null?void 0:r.id)||c().tabs.sendMessage(n.tab.id,{action:"get_extID",data:c().runtime.id}).catch(s=>{})}_clearUninstallUrl(){c().runtime.setUninstallURL("").catch(n=>{})}_appendScriptToSenderDom(n,r){return Lt(this,null,function*(){var s,l,g;const p=(l=(s=r.tab)==null?void 0:s.id)!=null?l:n.tabId;!p||!n.filename||chrome.scripting.executeScript({target:{tabId:p,allFrames:!!n.send_all_frames},files:[n.filename],world:(g=n.executeScriptWorld)!=null?g:"MAIN"}).catch(w=>{})})}appendScript(n,r,s,l){chrome.scripting.executeScript({target:{tabId:n,allFrames:s},files:[r],world:l!=null?l:"MAIN"}).catch(g=>{})}_sendLiveChatCommandNextStepMessage(){this.sendMessageToAllTabs({action:"livechat_command_nextstep"}).catch(n=>{})}_handleDisableGuardCommand(){var n;(n=this._browserGuard)==null||n.stop()}_sendExtensionVersion(){return{version:chrome.runtime.getManifest().version}}_uninstallExtension(){var n,r;return((n=this._examControl)==null?void 0:n.isExamActive)&&((r=this._examControl)==null?void 0:r.examState)!==K.PRELAUNCH?{message:"exam-active"}:(setTimeout(()=>{c().management.uninstallSelf().catch(s=>{})},500),{message:"start-countdown"})}_sendShowHonorlockIframeMessage(){return this.sendMessageToAllTabs({action:"show_frame"}).catch(n=>{}),{message:"sendFrame message received"}}_sendDesktopSourceId(n){return Lt(this,null,function*(){var r,s;if(!this._cameraWindowControl||!n.tab)return{error:"permissionDenied"};const l=bi(pi({},n.tab),{url:n.url,selected:!0,groupId:1,windowId:Number(n.tab.windowId),discarded:!!n.tab.discarded,autoDiscardable:!!n.tab.autoDiscardable});(r=this._examControl)==null||r.setIsRecordScreenExamSettingActive(!1),this._cameraWindowControl.setIsInitializingScreenCapture(!0);const g=yield this._chromeDesktopCaptureChooseDesktopMedia(["screen"],l);return this._cameraWindowControl.setIsInitializingScreenCapture(!1),(g==null?void 0:g.length)?((s=this._examControl)==null||s.setIsRecordScreenExamSettingActive(!0),{sourceId:g}):{error:"permissionDenied"}})}_verifyIsInstalledStatus(){return!0}_handleExternalResumeAllTabsMessage(){var n;return(n=this._proctoringActions)==null||n.resumeAllTabs().catch(r=>{}),{message:"resume_all_tabs message received"}}_handleOutOfExamBadgeIconUpdates(n){return Lt(this,null,function*(){var r;if((yield c().storage.local.get(["session_id"])).session_id)return;const l=yield c().tabs.get(n);if((r=this._allowedBrowserAccess)==null?void 0:r.websites.isDefaultItem(l.url)){this.setBadgeIconState("active");return}this.setBadgeIconState("inactive")})}_initRecordingBadgeIcon(){let n=!0;this._recordingBadgeIconInterval=setInterval(()=>{const r=`assets/build/badges/recording-${n?"on":"off"}.png`;n=!n,this._setBadgeIcon(r)},1e3)}_setBadgeIcon(n){c().action.setIcon({path:n}).catch(r=>{})}_injectPlatformExtensionInstalledScript(n){c().scripting.executeScript({target:{tabId:n,allFrames:!0},files:["js/platform_extension_installed.js"]}).catch(r=>{})}_reloadLmsTab(n,r,s=!0){return this._checkIsLmsUrl(r)?(c().tabs.reload(n).catch(l=>{}),s&&c().tabs.update(n,{active:!0}).catch(l=>{}),!1):s}_removeExtensionInstallTab(n,r){if(!!(r==null?void 0:r.includes("honorlock.com/install/extension"))){if(r.includes("aleks")||r.includes("remove=0")){c().tabs.reload(n).catch(s=>{});return}c().tabs.remove(n).catch(s=>{})}}_handleCheckDeveloperToolsOpen(){return{count:this._openDeveloperToolsCount}}_handleHighlightPageMessage(n){var r;!((r=n.tab)==null?void 0:r.id)||c().tabs.update(n.tab.id,{active:!0}).catch(s=>{})}_setupTabsOnActivatedListener(){c().tabs.onActivated.addListener(this._handleTabsOnActivatedEvent)}_setupTabsOnUpdatedListener(){c().tabs.onUpdated.hasListener(this._handleTabsOnUpdatedEvent)||c().tabs.onUpdated.addListener(this._handleTabsOnUpdatedEvent)}_setupTabsOnAttachedListener(){c().tabs.onAttached.addListener(this._handleTabsOnAttachedEvent)}_setupExtensionOnMessageExternalListener(){c().runtime.onMessageExternal.addListener(this._handleOnMessageExternalEvent)}_setupExtensionOnUpdateAvailableListener(){c().runtime.onUpdateAvailable.addListener(this._handleExtensionOnUpdateAvailableEvent)}_setupExtensionCommandListener(){!c().commands||c().commands.onCommand.addListener(this._handleExtensionCommandEvents)}_setupDeveloperToolsListener(){c().runtime.onConnect.addListener(this._handleDeveloperToolsOnConnect)}resetState(){this._isInitializingRecordingSession=!0,this._isExtensionUpdateAvailable=!1,this._openDeveloperToolsCount=0,this._currentBadgeIconState="inactive",this._recordingBadgeIconInterval&&(clearInterval(this._recordingBadgeIconInterval),delete this._recordingBadgeIconInterval)}}const wi=xi,vr={EXAM_SUBMIT:"Exam Submit",EXAM_LEFT_EARLY:"Exam Left Early",EXAM_BROWSER_CLOSED:"Exam Browser Closed",EXAM_SUBMIT_TIME_EXPIRED:"Exam Submit Time Expired",EXAM_TERMINATED:"Exam Terminated"};var Ii=Object.defineProperty,Ai=Object.defineProperties,Qn=Object.getOwnPropertyDescriptors,Dr=Object.getOwnPropertySymbols,Xn=Object.prototype.hasOwnProperty,Fr=Object.prototype.propertyIsEnumerable,xn=(u,n,r)=>n in u?Ii(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r,Nn=(u,n)=>{for(var r in n||(n={}))Xn.call(n,r)&&xn(u,r,n[r]);if(Dr)for(var r of Dr(n))Fr.call(n,r)&&xn(u,r,n[r]);return u},Yt=(u,n)=>Ai(u,Qn(n)),be=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class Un{constructor(){this._setupKeepAliveListener=ge,this._setupExtensionOnMessageListener=R,this._disableKeepAliveListener=Ke,this._convertExamSubmissionDataToExtensionMessage=hi,this._applyToAllFrameContent=te,this._examState="",this._examStart=null,this._isExamActive=!1,this._isExamPaused=!1,this._isExamCurrentlySubmitting=!1,this._isExamTimerExpired=!1,this._examSubmissionLogData=null,this._examTabId=null,this._examWindowId=null,this._lmsUrl=null,this._lmsId=null,this._lmsMetadata=null,this._isRecordScreenExamSettingActive=!1,this._universalPasswordInsertWindowId=null,this._universalLaunchTabId=null,this._universalLaunchFrameId=null,this._universalLaunchWindowId=null,this._isUniversalExitButtonClicked=!1,this._isUniversalExamInitializationScriptInjected=!1,this._isLoggingExamSubmissionEvent=!1,this._currentlyActiveWebcamLabel="",this._checkExamTabOnUpdatedTimeout=null,this._checkExamTabOnUpdatedTiming=1500,this._extensionOnMessageListenerHandlers={show_exam_webcam:()=>be(this,null,function*(){return yield this._showInExamWebcam()}),update_network_quality_level:n=>be(this,[n],function*({message:r}){return yield this._updateInExamWebcamNetworkQuality(r)}),alert:n=>be(this,[n],function*({message:r}){return yield this._handleExtensionAlertMessage(r)}),is_exam_paused:()=>be(this,null,function*(){return yield this._checkExamPauseStateAndSendSessionData()}),togglecalculator:({message:n})=>this._handleOpeningExamToolbarCalculator(n),opencalculator:({message:n})=>this._handleOpeningExamToolbarCalculator(n),opencalculatorsci:({message:n})=>this._handleOpeningExamToolbarCalculator(n),showcalculator:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),showcalculatorsci:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),hidecalculators:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),closecalculators:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),showwebcam:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),hidewebcam:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),compresswebcam:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),expandwebcam:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),hl_frame_resize:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),hl_frame_open:({message:n,sender:r})=>this._sendHlFrameOpenMessage(n,r),hl_frame_close:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),hl_frame_begin_exam:({message:n})=>this._sendMessageToUpdateExamToolbarElements(n),enable_copy_paste:()=>this._handleUpdatingDisableCopyPasteSetting(!0),disable_copy_paste:()=>this._handleUpdatingDisableCopyPasteSetting(!1),get_aleks_environment_values:n=>be(this,[n],function*({sender:r}){return yield this._getAleksEnvironmentVariables(r)}),inject_platform_listener:({sender:n})=>this._injectPlatformListener(n),inject_hl_frame_listener:({sender:n})=>this._injectHlFrameListener(n),inject_canvas_run:n=>be(this,[n],function*({sender:r}){return yield this._injectCanvasRun(r)}),start_exam:()=>this._handleStartExamMessage(),trigger_exam_submission_event:({sender:n})=>this._handleTriggerExamSubmissionEventMessage(n),close_exam_tab:()=>this._handleCloseExamTabMessage(),hl_frame_update_pointer_events:({message:n,sender:r})=>this._sendHLFrameUpdatePointerEventsMessage(n,r),hl_frame_toggle_collapse:({message:n,sender:r})=>this._sendHLFrameToggleCollapseMessage(n,r),check_iframes_for_element:n=>be(this,[n],function*({message:r,sender:s}){return yield this._handleCheckIframesForElementMessage(r,s)}),detected_hotkeys_combination:({message:n})=>this._sendMessageForHotkeysDetected(n),TOGGLE_SIDE_PANEL:()=>this._handleToggleSidePanelMessage(),terminate_exam:()=>this._handleExamTerminated()},this._extensionOnMessageExternalListenerHandlers={bbultra:({message:n,sender:r})=>this._handleBlackboardUltraExternalMessage(n,r),HL_LAUNCH_PROCTORING:({message:n,sender:r})=>this._handleLaunchProctoringIframeMessage(n,r)},this._isLaunchUnificationFlagOn=!1,this._examTerminated=!1,this._handleExamTabOnUpdatedEvent=(n,r)=>be(this,null,function*(){if(!(n!==this._examTabId||r.status===void 0)){if(r.status!=="complete"){this._checkExamTabOnUpdatedTimeout&&(clearTimeout(this._checkExamTabOnUpdatedTimeout),this._shortCircuitQuizActiveCheck=!0);return}yield this._conditionallyInjectExamProctoringScripts(),this._shortCircuitQuizActiveCheck=!1,this._checkExamTabOnUpdatedTimeout=setTimeout(()=>this._checkIfQuizIsCurrentlyActive(n),this._checkExamTabOnUpdatedTiming)}}),this._conditionallyInjectExamProctoringScripts=()=>be(this,null,function*(){if(!this._examTabId)return;const n=this._examState===K.ACTIVE||this._examState===K.PAUSED,r=yield c().tabs.get(this._examTabId);if(this.isFirstPartyNewCanvasQuiz&&n&&jn(r.url))return this._injectNewCanvasQuizScripts()}),this._injectNewCanvasQuizScripts=()=>be(this,null,function*(){!this._examTabId||(yield c().scripting.executeScript({target:{tabId:this._examTabId},files:["js/canvas_env_setup.js"]}),yield c().scripting.executeScript({target:{tabId:this._examTabId},files:["js/canvas_run.js"]}),yield c().scripting.executeScript({target:{tabId:this._examTabId},files:["js/new_canvas_quiz_tab.js"]}),yield c().tabs.sendMessage(this._examTabId,{action:"resume_active_new_canvas_quiz"}))}),this._checkIfQuizIsActiveCounter=0,this._shortCircuitQuizActiveCheck=!1,this._checkIfQuizIsCurrentlyActive=n=>be(this,null,function*(){if(this._shortCircuitQuizActiveCheck)return;const r=yield c().tabs.sendMessage(n,{action:"check_if_quiz_is_currently_active"}),{camera_state:s}=yield c().storage.local.get(["camera_state"]);if(r===void 0&&this._checkIfQuizIsActiveCounter<5&&this._isExamCurrentlySubmitting===!1){this._checkIfQuizIsActiveCounter++,yield new Promise(l=>setTimeout(l,1e3)),this._checkIfQuizIsCurrentlyActive(n);return}this._checkIfQuizIsActiveCounter=0,!(r||s==="open"&&this._examState===K.PRELAUNCH)&&this.triggerExamSubmissionEvent().catch(l=>{})}),this._handleExamTabOnRemovedEvent=n=>{n===this._examTabId&&this.triggerExamSubmissionEvent().catch(r=>{})},this._handleOnMessageExternalEvent=(n,r)=>{var s;if(!((s=r.tab)==null?void 0:s.id)||!n.source||!this._extensionOnMessageExternalListenerHandlers[n.source])return;const l=this._extensionOnMessageExternalListenerHandlers[n.source]({message:n,sender:r});if(!!l)return Promise.resolve(l)},this._setupExtensionOnMessageListener(this._extensionOnMessageListenerHandlers),this._setupOnMessageExternalListener()}get examState(){return this._examState}set _SYNC_examState(n){this._examState=n}setExamState(n){this._SYNC_examState=n}get examStart(){return this._examStart}set _SYNC_examStart(n){this._examStart=n}setExamStart(n){this._SYNC_examStart=n}get isExamActive(){return this._isExamActive}set _SYNC_isExamActive(n){this._isExamActive=n}setIsExamActive(n){this._SYNC_isExamActive=n}get isExamPaused(){return this._isExamPaused}set _SYNC_isExamPaused(n){this._isExamPaused=n}setIsExamPaused(n){this._SYNC_isExamPaused=n}set _SYNC_isExamCurrentlySubmitting(n){this._isExamCurrentlySubmitting=n}setIsExamCurrentlySubmitting(n){this._SYNC_isExamCurrentlySubmitting=n}set _SYNC_isExamTimerExpired(n){this._isExamTimerExpired=n}setIsExamTimerExpired(n){this._SYNC_isExamTimerExpired=n}set _SYNC_examSubmissionLogData(n){this._examSubmissionLogData=n}setExamSubmissionLogData(n){!n||(this._SYNC_examSubmissionLogData=n)}get examTabId(){return this._examTabId}set _SYNC_examTabId(n){if(this._examTabId=n,!n){this._detachExamTabNavigationWatchers();return}this._setupExamTabNavigationWatchers()}setExamTabId(n){this._SYNC_examTabId=n}get examWindowId(){return this._examWindowId}set _SYNC_examWindowId(n){this._examWindowId=n}setExamWindowId(n){this._SYNC_examWindowId=n}get lmsUrl(){return this._lmsUrl}set _SYNC_lmsUrl(n){this._lmsUrl=n}setLmsUrl(n){this._SYNC_lmsUrl=n}get lmsId(){return this._lmsId}set _SYNC_lmsId(n){this._lmsId=n}setLmsId(n){this._SYNC_lmsId=n}get lmsMetadata(){return this._lmsMetadata}set _SYNC_lmsMetadata(n){this._lmsMetadata=n}setLmsMetadata(n){this._SYNC_lmsMetadata=n}get isRecordScreenExamSettingActive(){return this._isRecordScreenExamSettingActive}set _SYNC_isRecordScreenExamSettingActive(n){this._isRecordScreenExamSettingActive=n}setIsRecordScreenExamSettingActive(n){this._SYNC_isRecordScreenExamSettingActive=n}get universalPasswordInsertWindowId(){return this._universalPasswordInsertWindowId}set _SYNC_universalPasswordInsertWindowId(n){this._universalPasswordInsertWindowId=n}setUniversalPasswordInsertWindowId(n){this._SYNC_universalPasswordInsertWindowId=n}get universalLaunchTabId(){return this._universalLaunchTabId}set _SYNC_universalLaunchTabId(n){this._universalLaunchTabId=n}setUniversalLaunchTabId(n){this._SYNC_universalLaunchTabId=n}get universalLaunchFrameId(){return this._universalLaunchFrameId}set _SYNC_universalLaunchFrameId(n){this._universalLaunchFrameId=n}setUniversalLaunchFrameId(n){this._SYNC_universalLaunchFrameId=n}get universalLaunchWindowId(){return this._universalLaunchWindowId}set _SYNC_universalLaunchWindowId(n){this._universalLaunchWindowId=n}setUniversalLaunchWindowId(n){this._SYNC_universalLaunchWindowId=n}get isUniversalExitButtonClicked(){return this._isUniversalExitButtonClicked}set _SYNC_isUniversalExitButtonClicked(n){this._isUniversalExitButtonClicked=n}setIsUniversalExitButtonClicked(n){this._SYNC_isUniversalExitButtonClicked=n}get isUniversalExamInitializationScriptInjected(){return this._isUniversalExamInitializationScriptInjected}set _SYNC_isUniversalExamInitializationScriptInjected(n){this._isUniversalExamInitializationScriptInjected=n}setIsUniversalExamInitializationScriptInjected(n){this._SYNC_isUniversalExamInitializationScriptInjected=n}set _SYNC_currentlyActiveWebcamLabel(n){this._currentlyActiveWebcamLabel=n}set _SYNC_isLoggingExamSubmissionEvent(n){this._isLoggingExamSubmissionEvent=n}get isFirstPartyNewCanvasQuiz(){var n,r;return this._lmsId==fe.CANVAS&&((r=(n=this._lmsMetadata)==null?void 0:n.is_new_canvas_quiz)!=null?r:!1)}init(n){const{cameraWindowControl:r,browserGuard:s,allowedBrowserAccess:l,userPermissionsControl:g,proctoringActions:p,extensionControl:w,injectDisableKeyboardEvents:f,installedExtensionsControl:T}=n;this._cameraWindowControl=r,this._browserGuard=s,this._allowedBrowserAccess=l,this._userPermissionsControl=g,this._proctoringActions=p,this._extensionControl=w,this._injectDisableKeyboardEvents=f,this._installedExtensionsControl=T}sendSingleAlertNotification(n,r,s,l,g,p){return be(this,null,function*(){if(!this._examTabId)return;const w={type:s||"info",message:n,url:l||"",link_text:g||"",timeout:r||3e3},f=typeof p!="undefined"?p:!0;yield this.sendAlertNotificationsToTab(this._examTabId,[w],f)})}sendAlertNotificationsToTab(n,r,s){return be(this,null,function*(){s&&(yield c().tabs.update(n,{active:!0})),yield c().tabs.sendMessage(n,{action:"send_alert_notifications",alerts:r})})}_handleExtensionAlertMessage(n){return be(this,null,function*(){const r=this._examTabId||this._universalLaunchTabId;if(!r||!(n==null?void 0:n.var))return;const s=n.var;yield this.sendAlertNotificationsToTab(r,s)})}requestAccess(n,r){c().tabs.sendMessage(r,{action:"test_ready",data:n})}triggerExamSubmissionEvent(n=!1){return be(this,null,function*(){var r;if(this._isLoggingExamSubmissionEvent)return;this._SYNC_isLoggingExamSubmissionEvent=!0;const s=!n&&((r=this._examSubmissionLogData)==null?void 0:r.lmsTypeId)===fe.UNIVERSAL;if(this.closeSidePanel(),this._isExamCurrentlySubmitting||this._isExamTimerExpired){this._handleExamSubmission(s);return}yield this._handleExamWindowClosed(s)})}unpinUniversalLaunchTabs(){return be(this,null,function*(){const n=yield c().tabs.query({url:"https://*.honorlock.com/launch*"}),r=yield c().tabs.get(this.universalLaunchTabId||0);Array.isArray(r)?n.push(...r):n.push(r),n.forEach(s=>{!(s==null?void 0:s.id)||c().tabs.update(s.id,{pinned:!1})})})}endUniversalExamSession(n=!1){return be(this,null,function*(){var r,s,l;if(this._universalLaunchWindowId&&(yield c().windows.update(this._universalLaunchWindowId,{focused:!0}).catch(f=>{})),yield(r=this._browserGuard)==null?void 0:r.stop(),yield(s=this._proctoringActions)==null?void 0:s.resumeAllTabs(),(yield c().tabs.query({})).forEach(f=>{!(f==null?void 0:f.id)||(c().tabs.sendMessage(f.id,{action:"halt_browser_guard"}).catch(T=>{}),c().tabs.sendMessage(f.id,{action:"disable_universal_toolbar"}).catch(T=>{}),c().tabs.sendMessage(f.id,{action:"re_enable_copy_paste"}).catch(T=>{}))}),this._applyToAllFrameContent({},(f,T)=>c().tabs.sendMessage(f.id,{action:"re_enable_copy_paste"},{frameId:T.frameId}).catch(re=>{})).catch(f=>{}),(l=this._injectDisableKeyboardEvents)==null||l.remove(),this._universalLaunchTabId){this._handleEndUniversalExamSessionCleanup(this._universalLaunchTabId,n).catch(f=>{});return}const p=yield c().tabs.query({url:"https://app.honorlock.com/launch"}),w=yield c().tabs.get(this.universalLaunchTabId||0)[0];w&&p.push(w),p.forEach(f=>{f.id&&this._handleEndUniversalExamSessionCleanup(f.id,n).catch(T=>{})})})}_handleEndUniversalExamSessionCleanup(n,r){return be(this,null,function*(){if(c().storage.local.remove(["authentication_complete","has_password_been_inserted"]).catch(s=>{}),r){c().tabs.sendMessage(n,{action:"reset_state",data:{flags:{unificationLaunch:this._isLaunchUnificationFlagOn}}}).catch(s=>{}),c().storage.local.set({exam_state:K.FRESH}).catch(s=>{}),this.isLaunchUnificationFlagOn&&(yield c().tabs.update(n,{active:!0,pinned:!1}),c().tabs.sendMessage(n,{action:"universal_exam_submitted"}).catch(s=>{}));return}c().tabs.sendMessage(n,{action:"universal_exam_submitted"}).catch(s=>{}),yield c().tabs.update(n,{active:!0,pinned:!1})})}_showInExamWebcam(){return be(this,null,function*(){!this._examTabId||(this.setInitialSidePanelState(),yield c().tabs.sendMessage(this._examTabId,{action:"show_exam_webcam"}))})}_updateInExamWebcamNetworkQuality(n){return be(this,null,function*(){!this._examTabId||(yield c().tabs.sendMessage(this._examTabId,{action:"update_network_quality_level",level:n.var}))})}updateActiveInExamWebcamLabel(n){return be(this,null,function*(){var r;const s=String(n.var);c().storage.local.set({webcam_device_label:s}).catch(l=>{}),this._SYNC_currentlyActiveWebcamLabel=s,(r=this._extensionControl)==null||r.sendMessageToAllTabs({action:"update_active_webcam_label",label:s})})}_checkExamPauseStateAndSendSessionData(){return be(this,null,function*(){return yield c().storage.local.get(["student_id","session_id","exam_id","exam_state","pause_reasons","bypass_status"])})}_sendMessageToUpdateExamToolbarElements(n){const r={action:n.message};n.data&&(r.data=n.data),this._examTabId&&c().tabs.sendMessage(this._examTabId,r).catch(s=>{}),this._universalLaunchTabId&&c().tabs.sendMessage(this._universalLaunchTabId,r).catch(s=>{})}_sendMessageForHotkeysDetected(n){!this._examTabId||c().tabs.sendMessage(this._examTabId,n).catch(r=>{})}_getAleksEnvironmentVariables(n){return new Promise(r=>{var s;if(!((s=n.tab)==null?void 0:s.id)){r({});return}const l=()=>{var g,p;const w=(p=(g=window==null?void 0:window.top)==null?void 0:g.smt)==null?void 0:p.studentInfo;return w?{student_name:w.studentName,student_firstname:w.firstname,student_email:w.email,student_username:w.username,school_name:w.schoolName,domain_name:w.domainName,cohort_name:w.cohortName,class_name:w.className}:{}};chrome.scripting.executeScript({target:{tabId:n.tab.id},func:l,world:"MAIN"},g=>{const p=g[0];if(!(p==null?void 0:p.result)){r({});return}r(p.result)})})}_handleOpeningExamToolbarCalculator(n){!this._examTabId||(this._sendMessageToUpdateExamToolbarElements(n),c().tabs.update(this._examTabId,{active:!0}).catch(r=>{}))}_handleUpdatingDisableCopyPasteSetting(n){return be(this,null,function*(){const s=(yield c().storage.local.get(["exam_toggles"])).exam_toggles;!s||!s[b.DISABLE_COPY_PASTE]||(s[b.DISABLE_COPY_PASTE].value=Number(n),c().storage.local.set({exam_toggles:s}).catch(l=>{}))})}_injectHlFrameListener(n){return be(this,null,function*(){var r;!((r=n.tab)==null?void 0:r.id)||!n.frameId||c().scripting.executeScript({target:{tabId:n.tab.id,frameIds:[n.frameId]},files:["js/hl_frame_listener.js"]}).catch(s=>{})})}_injectPlatformListener(n){return be(this,null,function*(){var r,s;if(!((r=n.tab)==null?void 0:r.id))return;this._setupKeepAliveListener();const{is_platform_extension_check_page:l,exam_state:g}=yield c().storage.local.get(["is_platform_extension_check_page","exam_state"]);g&&l&&(yield(s=this._extensionControl)==null?void 0:s.clearLocalStorage()),c().scripting.executeScript({target:{tabId:n.tab.id},files:["js/platform_listener.js"]}).catch(p=>{})})}_injectCanvasRun(n){return be(this,null,function*(){var r;const s=this.examState===K.ACTIVE||this.examState===K.PAUSED;!((r=n.tab)==null?void 0:r.id)||this._lmsId!==fe.CANVAS||!s||(yield c().scripting.executeScript({target:{tabId:n.tab.id},files:["js/canvas_run.js"]}))})}_handleStartExamMessage(){c().storage.local.set({exam_state:K.ACTIVE,authentication_complete:!0}).catch(n=>{}),this.setExamStart(new Date(Date.now()))}storeExamTabInformation(n){var r;!((r=n==null?void 0:n.tab)==null?void 0:r.id)||!n.tab.windowId||(this.setExamTabId(n.tab.id),this.setExamWindowId(n.tab.windowId),c().storage.local.set({exam_tab_id:n.tab.id}).catch(s=>{}))}_setupExamTabNavigationWatchers(){c().tabs.onUpdated.hasListener(this._handleExamTabOnUpdatedEvent)||c().tabs.onUpdated.addListener(this._handleExamTabOnUpdatedEvent),c().tabs.onRemoved.hasListener(this._handleExamTabOnRemovedEvent)||c().tabs.onRemoved.addListener(this._handleExamTabOnRemovedEvent)}_detachExamTabNavigationWatchers(){c().tabs.onUpdated.hasListener(this._handleExamTabOnUpdatedEvent)&&c().tabs.onUpdated.removeListener(this._handleExamTabOnUpdatedEvent),c().tabs.onRemoved.hasListener(this._handleExamTabOnRemovedEvent)&&c().tabs.onRemoved.removeListener(this._handleExamTabOnRemovedEvent)}_handleTriggerExamSubmissionEventMessage(n){var r;((r=n.tab)==null?void 0:r.id)===this._examTabId&&this.triggerExamSubmissionEvent().catch(s=>{})}_handleExamSubmission(n=!1){var r,s,l,g,p,w,f,T,re,j;new Set([fe.PARTNER,fe.UNIVERSAL]).has(Number((r=this._examSubmissionLogData)==null?void 0:r.lmsTypeId))||this._logExamCloseEvent(vr.EXAM_SUBMIT).catch(et=>{}),this._examTabId&&this.closeTabsThatMatchAdditionalUrls(this._examTabId),c().storage.local.remove("fullscreen_override").catch(et=>{}),this.setIsExamCurrentlySubmitting(!1),this.setIsExamTimerExpired(!1),this.setIsRecordScreenExamSettingActive(!1),(s=this._browserGuard)==null||s.disableBrowserGuardAndUpdateExamState(),(l=this._cameraWindowControl)==null||l.sendCloseWebcamMessage({type:"submit"}),(g=this._proctoringActions)==null||g.disableTrackWebTraffic(),(p=this._extensionControl)==null||p.clearLocalStorage().catch(et=>{}),(w=this._extensionControl)==null||w.resetWindowsAndTabState(),(f=this._allowedBrowserAccess)==null||f.resetAllAllowedItemLists(),(T=this._allowedBrowserAccess)==null||T.reopenClosedTabUrls(),(re=this._userPermissionsControl)==null||re.clearActiveCameraSettings(),(j=this._installedExtensionsControl)==null||j.stopWatching(),this._disableKeepAliveListener(),n&&this.endUniversalExamSession(!1).catch(et=>{}),this._SYNC_isLoggingExamSubmissionEvent=!1}_handleExamWindowClosed(n=!1){return be(this,null,function*(){var r,s,l,g,p,w,f,T;const{exam_state:re}=yield c().storage.local.get(["exam_state"]);new Set([K.ACTIVE,K.PAUSED,K.INACTIVE]).has(re)&&this._examTerminated==!1&&this._logExamCloseEvent(vr.EXAM_BROWSER_CLOSED).catch(ke=>{}),this._examTabId&&this.closeTabsThatMatchAdditionalUrls(this._examTabId),(r=this._browserGuard)==null||r.stop().catch(ke=>{}),(s=this._allowedBrowserAccess)==null||s.disableBlockNewTabs(),(l=this._allowedBrowserAccess)==null||l.reopenClosedTabUrls(),(g=this._userPermissionsControl)==null||g.clearActiveCameraSettings(),(p=this._proctoringActions)==null||p.resumeAllTabs(),(w=this._proctoringActions)==null||w.disableTrackWebTraffic(),(f=this._installedExtensionsControl)==null||f.stopWatching(),this._disableKeepAliveListener(),(T=this._cameraWindowControl)==null||T.sendCloseWebcamMessage({type:"relaunch"}),this._examTerminated=!1,n&&this.endUniversalExamSession(!0).catch(ke=>{}),this.isFirstPartyNewCanvasQuiz&&(this._SYNC_examState=K.INACTIVE,yield c().storage.local.set({exam_state:K.INACTIVE}).catch(ke=>{})),this._SYNC_isLoggingExamSubmissionEvent=!1})}_handleExamTerminated(){return be(this,null,function*(){this._examTerminated=!0,this._handleCloseExamTabMessage(),this._logExamCloseEvent(vr.EXAM_TERMINATED).catch(n=>{})})}_logExamCloseEvent(n){return be(this,null,function*(){var r;if(!this._examSubmissionLogData)return;const{bypass_status:s}=yield c().storage.local.get(["bypass_status"]);if(s)return;const l=this._convertExamSubmissionDataToExtensionMessage(Nn({eventType:n},this._examSubmissionLogData));(r=this._cameraWindowControl)==null||r.sendMessageToWebcam("store_log",l)})}_handleCloseExamTabMessage(){var n;if(!this._examTabId||(this._examTerminated&&((n=this._cameraWindowControl)==null?void 0:n.cameraTabId)!=null&&c().tabs.sendMessage(this._cameraWindowControl.cameraTabId,{action:"exam_terminated_log"}).catch(s=>{}),c().tabs.remove(this._examTabId).catch(s=>{}),!this._examTerminated))return;const r=setInterval(s=>{if(!s._examTabId){clearInterval(r);return}c().tabs.remove(s._examTabId).catch(()=>clearInterval(r))},5e3,this)}closeTabsThatMatchAdditionalUrls(n){return be(this,null,function*(){const{additionally_supported_url:r}=yield c().storage.local.get(["additionally_supported_url"]);if(!r)return;(yield c().tabs.query({})).forEach(l=>{l.url&&l.id&&l.url.includes(r)&&l.id!=n&&c().tabs.remove(l.id)})})}_sendHLFrameUpdatePointerEventsMessage(n,r){var s;!((s=r.tab)==null?void 0:s.id)||c().tabs.sendMessage(r.tab.id,Yt(Nn({},n),{message:"hl_frame_update_pointer_events"}))}_sendHLFrameToggleCollapseMessage(n,r){var s;!((s=r.tab)==null?void 0:s.id)||c().tabs.sendMessage(r.tab.id,Yt(Nn({},n),{message:"hl_frame_toggle_collapse"}))}_sendHlFrameOpenMessage(n,r){var s;!((s=r.tab)==null?void 0:s.id)||c().tabs.sendMessage(r.tab.id,Yt(Nn({},n),{message:"hl_frame_open"}))}_setupOnMessageExternalListener(){c().runtime.onMessageExternal.addListener(this._handleOnMessageExternalEvent)}_handleBlackboardUltraExternalMessage(n,r){var s;if(!(n.source!=="bbultra"||!((s=r.tab)==null?void 0:s.id)))return c().tabs.sendMessage(r.tab.id,{action:`bbultra_${n.type}`,data:n.data})}_handleLaunchProctoringIframeMessage(n,r){var s;if(!(n.source!=="HL_LAUNCH_PROCTORING"||!((s=r.tab)==null?void 0:s.id)))return c().tabs.sendMessage(r.tab.id,{action:n.message,launch_proctoring_data:n.launch_proctoring_data})}_handleToggleSidePanelMessage(n=!1){chrome.storage.local.get(["isHonorPanelActive"],r=>{if(r.isHonorPanelActive&&!n){this.closeSidePanel();return}!this._examWindowId||chrome.sidePanel.open({windowId:this._examWindowId})})}setInitialSidePanelState(){this._handleToggleSidePanelMessage(!0)}closeSidePanel(){chrome.storage.local.set({isHonorPanelActive:!1})}isLmsUrlRegexCheck(n,r,s=null,l=!1){const g={[fe.BLACKBOARD_CLASSIC]:[/\bwebapps\/assessment\/take\b|\bultra\/courses\/\b/i],[fe.CANVAS]:[/\bcourses\b.*\bquizzes\b.*\btake\b/i,/\bcourses\b.*\bquizzes/i,/\bcourses\b.*\bassignments\/[0-9]+/i],[fe.ALEKS]:[/\baleks\.com\/alekscgi\b/i],[fe.D2L]:[/\bd2l\/lms\/quizzing\/user\b|\bd2l\/le\/content\/.*\/viewContent\b/i],[fe.UNIVERSAL]:[/\bhttps:\/\/.*\.honorlock\.com\/launch\b/i],[fe.BLACKBOARD_ULTRA]:[/\bblackboard\.com\/ultra\/\b/i],[fe.INTELLUM]:[/\bstudent\/activity\b.*\b|\bstudent\/path\/\b.*\bactivity\b.*\b|\bstudent\/collection\/\b.*\/path\/\b.*\/activity\/\b.*\b/i,/\bhttps:\/\/.*assessment_responses\/take\b/i,/\bhttps:\/\/.*assessment_responses\/confirm_completion\b/i,/\bhttps:\/\/.*assessment_responses\/report\b/i,/\bhttps:\/\/.*assessment_response_questions\/edit\b/i],[fe.PARTNER]:[new RegExp(`${s}/{0,1}.*`,"i")]};return!r||!n||!g[n]?!1:l?r===this.lmsUrl||g[n].some(p=>p.test(r)):g[n].some(p=>p.test(r))}checkIsLmsUrl(n){for(const r in fe)if(this.isLmsUrlRegexCheck(fe[r],n))return!0;return!1}_handleCheckIframesForElementMessage(n,r){return be(this,null,function*(){var s;if(!((s=r.tab)==null?void 0:s.id))return!1;const l=({elementClass:w})=>!!document.querySelector(w);return(yield c().scripting.executeScript({target:{tabId:r.tab.id,allFrames:!0},func:l,args:[n]})).some(w=>w.result===!0)})}get isLaunchUnificationFlagOn(){return this._isLaunchUnificationFlagOn}set _SYNC_isLaunchUnificationFlagOn(n){this._isLaunchUnificationFlagOn=n}setIsLaunchUnificationFlagOn(n){this._SYNC_isLaunchUnificationFlagOn=n}resetState(){this._examState="",this._isExamActive=!1,this._isExamPaused=!1,this._examTabId=null,this._examWindowId=null,this._lmsUrl=null,this._lmsId=null,this._lmsMetadata=null,this._universalPasswordInsertWindowId=null,this._universalLaunchTabId=null,this._universalLaunchWindowId=null,this._isUniversalExitButtonClicked=!1,this._isUniversalExamInitializationScriptInjected=!1,this._currentlyActiveWebcamLabel=""}}const pr=Un;var Ei=Object.defineProperty,kr=Object.getOwnPropertySymbols,br=Object.prototype.hasOwnProperty,Yr=Object.prototype.propertyIsEnumerable,xr=(u,n,r)=>n in u?Ei(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r,h=(u,n)=>{for(var r in n||(n={}))br.call(n,r)&&xr(u,r,n[r]);if(kr)for(var r of kr(n))Yr.call(n,r)&&xr(u,r,n[r]);return u},v=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class m{constructor(){this._cameraTabId=null,this._cameraWindowId=null,this._cameraWindowDimensions={width:432,height:692,paymentScreenHeight:692},this._isInitializingScreenCapture=!1,this._extensionMessageListenerHandlers={show_payment:()=>this._focusCameraWindow(),hide_payment:()=>this._focusCameraWindow(),bypass_payment:()=>v(this,null,function*(){return yield this._bypassPaymentStep()}),cyclevideo:()=>v(this,null,function*(){return yield this._sendCycleVideoMessage()}),webcam_relaunch:()=>v(this,null,function*(){return yield this._handleCameraWindowRelaunch()}),webcam_error:()=>v(this,null,function*(){return yield this._sendWebcamErrorMessage()}),start_room_scan:()=>v(this,null,function*(){return yield this._handleStartRoomScan()}),room_scan_complete:()=>v(this,null,function*(){return yield this._handleCompleteRoomScan()}),close_webcam:n=>v(this,[n],function*({message:r}){return yield this.sendCloseWebcamMessage(r)}),close_all_webcam_windows:()=>v(this,null,function*(){return yield this._handleCloseAllWebcamWindowsMessage()}),focus_webcam:()=>v(this,null,function*(){return yield this._focusCameraWindow()}),webcam_launch:n=>v(this,[n],function*({message:r,sender:s}){return yield this._initCameraWindowLaunch(r,s)}),webcam_launch_external:n=>v(this,[n],function*({message:r,sender:s}){return yield this._initCameraWindowLaunch(r,s,!0)}),webcam_open:n=>v(this,[n],function*({sender:r}){var s;return yield this._handleCameraWindowOpen((s=r.tab)==null?void 0:s.id)}),check_webcam:n=>v(this,[n],function*({sender:r}){var s;return yield this.checkIfWebcamExistsDuringActiveExam((s=r==null?void 0:r.tab)==null?void 0:s.id)}),checklist_complete:n=>v(this,[n],function*({message:r}){return yield this._handleChecklistComplete(r)}),to_camera:n=>v(this,[n],function*({message:r}){return yield this.sendMessageToWebcam(r==null?void 0:r.camera_message,r==null?void 0:r.data)}),minimize_proctor_window:()=>v(this,null,function*(){return yield this._minimizeCameraWindow()}),exam_webcam_begin_button_clicked:n=>v(this,[n],function*({sender:r}){var s;return yield this._handleExamWebcamBeginButtonClicked((s=r==null?void 0:r.tab)==null?void 0:s.id)}),health_check:({sender:n})=>this._respondToCameraWindowHealthCheck(n),camera_offline:()=>{var n;return(n=this._extensionControl)==null?void 0:n.sendMessageToAllTabs({action:"camera_offline"})},get_partner_prelaunch_tos_event:({message:n})=>this._handlePartnerPrelaunchTOSEvent(n==null?void 0:n.var.student_id),request_access_code:({message:n})=>this._handleRequestAccessCode(n),detected_hotkeys_combination:n=>v(this,[n],function*({message:r}){return this._handleHotkeysDetected(r)})},this._handleWebNavigationOnCommittedEvent=n=>{n.tabId!==this._cameraTabId||n.transitionType!=="reload"||this._handleCameraWindowClosedEvent(!0).catch(r=>{})},this._handleCameraTabOnUpdatedEvent=(n,r,s)=>{var l;n!==this._cameraTabId||(r==null?void 0:r.status)!=="complete"||((l=s.url)==null?void 0:l.includes("https://app.honorlock.com/webapp/camera"))||this._handleCameraWindowClosedEvent().catch(g=>{})},this._handleOnRemovedCameraWindowTab=n=>v(this,null,function*(){var r,s,l,g,p;if(!this._cameraWindowId||n!==this._cameraTabId)return;(r=this._examControl)==null||r.closeSidePanel(),this._detachCameraTabNavigationWatchers(),(s=this._allowedBrowserAccess)==null||s.removeAllowedWindowId(this._cameraWindowId),this._handleCameraWindowClosedEvent().catch(f=>{}),yield(l=this._proctoringActions)==null?void 0:l.resumeAllTabs();const{is_universal_lms_exam:w}=yield c().storage.local.get(["is_universal_lms_exam"]);if(w){this._handleUniversalExamOnRemovedCameraWindowTab().catch(f=>{});return}!((g=this._examControl)==null?void 0:g.examTabId)||c().tabs.sendMessage((p=this._examControl)==null?void 0:p.examTabId,{action:"webcam_closed_begin"}).catch(f=>{})}),R(this._extensionMessageListenerHandlers)}init(n){const{extensionControl:r,examControl:s,userPermissionsControl:l,allowedBrowserAccess:g,browserGuard:p,proctoringActions:w,installedExtensionsControl:f,universalLaunchControl:T}=n;this._extensionControl=r,this._examControl=s,this._userPermissionsControl=l,this._allowedBrowserAccess=g,this._browserGuard=p,this._proctoringActions=w,this._installedExtensionsControl=f,this._universalLaunchControl=T}get cameraTabId(){return this._cameraTabId}set _SYNC_cameraTabId(n){this._cameraTabId=n}setCameraTabId(n){this._SYNC_cameraTabId=n}get cameraWindowId(){return this._cameraWindowId}set _SYNC_cameraWindowId(n){this._cameraWindowId=n}setCameraWindowId(n){this._SYNC_cameraWindowId=n}get cameraWindowDimensions(){return this._cameraWindowDimensions}set _SYNC_cameraWindowDimensions(n){this._cameraWindowDimensions=n}setCameraWindowDimensions(n){this._SYNC_cameraWindowDimensions=n}get isInitializingScreenCapture(){return this._isInitializingScreenCapture}set _SYNC_isInitializingScreenCapture(n){this._isInitializingScreenCapture=n}setIsInitializingScreenCapture(n){this._SYNC_isInitializingScreenCapture=n}closeAllCameraWindows(){return v(this,null,function*(){const n=yield c().tabs.query({url:"https://*.honorlock.com/webapp/camera*"});!(n==null?void 0:n.length)||(n.forEach(r=>{!r.id||c().tabs.remove(r.id)}),this._SYNC_cameraTabId=null,this._SYNC_cameraWindowId=null,yield c().storage.local.set({webcam_tab_id:null,camera_state:"closed"}))})}sendMessageToWebcam(n,r){return v(this,null,function*(){if(!n)return;const s={action:n,data:r};if(this._cameraTabId){c().tabs.sendMessage(this._cameraTabId,s).catch(g=>{});return}(yield c().tabs.query({url:"https://*.honorlock.com/webapp/camera*"})).forEach(g=>{!g.id||c().tabs.sendMessage(g.id,s).catch(p=>{})})})}checkIfWebcamExistsDuringActiveExam(n){return v(this,null,function*(){var r;const{exam_state:s}=yield c().storage.local.get(["exam_state"]),l=new Set([void 0,K.PRELAUNCH,K.ROOMSCAN,K.FRESH]);if(!n||!((r=this._examControl)==null?void 0:r.isExamActive)||l.has(s))return;const g=yield c().tabs.query({url:"https://*.honorlock.com/webapp/camera*"});(g==null?void 0:g.length)||(yield c().tabs.sendMessage(n,{action:"relaunch_webcam"}))})}updateIsInsertingUniversalExamPassword(n){this.sendMessageToWebcam("update_is_inserting_universal_exam_password",{is_inserting_universal_exam_password:n}).catch(r=>{})}_bypassPaymentStep(){return v(this,null,function*(){var n;yield(n=this._extensionControl)==null?void 0:n.sendMessageToAllTabs({action:"bypass_payment"})})}_sendCycleVideoMessage(){return v(this,null,function*(){var n;yield(n=this._extensionControl)==null?void 0:n.sendMessageToAllTabs({action:"cyclevideo"})})}sendCloseWebcamMessage(n){return v(this,null,function*(){var r,s,l;n.type==="submit"&&(yield this._focusCameraWindow(),yield c().storage.local.set({exam_state:K.SUBMITTED})),n.type==="relaunch"&&((r=this._examControl)==null?void 0:r.isExamPaused)&&((s=this._proctoringActions)==null||s.resumeAllTabs()),yield(l=this._extensionControl)==null?void 0:l.sendMessageToAllTabs({action:"close_webcam"})})}_focusCameraWindow(){return v(this,null,function*(){!this._cameraWindowId||!this._cameraTabId||(yield c().windows.update(this._cameraWindowId,{focused:!0}),yield c().tabs.update(this._cameraTabId,{active:!0}))})}_handleCameraWindowRelaunch(){return v(this,null,function*(){var n,r;(n=this._installedExtensionsControl)==null||n.startWatching(),yield(r=this._extensionControl)==null?void 0:r.sendMessageToAllTabs({action:"webcam_restarted"})})}_sendWebcamErrorMessage(){return v(this,null,function*(){var n;yield(n=this._extensionControl)==null?void 0:n.sendMessageToAllTabs({action:"webcam_error"})})}_handleStartRoomScan(){return v(this,null,function*(){yield c().storage.local.set({exam_state:K.ROOMSCAN})})}_handleCompleteRoomScan(){return v(this,null,function*(){var n;yield c().storage.local.set({exam_state:K.PRELAUNCH}),(n=this._extensionControl)==null||n.setIsInitializingRecordingSession(!0)})}_initCameraWindowLaunch(n,r,s=!1){return v(this,null,function*(){var l,g,p,w,f,T,re,j,ke,et,It,At;const{exam_state:un}=yield c().storage.local.get(["exam_state"]),En=un===K.ACTIVE?1:Number(n.relaunch),Wn=n.session_id,Ir=n.lms_id,zt=n.display_count,pt=(l=n.is_launched_from_proctoring)!=null?l:0;this._SYNC_cameraWindowDimensions=n.camera_blade_dimensions?h(h({},this._cameraWindowDimensions),n.camera_blade_dimensions):this._cameraWindowDimensions,yield this.closeAllCameraWindows(),c().storage.local.remove(["authentication_complete"]).catch(Ht=>{}),En&&((g=this._browserGuard)==null?void 0:g.forceFocus.isActive)&&((p=this._browserGuard)==null||p.forceFocus.stop());const cn=(w=n.camera_blade_url)!=null?w:`https://app.honorlock.com/webapp/camera?session_id=${Wn}&lms_id=${Ir}&relaunch=${En}&display_count=${zt}&is_launched_from_proctoring=${pt}`,Et=yield c().windows.create({url:cn,type:"popup",left:0,top:0,width:this._cameraWindowDimensions.width,height:this._cameraWindowDimensions.height});!(Et==null?void 0:Et.tabs)||!Et.id||!((f=r==null?void 0:r.tab)==null?void 0:f.windowId)||(s&&((T=this._examControl)==null||T.setUniversalPasswordInsertWindowId(r.tab.windowId),(re=this._examControl)==null||re.setUniversalLaunchTabId(r.tab.id),(j=this._examControl)==null||j.setUniversalLaunchWindowId(r.tab.windowId)),this._SYNC_cameraWindowId=Et.id,this._SYNC_cameraTabId=Et.tabs[0].id,yield c().storage.local.set({webcam_tab_id:Et.tabs[0].id}),(ke=this._allowedBrowserAccess)==null||ke.addAllowedWindowId(Et.id),(et=this._allowedBrowserAccess)==null||et.addAllowedWindowId(r.tab.windowId),En&&((It=this._browserGuard)==null?void 0:It.fullscreen.isActive)&&(yield(At=this._browserGuard)==null?void 0:At.forceFocus.start(!0)),yield c().storage.local.set({camera_state:"open"}),this._setupCameraTabNavigationWatchers())})}_setupCameraTabNavigationWatchers(){chrome.webNavigation.onCommitted.hasListener(this._handleWebNavigationOnCommittedEvent)||chrome.webNavigation.onCommitted.addListener(this._handleWebNavigationOnCommittedEvent),c().tabs.onUpdated.hasListener(this._handleCameraTabOnUpdatedEvent)||c().tabs.onUpdated.addListener(this._handleCameraTabOnUpdatedEvent),c().tabs.onRemoved.hasListener(this._handleOnRemovedCameraWindowTab)||c().tabs.onRemoved.addListener(this._handleOnRemovedCameraWindowTab)}_detachCameraTabNavigationWatchers(){chrome.webNavigation.onCommitted.hasListener(this._handleWebNavigationOnCommittedEvent)&&chrome.webNavigation.onCommitted.removeListener(this._handleWebNavigationOnCommittedEvent),c().tabs.onUpdated.hasListener(this._handleCameraTabOnUpdatedEvent)&&c().tabs.onUpdated.removeListener(this._handleCameraTabOnUpdatedEvent),c().tabs.onRemoved.hasListener(this._handleOnRemovedCameraWindowTab)&&c().tabs.onRemoved.removeListener(this._handleOnRemovedCameraWindowTab)}_handleUniversalExamOnRemovedCameraWindowTab(){return v(this,null,function*(){var n,r,s,l,g,p,w;if(((n=this._universalLaunchControl)==null?void 0:n.isLaunchUnification)||(yield this._closeUniversalExamTabAndReloadLaunchTab()),(r=this._examControl)==null?void 0:r.examTabId){if(!(yield c().tabs.sendMessage((s=this._examControl)==null?void 0:s.examTabId,{action:"check_password_locked"}))){yield(l=this._extensionControl)==null?void 0:l.sendMessageToAllTabs({action:"camera_window_closed"});return}yield(g=this._examControl)==null?void 0:g.unpinUniversalLaunchTabs(),yield c().storage.local.set({exam_state:K.INACTIVE}),yield(p=this._extensionControl)==null?void 0:p.sendMessageToAllTabs({action:"reset_state"});return}yield(w=this._extensionControl)==null?void 0:w.sendMessageToAllTabs({action:"camera_window_closed"}),yield c().storage.local.set({exam_state:K.INACTIVE})})}_closeUniversalExamTabAndReloadLaunchTab(){return v(this,null,function*(){const{exam_state:n,launch_meta:r,password_insert_url:s,launch_tab_id:l}=yield c().storage.local.get(["exam_state","launch_meta","password_insert_url","launch_tab_id"]);if(!new Set([K.INACTIVE,K.PRELAUNCH]).has(n))return;const p=s||(r==null?void 0:r.exam_url),w=new URL(p);(yield c().tabs.query({url:`*://${w==null?void 0:w.hostname}/*`})).forEach(T=>{!T.id||c().tabs.remove(T.id)}),!!l&&c().tabs.reload(l).catch(T=>{})})}_handleCameraWindowOpen(n){return v(this,null,function*(){var r;if(n!==this._cameraTabId)return;const{exam_state:s}=yield c().storage.local.get(["exam_state"]);["active","paused"].includes(s)||(yield c().storage.local.set({exam_state:K.PRELAUNCH})),yield(r=this._extensionControl)==null?void 0:r.sendMessageToAllTabs({action:"webcam_open"})})}_handleCameraWindowClosedEvent(n=!1){return v(this,null,function*(){var r,s,l,g,p,w;(r=this._installedExtensionsControl)==null||r.stopWatching(),((s=this._userPermissionsControl)==null?void 0:s.isUserPermissionsPageBeingForcedActive)&&this._cameraTabId&&(yield c().tabs.remove(this._cameraTabId)),n||(this._SYNC_cameraTabId=null,this._SYNC_cameraWindowId=null),c().storage.local.remove(["authentication_complete"]).catch(T=>{}),yield c().storage.local.set({webcam_tab_id:null,camera_state:"closed"}),yield this.checkIfWebcamExistsDuringActiveExam((l=this._examControl)==null?void 0:l.examTabId);const f={action:"camera_window_closed"};if(!((g=this._examControl)==null?void 0:g.examTabId)){(p=this._extensionControl)==null||p.sendMessageToAllTabs(f).catch(T=>{});return}yield c().tabs.sendMessage((w=this._examControl)==null?void 0:w.examTabId,f)})}_handleCloseAllWebcamWindowsMessage(){return v(this,null,function*(){var n;yield(n=this._proctoringActions)==null?void 0:n.resumeAllTabs(),yield this.closeAllCameraWindows()})}_handleChecklistComplete(n){return v(this,null,function*(){var r,s,l,g,p,w,f,T;if(!((r=this._examControl)==null?void 0:r.examTabId))return;const re=Number((s=n.var)==null?void 0:s.lms_id);if(re===fe.BLACKBOARD_ULTRA||re===fe.PARTNER){c().tabs.sendMessage((l=this._examControl)==null?void 0:l.examTabId,{action:"checklist_complete"});return}const j=(g=n.var)==null?void 0:g.message;if(!j||(c().tabs.sendMessage((p=this._examControl)==null?void 0:p.examTabId,{action:"test_ready",data:j}),re!==fe.ALEKS))return;const ke=yield c().tabs.get((w=this._examControl)==null?void 0:w.examTabId);!((f=ke[0])==null?void 0:f.windowId)||(yield c().tabs.update((T=this._examControl)==null?void 0:T.examTabId,{active:!0}),yield c().windows.update(ke[0].windowId,{focused:!0}))})}_minimizeCameraWindow(){return v(this,null,function*(){var n;!this._cameraWindowId||(yield c().windows.update(this._cameraWindowId,{state:"minimized"}),((n=this._examControl)==null?void 0:n.universalPasswordInsertWindowId)&&this.updateIsInsertingUniversalExamPassword(!1))})}_handleExamWebcamBeginButtonClicked(n){return v(this,null,function*(){var r,s;!this._cameraTabId&&n&&n!==((r=this._examControl)==null?void 0:r.examTabId)&&(this._SYNC_cameraTabId=n),!!this._cameraTabId&&((s=this._proctoringActions)==null||s.removeKeepTabsPausedCallback(),yield c().tabs.sendMessage(this._cameraTabId,{action:"exam_webcam_begin_button_clicked"}))})}_respondToCameraWindowHealthCheck(n){var r;const s=this._cameraTabId||((r=n.tab)==null?void 0:r.id);!s||c().tabs.sendMessage(s,{action:"health_check"}).catch(l=>{})}_handlePartnerPrelaunchTOSEvent(n){!this._examControl||!this._examControl.examTabId||c().tabs.sendMessage(this._examControl.examTabId,{action:"log_partner_prelaunch_tos_event",data:{student_id:n}}).catch(r=>{})}_handleRequestAccessCode(n){!this._cameraTabId||c().tabs.sendMessage(this._cameraTabId,{action:"request_external_access",data:{location_url:n.current_url}})}_handleHotkeysDetected(n){return v(this,null,function*(){!this._cameraTabId||(yield c().tabs.sendMessage(this._cameraTabId,{action:"detected_hotkeys",data:n.data}))})}resetState(){this._cameraTabId=null,this._cameraWindowId=null,this._cameraWindowDimensions={width:432,height:692,paymentScreenHeight:692},this._isInitializingScreenCapture=!1}}const E=m;class y{constructor(n){this._items=new Set;const r=n.map(s=>this._normalizeItem(s));this._defaultItems=new Set(r)}addItem(n){const r=this._normalizeItem(n);this._items.add(r)}removeItem(n){const r=this._normalizeItem(n);this._items.delete(r)}resetAllowedItems(n=[]){const r=n.map(s=>this._normalizeItem(s));this._items=new Set(r)}getItems(){return[...this._items,...this._defaultItems]}getDefaultItems(){return[...this._defaultItems]}isAllowedItem(n){return this._checkIfIsAllowedItem(n,!0)}isDefaultItem(n){return this._checkIfIsAllowedItem(n)}_checkIfIsAllowedItem(n,r=!1){return n?(r?this._items.has(n)||this._defaultItems.has(n):this._defaultItems.has(n))?!0:(r?this.getItems():this.getDefaultItems()).some(g=>typeof g!="number"&&this._removeProtocol(String(n)).includes(g)):!1}_normalizeItem(n){return typeof n=="string"?this._removeProtocol(n):n}_removeProtocol(n){return n.toLowerCase().replace(/^(?:https?:\/\/)?(?:www\.)?/i,"")}}const A=y;var O=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class W{constructor(){this._isBlockingAccess=!1,this._allowedLists={},this._allowedWebsites=[],this._allowedWindowIds=[],this._allowedTabIds=[],this._closedTabUrls=[],this._defaultWebsiteItems=["chrome://","honorlock://","honorlock.kb.help","honorlock.com/calc","honorlock.com/launch","honorlock.com/assets/","honorlock.com/wp-content/","honorlock.com/webapp/camera","honorlock.com/calc/scientific","honorlock.com/proctoring/chat",`chrome-extension://${c().runtime.id}/`],this._extensionMessageListenerHandlers={close_tabs:n=>O(this,[n],function*({message:r}){return yield this._closeTabsOnInit(r.var,!0)}),whitelist_urls:n=>O(this,[n],function*({message:r,sender:s}){return yield this._setupAllowUrlsList(r,s)}),get_internal_whitelist:({sender:n})=>this._getInternalAllowList(n)},this._closeTabOnUpdatedHandler=(n,r,s)=>O(this,null,function*(){var l,g;if(r.status!=="loading"||this._isAllowedTab(s.url,n))return;yield c().tabs.remove(n);const p=yield(l=this._localizationControl)==null?void 0:l.getTranslation("browserguard.site_not_permitted");!p||(g=this._examControl)==null||g.sendSingleAlertNotification(p)}),R(this._extensionMessageListenerHandlers)}init(n){var r,s,l;const{localizationControl:g,examControl:p,cameraWindowControl:w}=n;this._localizationControl=g,this._examControl=p,this._cameraWindowControl=w,[{type:"websites",defaultItems:this._defaultWebsiteItems},{type:"windowIds"},{type:"tabIds"}].forEach(T=>{this.addAllowedList(T)}),((r=this._allowedWebsites)==null?void 0:r.length)&&this._allowedWebsites.forEach(T=>this.addAllowedWebsite(T)),((s=this._allowedWindowIds)==null?void 0:s.length)&&this._allowedWindowIds.forEach(T=>this.addAllowedWindowId(T)),((l=this._allowedTabIds)==null?void 0:l.length)&&this._allowedTabIds.forEach(T=>this.addAllowedTabId(T))}get isBlockingAccess(){return this._isBlockingAccess}set _SYNC_isBlockingAccess(n){this._isBlockingAccess=n}set _SYNC_allowedWebsites(n){this._allowedWebsites=n}addAllowedWebsite(n){var r;(r=this._allowedLists.websites)==null||r.addItem(n),new Set(this._allowedWebsites).has(n)||(this._SYNC_allowedWebsites=this._allowedLists.websites.getItems())}removeAllowedWebsite(n){var r;(r=this._allowedLists.websites)==null||r.removeItem(n),new Set(this._allowedWebsites).has(n)&&(this._SYNC_allowedWebsites=this._allowedLists.websites.getItems())}set _SYNC_allowedWindowIds(n){this._allowedWindowIds=n}addAllowedWindowId(n){var r;(r=this._allowedLists.windowIds)==null||r.addItem(n),new Set(this._allowedWindowIds).has(n)||(this._SYNC_allowedWindowIds=this._allowedLists.windowIds.getItems())}removeAllowedWindowId(n){var r;(r=this._allowedLists.windowIds)==null||r.removeItem(n),new Set(this._allowedWindowIds).has(n)&&(this._SYNC_allowedWindowIds=this._allowedLists.windowIds.getItems())}set _SYNC_allowedTabIds(n){this._allowedTabIds=n}set _SYNC_closedTabUrls(n){this._closedTabUrls=n}addAllowedTabId(n){var r;(r=this._allowedLists.tabIds)==null||r.addItem(n),new Set(this._allowedTabIds).has(n)||(this._SYNC_allowedTabIds=this._allowedLists.tabIds.getItems())}removeAllowedTabId(n){var r;(r=this._allowedLists.tabIds)==null||r.removeItem(n),new Set(this._allowedTabIds).has(n)&&(this._SYNC_allowedTabIds=this._allowedLists.tabIds.getItems())}get websites(){return this._allowedLists.websites}get windowIds(){return this._allowedLists.windowIds}get tabIds(){return this._allowedLists.tabIds}addAllowedList({type:n,defaultItems:r=[]}){!n||(this._allowedLists[n]=new A(r))}removeAllowedList(n){delete this._allowedLists[n]}enableBlockNewTabs(){return O(this,null,function*(){if(this._isBlockingAccess)return;(yield c().tabs.query({})).forEach(r=>{!r.url||!r.id||this._allowedLists.websites.isAllowedItem(r.url)||this._allowedLists.tabIds.isAllowedItem(r.id)||c().tabs.remove(r.id)}),c().tabs.onUpdated.hasListener(this._closeTabOnUpdatedHandler)||c().tabs.onUpdated.addListener(this._closeTabOnUpdatedHandler),this._SYNC_isBlockingAccess=!0})}disableBlockNewTabs(){c().tabs.onUpdated.removeListener(this._closeTabOnUpdatedHandler),this._SYNC_isBlockingAccess=!1}resetAllAllowedItemLists(){for(const n in this._allowedLists)this._allowedLists[n].resetAllowedItems([]);this._SYNC_allowedWebsites=[],this._SYNC_allowedWindowIds=[],this._SYNC_allowedTabIds=[]}_setupAllowUrlsList(n,r){return O(this,null,function*(){if(!(n==null?void 0:n.var))return;const s=Number(n.var.reset)===1,l=Number(n.var.lms_id);s&&this.disableBlockNewTabs(),!this._isBlockingAccess&&(yield this._handleSetAllowItems(n,r,s),yield this._handleEnableBlockTabs(n,s,l))})}_handleSetAllowItems(n,r,s){return O(this,null,function*(){var l,g,p,w,f,T;if(!(n==null?void 0:n.var))return;n.var.whitelist&&this._allowedLists.websites.resetAllowedItems(n.var.whitelist);const{additionally_supported_url:re}=yield c().storage.local.get(["additionally_supported_url"]);if(re&&this.addUrlToAllowList(re),(l=r.tab)==null?void 0:l.id){const et=[r.tab.id];((g=this._examControl)==null?void 0:g.universalLaunchTabId)&&et.push((p=this._examControl)==null?void 0:p.universalLaunchTabId),this._allowedLists.tabIds.resetAllowedItems(et)}const j=Number(n.var.whitelistTab);if(j!==-1&&this.addAllowedTabId(j),!((w=this._examControl)==null?void 0:w.examTabId)||(this.addAllowedTabId((f=this._examControl)==null?void 0:f.examTabId),!s))return;const ke=Array.isArray(n.var.whitelist)?n.var.whitelist.filter(et=>{var It;return((It=n==null?void 0:n.var)==null?void 0:It.universal_whitelist_url)?et!==n.var.universal_whitelist_url:et}):[];yield c().tabs.sendMessage((T=this._examControl)==null?void 0:T.examTabId,{action:"update_toolbar_whitelist_urls",data:ke})})}_handleEnableBlockTabs(n,r,s){return O(this,null,function*(){var l;if(!(n==null?void 0:n.var))return;const g=Number(n.var.enable)===1;if(r&&!g||(yield this.enableBlockNewTabs(),!(yield this._closeTabsOnInit(s))))return;const w=yield(l=this._localizationControl)==null?void 0:l.getTranslation("background.non_white_listed_tabs_closed");!w||this._allowedLists.tabIds.getItems().forEach(f=>{this._handleItemsClosedMessageOnReload(Number(f),w)})})}_handleItemsClosedMessageOnReload(n,r){var s;if(n===((s=this._cameraWindowControl)==null?void 0:s.cameraTabId))return;const l=(g,p)=>{n!==g||p.status!=="complete"||(c().tabs.sendMessage(Number(n),{action:"custom_msg",msg:r,type:"error"}),c().tabs.onUpdated.removeListener(l))};c().tabs.onUpdated.hasListener(l)||c().tabs.onUpdated.addListener(l)}addUrlToAllowList(n){!this._allowedLists.websites||!n||this.addAllowedWebsite(n)}_getItemsFromAllowList(n,r=!1){return this._allowedLists[n]?r?this._allowedLists[n].getDefaultItems():this._allowedLists[n].getItems():[]}_getInternalAllowList(n){return!n.tab||!n.tab.id?{result:[],sender:""}:{result:this._getItemsFromAllowList("websites",!0),sender:n.tab.url||""}}_closeTabsOnInit(n,r=!1){return O(this,null,function*(){if(!n)return!1;let s=!1;const l=[...this._closedTabUrls];return(yield c().tabs.query({})).forEach(p=>{const w=r?this._isProctoringInitAllowedTab(Number(n),p):this._isAllowedTab(p.url,p.id);!p.id||w||(p.url&&l.push(p.url),c().tabs.remove(p.id),s=!0)}),this._SYNC_closedTabUrls=l,s})}_isProctoringInitAllowedTab(n,r){var s;return r.id===((s=this._examControl)==null?void 0:s.examTabId)||this._allowedLists.websites.isAllowedItem(r.url)}_isAllowedTab(n,r){return this._allowedLists.websites.isAllowedItem(n)||this._allowedLists.tabIds.isAllowedItem(r)}reopenClosedTabUrls(){this._closedTabUrls.length<1||(this._closedTabUrls.forEach(n=>{c().tabs.create({url:n,active:!1}).catch(r=>{})}),this.resetClosedTabUrls())}resetClosedTabUrls(){this._SYNC_closedTabUrls=[]}resetState(){this._isBlockingAccess=!1,this.resetAllAllowedItemLists(),this.resetClosedTabUrls()}}const D=W;var B=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class F{constructor(){this._injectedFrames=new Set([]),this._injectScripts=new Map,this._handleNavigationOnCompleteEvent=n=>B(this,null,function*(){const r=n.url,s=n.frameId;this._injectedFrames.add(r),this._SYNC_injectedFrames=this._injectedFrames,yield this._injectAllScripts(s)}),this._handleOnBeforeNavigateEvent=n=>{if(this._injectedFrames.has(n.url)){this._injectedFrames.delete(n.url),this._SYNC_injectedFrames=this._injectedFrames;return}this._injectedFrames.forEach(r=>{n.url.indexOf(r)>-1&&this._injectedFrames.delete(r)}),this._SYNC_injectedFrames=this._injectedFrames}}addInjectableScripts(n,r){return B(this,null,function*(){var s;if(!n)return Promise.resolve();this._setupEventListeners();const l=g=>B(this,null,function*(){if(!g.tabId)return Promise.resolve();const p=yield c().webNavigation.getAllFrames({tabId:g.tabId});p==null||p.forEach(w=>{this._handleNavigationOnCompleteEvent({tabId:n,url:w.url,frameId:w.frameId,timeStamp:Date.now()})})});this._injectScripts.has(n)||this._injectScripts.set(n,new Set),r instanceof Array?r.forEach(g=>{var p;(p=this._injectScripts.get(n))==null||p.add(g)}):(s=this._injectScripts.get(n))==null||s.add(r),this._SYNC_injectedScripts=this._injectScripts,yield Promise.all(Array.from(this._injectScripts).map(([g,p])=>l({tabId:g,files:p})))})}set _SYNC_injectedFrames(n){this._injectedFrames=n}set _SYNC_injectedScripts(n){this._injectScripts=n}remove(){this._detachEventListeners(),this._injectedFrames.clear(),this._SYNC_injectedFrames=this._injectedFrames,this._injectScripts.clear(),this._SYNC_injectedScripts=this._injectScripts}_setupEventListeners(){c().webNavigation.onCompleted.hasListener(this._handleNavigationOnCompleteEvent)||c().webNavigation.onCompleted.addListener(this._handleNavigationOnCompleteEvent),c().webNavigation.onBeforeNavigate.hasListener(this._handleOnBeforeNavigateEvent)||c().webNavigation.onBeforeNavigate.addListener(this._handleOnBeforeNavigateEvent)}_detachEventListeners(){c().webNavigation.onCompleted.hasListener(this._handleNavigationOnCompleteEvent)&&c().webNavigation.onCompleted.removeListener(this._handleNavigationOnCompleteEvent),c().webNavigation.onBeforeNavigate.hasListener(this._handleOnBeforeNavigateEvent)&&c().webNavigation.onBeforeNavigate.removeListener(this._handleOnBeforeNavigateEvent)}_injectAllScripts(n){const r=Array.from(this._injectScripts).map(([s,l])=>({tabId:s,files:Array.from(l)}));return Promise.all(r.map(s=>c().scripting.executeScript({target:{tabId:s.tabId,frameIds:[n]},files:s.files})))}resetState(){this._injectedFrames.clear(),this._injectScripts.clear(),this._SYNC_injectedScripts=this._injectScripts}}const $=F;var ie=Object.defineProperty,xe=Object.defineProperties,ve=Object.getOwnPropertyDescriptors,je=Object.getOwnPropertySymbols,Qe=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable,sn=(u,n,r)=>n in u?ie(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r,Zn=(u,n)=>{for(var r in n||(n={}))Qe.call(n,r)&&sn(u,r,n[r]);if(je)for(var r of je(n))xt.call(n,r)&&sn(u,r,n[r]);return u},zr=(u,n)=>xe(u,ve(n)),Ee=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class ts{constructor(){this._chromeSystemDisplayGetInfo=Y,this._appUrl=null,this._isProctoringChatActive=!1,this._isTrackingWebTraffic=!1,this._proctoringChatGlob="https://app.honorlock.com/proctoring/chat*",this._eventHandlersMemo={},this._keepTabsPausedCallback=this._keepTabsPaused.bind(this),this._isResumingAllTabs=!1,this._extensionMessageListenerHandlers={proctoring_check:()=>Ee(this,null,function*(){return yield this._getExamProctoringState()}),livelook_begin_flag:({message:n})=>{var r;return(r=this._cameraWindowControl)==null?void 0:r.sendMessageToWebcam(n.message,n.data)},livelook_complete_flag:({message:n})=>{var r;return(r=this._cameraWindowControl)==null?void 0:r.sendMessageToWebcam(n.message,n.data)},store_log:({message:n})=>{var r;return(r=this._cameraWindowControl)==null?void 0:r.sendMessageToWebcam(n.message,n.data)},livechat_command_nextstep:({message:n})=>this._sendProctoringMessageToAllTabs(n),pause_all_tabs:n=>Ee(this,[n],function*({message:r,sender:s}){return yield this._handlePauseAllTabsMessage(r,s)}),resume_all_tabs:()=>Ee(this,null,function*(){return yield this._resumeTabsAndUpdateExamState()}),clear_all_tabs:()=>Ee(this,null,function*(){return yield this.resumeAllTabs()}),send_chat:()=>this._sendChatMessage(),display_count:n=>Ee(this,[n],function*({sender:r}){return yield this._trackUserDisplayCount(r)}),display_count_bypass:()=>this._setDisplayCountBypass(),display_count_pause_menu:()=>{var n;return this._updateUserDisplayCount((n=this._cameraWindowControl)==null?void 0:n.cameraTabId)},tab_count:n=>Ee(this,[n],function*({message:r,sender:s}){return yield this._trackUserTabCount(r,s)})},this._handleTabsOnUpdatedEvent=()=>{const n="proctoringActionsHandleTabsOnUpdatedEvent";return this._eventHandlersMemo[n]||(this._eventHandlersMemo[n]=(r,s,l)=>this._logWebTrafficEvent(r,s,l))},this._logWebTrafficEvent=(n,r,s)=>Ee(this,null,function*(){var l,g,p,w,f,T,re,j,ke,et,It;if(r.status===void 0||r.status!=="loading"||!s.url)return;const{app_url:At,lms_id:un,launch_meta:En,password_insert_url:Wn,is_universal_lms_exam:Ir}=yield c().storage.local.get(["app_url","lms_id","launch_meta","is_universal_lms_exam","password_insert_url"]),zt=un||(En==null?void 0:En.lms_id),pt=new URL(s.url).hostname;if(this._isTrackingWebTraffic===!1||!((l=this._cameraWindowControl)==null?void 0:l.cameraTabId)||((g=s.url)==null?void 0:g.includes("chrome://newtab"))||((p=this._examControl)==null?void 0:p.isLmsUrlRegexCheck(Number(zt),s.url,At))||Ir&&pt.includes(Wn)||((w=this._allowedBrowserAccess)==null?void 0:w.websites.isDefaultItem(s.url)))return;if(((f=this._allowedBrowserAccess)==null?void 0:f.isBlockingAccess)===!1){if(s.id===((T=this._examControl)==null?void 0:T.examTabId))return;c().tabs.sendMessage((re=this._cameraWindowControl)==null?void 0:re.cameraTabId,{action:"log_web_traffic",data:s}).catch(Ht=>{});return}const cn=(j=this._allowedBrowserAccess)==null?void 0:j.websites.isAllowedItem(s.url),Et=zr(Zn({},s),{isAllowedItem:cn,lmsId:zt});cn===!0&&c().tabs.sendMessage((ke=this._cameraWindowControl)==null?void 0:ke.cameraTabId,{action:"log_web_traffic_whitelisted",data:Et}).catch(Ht=>{}),cn===!1&&c().tabs.sendMessage((et=this._cameraWindowControl)==null?void 0:et.cameraTabId,{action:"log_web_traffic_blocked",data:Et}).catch(Ht=>{}),cn===void 0&&c().tabs.sendMessage((It=this._cameraWindowControl)==null?void 0:It.cameraTabId,{action:"log_web_traffic",data:Et}).catch(Ht=>{})}),R(this._extensionMessageListenerHandlers)}removeKeepTabsPausedCallback(){c().tabs.onUpdated.removeListener(this._keepTabsPausedCallback)}init(n){const{userInfo:r,localizationControl:s,extensionControl:l,examControl:g,cameraWindowControl:p,allowedBrowserAccess:w,userPermissionsControl:f}=n;this._userInfo=r,this._localizationControl=s,this._extensionControl=l,this._examControl=g,this._cameraWindowControl=p,this._allowedBrowserAccess=w,this._userPermissionsControl=f}set _SYNC_appUrl(n){this._appUrl=n}set _SYNC_isProctoringChatActive(n){this._isProctoringChatActive=n}set _SYNC_isTrackingWebTraffic(n){this._isTrackingWebTraffic=n}disableTrackWebTraffic(){return Ee(this,null,function*(){var n;(n=this._allowedBrowserAccess)==null||n.disableBlockNewTabs(),c().tabs.onUpdated.removeListener(this._handleTabsOnUpdatedEvent()),this._SYNC_isTrackingWebTraffic=!1})}resumeAllTabs(){return Ee(this,null,function*(){var n,r,s;if(this._isResumingAllTabs)return;this._isResumingAllTabs=!0,c().tabs.onUpdated.removeListener(this._keepTabsPausedCallback),(n=this._examControl)==null||n.setIsExamPaused(!1),(yield c().tabs.query({})).forEach(g=>{!g.id||!g.url||g.url.startsWith("chrome://")||c().scripting.executeScript({target:{tabId:g.id},files:["js/resume_tabs.js"]}).catch(p=>{})}),((r=this._examControl)==null?void 0:r.examTabId)&&c().tabs.sendMessage((s=this._examControl)==null?void 0:s.examTabId,{message:"reinitialize_exam_setup"}).catch(g=>{}),this._isResumingAllTabs=!1})}pauseAllTabs(){return Ee(this,arguments,function*(n=!1,r=[],s=!1){var l,g;(l=this._examControl)==null||l.setIsExamPaused(!0),c().storage.local.set({pause_reasons:r,exam_state:K.PAUSED}).catch(j=>{});const p=yield c().tabs.query({}),{lms_id:w}=yield c().storage.local.get(["lms_id"]),f=p.map(function(j){return{id:j.id,url:j.url}}),T=f.find(j=>{var ke;return j.id===((ke=this._examControl)==null?void 0:ke.examTabId)});let re=[];T||(re=f.filter(j=>{var ke;return(ke=this._examControl)==null?void 0:ke.isLmsUrlRegexCheck(w,j.url)})),!!((g=this._examControl)==null?void 0:g.isExamPaused)&&(p.forEach(j=>{var ke,et,It,At,un;if(!j.id||!j.url)return;const En=j.pendingUrl||j.url;if(n&&j.id===((ke=this._examControl)==null?void 0:ke.examTabId)||((et=this._allowedBrowserAccess)==null?void 0:et.websites.isDefaultItem(En)))return;const Wn={tabId:j.id},Ir=(Ht,ua,ca,da)=>{globalThis.camera_relaunch=Ht,globalThis.isExamTab=ua,globalThis.pause_reasons=ca,globalThis.establishExamTab=da},zt=s||((It=this._examControl)==null?void 0:It.isExamActive)&&!((At=this._cameraWindowControl)==null?void 0:At.cameraTabId),pt=j.id===((un=this._examControl)==null?void 0:un.examTabId),cn=r.length?JSON.stringify(r):"[]";let Et=!1;T||(Et=!!re.find(Ht=>Ht.url===j.url)),c().scripting.insertCSS({target:Wn,files:["css/pause_tabs_styles.css"]}).catch(Ht=>{}),c().scripting.executeScript({target:Wn,func:Ir,args:[zt,pt,cn,Et]}).then(()=>{c().scripting.executeScript({target:Wn,files:["js/pause_tabs.js"]}).catch(Ht=>{})}).catch(Ht=>{})}),c().tabs.onUpdated.hasListener(this._keepTabsPausedCallback)||c().tabs.onUpdated.addListener(this._keepTabsPausedCallback))})}_keepTabsPaused(n,r){return Ee(this,null,function*(){if((r==null?void 0:r.status)!=="complete")return;const{exam_state:s,pause_reasons:l,exam_tab_id:g,webcam_tab_id:p}=yield c().storage.local.get(["exam_state","pause_reasons","exam_tab_id","webcam_tab_id"]);this._isResumingAllTabs||n===g||n===p||s===K.PAUSED&&(yield this.pauseAllTabs(!1,l))})}initializeProctoring(n){return Ee(this,null,function*(){var r,s,l,g,p;if(n.type!=="proctoring")return;this._SYNC_isProctoringChatActive=!0;const w=n.data;w&&((r=this._userInfo)==null||r.setSessionData({student_name:w.student_name,student_email:w.student_email,chat_url:w.chat_url}));const f=yield(s=this._userInfo)==null?void 0:s.getSessionData();yield this._loadAppUrl(),(l=this._cameraWindowControl)==null||l.sendMessageToWebcam("livelook_begin_flag",{student_id:f==null?void 0:f.student_id,type:"livelook_begin",paused_exam:1}).catch(j=>{}),c().storage.local.set({proctoring_state:!0}).catch(j=>{});const re=(yield c().tabs.query({url:this._proctoringChatGlob}))[0];if(((g=this._examControl)==null?void 0:g.examTabId)&&c().tabs.sendMessage((p=this._examControl)==null?void 0:p.examTabId,{action:"proctoring_started"}).catch(j=>{}),re==null?void 0:re.id){c().tabs.update(re.id,{active:!0}).catch(j=>{});return}c().tabs.create({active:!0,url:f==null?void 0:f.chat_url,pinned:!0}).catch(j=>{})})}endProctoring(n){return Ee(this,null,function*(){var r,s,l,g,p,w,f;if(n.type!=="proctoring")return;this._SYNC_isProctoringChatActive=!1;const T=yield(r=this._userInfo)==null?void 0:r.getSessionData();n.send_livelook_complete_event&&((s=this._cameraWindowControl)==null||s.sendMessageToWebcam("trigger_livelook_complete_event").catch(j=>{})),(l=this._cameraWindowControl)==null||l.sendMessageToWebcam("livelook_complete_flag",{student_id:T==null?void 0:T.student_id,type:"livelook_complete",paused_exam:0}).catch(j=>{}),(yield c().tabs.query({url:this._proctoringChatGlob})).forEach(j=>{!(j==null?void 0:j.id)||c().tabs.remove(j.id)}),c().storage.local.remove(["proctoring_state"]).catch(j=>{}),((g=this._cameraWindowControl)==null?void 0:g.cameraTabId)&&this._resumeTabsAndUpdateExamState().catch(j=>{}),!!((p=this._examControl)==null?void 0:p.examTabId)&&(c().tabs.sendMessage((w=this._examControl)==null?void 0:w.examTabId,{action:"proctoring_ended"}).catch(j=>{}),c().tabs.update((f=this._examControl)==null?void 0:f.examTabId,{active:!0}).catch(j=>{}))})}_getUniversalLaunchOrExamTabId(){return Ee(this,null,function*(){var n,r;let s=((n=this._examControl)==null?void 0:n.universalLaunchTabId)||((r=this._examControl)==null?void 0:r.examTabId);if(!s){const l=yield c().storage.local.get(["launch_tab_id","exam_tab_id"]);s=l.launch_tab_id||l.exam_tab_id}return Number(s)})}_getExamProctoringState(){return Ee(this,null,function*(){return(yield c().storage.local.get(["proctoring_state"])).proctoring_state})}_sendProctoringMessageToAllTabs(n){var r;(r=this._extensionControl)==null||r.sendMessageToAllTabs({action:n.message}).catch(s=>{})}_handlePauseAllTabsMessage(n,r){return Ee(this,null,function*(){var s,l,g,p;if(!((s=this._examControl)==null?void 0:s.examTabId)&&r.tab&&((l=this._examControl)==null||l.setExamTabId(r.tab.id),(g=this._examControl)==null||g.setExamWindowId(r.tab.windowId)),(p=this._userPermissionsControl)==null?void 0:p.isUserPermissionsPageBeingForcedActive)return;const w=n.type==="livelook",f=n.reason||[],T=!!n.relaunch;yield this.pauseAllTabs(w,f,T),c().storage.local.set({exam_state:K.PAUSED,pause_reasons:f}).catch(re=>{})})}_resumeTabsAndUpdateExamState(){return Ee(this,null,function*(){if(this._isProctoringChatActive)return;if(c().tabs.onUpdated.removeListener(this._keepTabsPausedCallback),(yield c().storage.local.get(["exam_state"])).exam_state!==K.PAUSED){yield this.resumeAllTabs();return}c().storage.local.set({exam_state:K.ACTIVE,pause_reasons:[]}).catch(s=>{}),yield this.resumeAllTabs()})}_sendChatMessage(){return Ee(this,null,function*(){const n=yield this._getUniversalLaunchOrExamTabId();!n||c().tabs.sendMessage(n,{action:"send_chat"}).catch(r=>{})})}_setDisplayCountBypass(){c().storage.local.set({display_count_bypass:1}).catch(n=>{})}_trackUserDisplayCount(n){return Ee(this,null,function*(){var r;const s=(r=n.tab)==null?void 0:r.id;yield this._updateUserDisplayCount(s),chrome.system.display.onDisplayChanged.addListener(()=>Ee(this,null,function*(){return yield this._updateUserDisplayCount(s)}))})}_updateUserDisplayCount(n){return Ee(this,null,function*(){if(!n)return;const r=yield this._chromeSystemDisplayGetInfo();c().storage.local.set({display_count:r.length}).catch(s=>{}),c().tabs.sendMessage(n,{action:"display_count",data:r.length}).catch(s=>{})})}_trackUserTabCount(n,r){return Ee(this,null,function*(){var s;const l=Number(n.var),g=(s=r.tab)==null?void 0:s.id;yield this._updateUserTabCount(l,g),!n.test_page&&(c().tabs.onCreated.addListener(()=>Ee(this,null,function*(){return yield this._updateUserTabCount(l,g)})),c().tabs.onRemoved.addListener(()=>Ee(this,null,function*(){return yield this._updateUserTabCount(l,g)})))})}_updateUserTabCount(n,r){return Ee(this,null,function*(){if(!n||!r)return;yield this._loadAppUrl();const s=[],l=yield c().tabs.query({});for(const g of l)!g.id||this._isUncountedTab(n,g)||s.push(g.id);c().tabs.sendMessage(r,{action:"tab_count",data:s.length}).catch(g=>{})})}_loadAppUrl(){return Ee(this,null,function*(){if(!this._appUrl){const n=yield c().storage.local.get("app_url");this._SYNC_appUrl=n.app_url}})}_isUncountedTab(n,r){var s,l;return Boolean(r.id===((s=this._examControl)==null?void 0:s.examTabId))||Boolean((l=this._allowedBrowserAccess)==null?void 0:l.websites.isAllowedItem(r.url))}setupTrackWebTraffic(n,r){return Ee(this,null,function*(){var s,l,g;((s=r.tab)==null?void 0:s.id)&&((l=this._cameraWindowControl)==null?void 0:l.cameraTabId)!==r.tab.id&&((g=this._cameraWindowControl)==null||g.setCameraTabId(r.tab.id)),!this._isTrackingWebTraffic&&(this._SYNC_isTrackingWebTraffic=!0,c().tabs.onUpdated.hasListener(this._handleTabsOnUpdatedEvent())||c().tabs.onUpdated.addListener(this._handleTabsOnUpdatedEvent()))})}resetState(){this._appUrl=null,this._isProctoringChatActive=!1,this._isTrackingWebTraffic=!1}}const Ci=ts;var Le=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class wr{constructor(){this._isActive=!1,this._fullscreen={isActive:!1,start:()=>Le(this,null,function*(){yield this._startFullscreen()}),stop:()=>Le(this,null,function*(){yield this._stopFullscreen()})},this._forceFocus={isActive:!1,isBrowserIdle:!1,isSendingFocusLostMessage:!0,isExamInitializing:!0,getCurrentWindowInterval:null,focusedWindowStartId:null,focusedWindowStartBounds:null,start:(n=!1,r=.5)=>Le(this,null,function*(){yield this._startForceFocus(n,r)}),stop:()=>{this._stopForceFocus()}},this._extensionMessageListenerHandlers={inject_shortcut_detection:()=>Le(this,null,function*(){return yield this._injectShortcutDetection()}),detected_shortcut_usage:({message:n})=>this._detectedShortcutUsage(n),focus_page:n=>Le(this,[n],function*({sender:r}){var s,l;return yield this._forceBrowserFocus((s=r.tab)==null?void 0:s.windowId,(l=r.tab)==null?void 0:l.id)}),focus_exam_webcam:()=>Le(this,null,function*(){var n,r;return yield this._forceBrowserFocus((n=this._examControl)==null?void 0:n.examWindowId,(r=this._examControl)==null?void 0:r.examTabId)})},this._windowOnBoundsChangedHandler=n=>Le(this,null,function*(){var r,s;if(n.id!==((r=this._examControl)==null?void 0:r.examWindowId))return;(yield this._isFocusedWindowFullscreen(n))||(yield this._logFocusLost(),yield this._setExamWindowStateFullscreen((s=this._examControl)==null?void 0:s.examWindowId))}),this._onFocusedChangedHandler=n=>Le(this,null,function*(){var r,s;((r=this._allowedBrowserAccess)==null?void 0:r.windowIds.isAllowedItem(n))||(yield this._logFocusLost(),yield this._setExamWindowStateFullscreen((s=this._examControl)==null?void 0:s.examWindowId))}),this._getCurrentWindowIntervalHandler=()=>Le(this,null,function*(){var n;const r=yield c().windows.getCurrent(),s=Boolean((n=this._allowedBrowserAccess)==null?void 0:n.windowIds.isAllowedItem(r.id));(yield this._checkIfFocusedWindowIsMinimized(r,s))||(yield this._checkIfRefocusRequired(r,s))}),R(this._extensionMessageListenerHandlers)}init(n){const{userInfo:r,localizationControl:s,extensionControl:l,examControl:g,cameraWindowControl:p,allowedBrowserAccess:w,userPermissionsControl:f}=n;this._userInfo=r,this._localizationControl=s,this._extensionControl=l,this._examControl=g,this._cameraWindowControl=p,this._allowedBrowserAccess=w,this._userPermissionsControl=f}set _SYNC_isActive(n){this._isActive=n}get fullscreen(){return this._fullscreen}set _SYNC_fullscreenIsActive(n){this._fullscreen.isActive=n}get forceFocus(){return this._forceFocus}set _SYNC_forceFocusIsActive(n){this._forceFocus.isActive=n}set _SYNC_forceFocusIsBrowserIdle(n){this._forceFocus.isBrowserIdle=n}set _SYNC_forceFocusIsSendingFocusLostMessage(n){this._forceFocus.isSendingFocusLostMessage=n}set _SYNC_forceFocusIsExamInitializing(n){this._forceFocus.isExamInitializing=n}set _SYNC_forceFocusFocusedWindowStartId(n){this._forceFocus.focusedWindowStartId=n}set _SYNC_forceFocusFocusedWindowStartBounds(n){this._forceFocus.focusedWindowStartBounds=n}start(n){return Le(this,null,function*(){!n||this._isMissingAllowedItemsList()||this._isActive||(this._SYNC_isActive=!0,yield this._sendMessageBrowserGuardActive(n))})}stop(){return Le(this,null,function*(){yield this._stopFullscreen(),this._SYNC_isActive=!1,this._SYNC_forceFocusIsExamInitializing=!0,yield this._sendMessageBrowserGuardDisabled()})}disableBrowserGuardAndUpdateExamState(n=!1){return Le(this,null,function*(){var r;const s=yield c().storage.local.get(["guardModeStatus","exam_state"]);if((0,ue.isEmpty)(s))return;parseInt(s.guardModeStatus)&&(yield this.stop()),n||(r=this._allowedBrowserAccess)==null||r.disableBlockNewTabs(),new Set([K.PRELAUNCH,K.ROOMSCAN]).has(s.exam_state)&&(yield c().storage.local.set({exam_state:K.FRESH}))})}_startFullscreen(){return Le(this,null,function*(){var n,r,s,l,g,p;if(!((n=this._examControl)==null?void 0:n.examTabId)||!((r=this._examControl)==null?void 0:r.examWindowId)||!((s=this._cameraWindowControl)==null?void 0:s.cameraTabId)||this._isMissingAllowedItemsList()||this.fullscreen.isActive||!this._isActive)return;const w=yield c().storage.local.get(["fullscreen_override"]);if(!(w==null?void 0:w.fullscreen_override)){if(yield(l=this._userInfo)==null?void 0:l.resetDisplayBounds(),!this.forceFocus.focusedWindowStartId){const f=yield c().windows.get((g=this._examControl)==null?void 0:g.examWindowId);this._SYNC_forceFocusFocusedWindowStartId=f.id||null,this._SYNC_forceFocusFocusedWindowStartBounds={state:f.state,width:Number(f.width),height:Number(f.height),top:Number(f.top),left:Number(f.left)}}yield this._setExamWindowStateFullscreen((p=this._examControl)==null?void 0:p.examWindowId,!1),yield this.forceFocus.start(),this._delayFocusLostFlagging(),this._SYNC_fullscreenIsActive=!0}})}_delayFocusLostFlagging(n=1e3,r=5,s=60){let l=0,g=0;const p=setInterval(()=>Le(this,null,function*(){var f,T;if(!((f=this._examControl)==null?void 0:f.examWindowId)){w();return}if(g++,g>=s)return w();const re=yield c().windows.get((T=this._examControl)==null?void 0:T.examWindowId);if(!!(yield this._isFocusedWindowFullscreen(re))&&(l++,l>=r))return w()}),n),w=()=>{this._SYNC_forceFocusIsExamInitializing=!1,clearInterval(p)}}_stopFullscreen(){return Le(this,null,function*(){(yield c().windows.getAll()).forEach(r=>{if(!(r==null?void 0:r.id))return;const s=r.id===this.forceFocus.focusedWindowStartId?this.forceFocus.focusedWindowStartBounds:null;s&&c().windows.update(r.id,s)}),this.forceFocus.stop(),this._SYNC_forceFocusFocusedWindowStartId=null,this._SYNC_forceFocusFocusedWindowStartBounds=null,this._SYNC_fullscreenIsActive=!1})}_forceBrowserFocus(n,r){return Le(this,null,function*(){if(!n||!r)return;const s={focused:!0};yield c().windows.update(n,s),yield c().tabs.update(r,{active:!0})})}_startForceFocus(n,r){return Le(this,null,function*(){var s,l,g,p;!((s=this._cameraWindowControl)==null?void 0:s.cameraTabId)||this._isMissingAllowedItemsList()||this.forceFocus.isActive||!this._isActive||(n&&(yield(l=this._userInfo)==null?void 0:l.resetDisplayBounds()),(g=chrome==null?void 0:chrome.windows.onBoundsChanged)==null||g.addListener(this._windowOnBoundsChangedHandler),((p=this._userInfo)==null?void 0:p.isMacUser)&&c().windows.onFocusChanged.addListener(this._onFocusedChangedHandler),this.forceFocus.getCurrentWindowInterval=setInterval(this._getCurrentWindowIntervalHandler,r*1e3),this._SYNC_forceFocusIsActive=!0)})}_stopForceFocus(){var n;(n=chrome==null?void 0:chrome.windows.onBoundsChanged)==null||n.removeListener(this._windowOnBoundsChangedHandler),c().windows.onFocusChanged.removeListener(this._onFocusedChangedHandler),this.forceFocus.getCurrentWindowInterval&&clearInterval(this.forceFocus.getCurrentWindowInterval),this._SYNC_forceFocusIsActive=!1}_checkIfFocusedWindowIsMinimized(n,r){return Le(this,null,function*(){var s,l,g,p,w;if(!((s=this._examControl)==null?void 0:s.examWindowId)||((l=this._userInfo)==null?void 0:l.isWindowsUser)||!r||n.id===((g=this._examControl)==null?void 0:g.examWindowId)||!n.focused)return!1;const f=yield c().windows.get((p=this._examControl)==null?void 0:p.examWindowId);return(yield this._isFocusedWindowFullscreen(f))&&f.state!=="minimized"?!1:(yield this._logFocusLost(),yield this._setExamWindowStateFullscreen((w=this._examControl)==null?void 0:w.examWindowId),!0)})}_checkIfRefocusRequired(n,r){return Le(this,null,function*(){var s,l,g,p,w,f;if(!((s=this._examControl)==null?void 0:s.examWindowId)||this._isUserFocusedOnValidWindow(n,r))return;const T=yield c().windows.get((l=this._examControl)==null?void 0:l.examWindowId),re=((g=this._examControl)==null?void 0:g.isRecordScreenExamSettingActive)&&(T==null?void 0:T.state)==="minimized";(!((p=this._userInfo)==null?void 0:p.isMacUser)||re)&&(yield this._logFocusLost()),(!((w=this._userInfo)==null?void 0:w.isWindowsUser)||re)&&(yield this._setExamWindowStateFullscreen((f=this._examControl)==null?void 0:f.examWindowId,!1))})}_isUserFocusedOnValidWindow(n,r){var s,l,g;return r&&n.focused||((s=this._cameraWindowControl)==null?void 0:s.isInitializingScreenCapture)&&n.id===((l=this._cameraWindowControl)==null?void 0:l.cameraWindowId)||Boolean((g=this._userPermissionsControl)==null?void 0:g.isUserPermissionsPageBeingForcedActive)}_logFocusLost(){return Le(this,null,function*(){var n,r,s,l,g,p;if(!(this.forceFocus.isBrowserIdle||this.forceFocus.isExamInitializing)&&!(!((n=this._cameraWindowControl)==null?void 0:n.cameraTabId)||!((r=this._examControl)==null?void 0:r.examTabId))&&(yield c().tabs.sendMessage((s=this._cameraWindowControl)==null?void 0:s.cameraTabId,{action:"window_focus_lost"}),yield c().tabs.sendMessage((l=this._examControl)==null?void 0:l.examTabId,{action:"start_idle_browser_capture"}),this._SYNC_forceFocusIsBrowserIdle=!0,this.forceFocus.isSendingFocusLostMessage)){this._SYNC_forceFocusIsSendingFocusLostMessage=!1;const w=yield(g=this._localizationControl)==null?void 0:g.getTranslation("browserguard.click_outside");(p=this._examControl)==null||p.sendSingleAlertNotification(String(w),8e3),setTimeout(()=>this._SYNC_forceFocusIsSendingFocusLostMessage=!0,5e3)}})}_isFocusedWindowFullscreen(n){return Le(this,null,function*(){var r,s;const{top:l,left:g,width:p,height:w,state:f}=n,T=yield(r=this._userInfo)==null?void 0:r.getDisplayBounds();return((s=this._userInfo)==null?void 0:s.isWindowsUser)?f==="maximized":this._isDisplayBoundInRange(Number(T==null?void 0:T.top),l)&&this._isDisplayBoundInRange(Number(T==null?void 0:T.left),g)&&this._isDisplayBoundInRange(Number(T==null?void 0:T.width),p)&&this._isDisplayBoundInRange(Number(T==null?void 0:T.height),w)})}_isDisplayBoundInRange(n,r){const l=n-10,g=n+10;return typeof r!="undefined"?r>=l&&r<=g:!0}_setExamWindowStateFullscreen(n,r=!0){return Le(this,null,function*(){var s,l,g,p,w,f;if(!(!n||!((s=this._examControl)==null?void 0:s.examTabId))){if((l=this._userInfo)==null?void 0:l.isMacUser){const T=yield(g=this._userInfo)==null?void 0:g.getDisplayBounds();yield c().windows.update(n,{top:T.top,left:T.left,width:T.width,height:T.height,focused:!0}),yield c().tabs.update((p=this._examControl)==null?void 0:p.examTabId,{active:!0});return}!((w=this._userInfo)==null?void 0:w.isWindowsUser)&&r&&(yield c().windows.update(n,{focused:!1,state:"minimized"})),yield c().windows.update(n,{focused:!0,state:"maximized"}),yield c().tabs.update((f=this._examControl)==null?void 0:f.examTabId,{active:!0})}})}_sendMessageBrowserGuardActive(n){return Le(this,null,function*(){yield this._updateLocalGuardModeStatus(),(yield c().tabs.query({})).forEach(s=>{var l;!s.id||((l=this._allowedBrowserAccess)==null?void 0:l.websites.isDefaultItem(s.url))||c().tabs.sendMessage(s.id,{action:"init_browser_guard"})}),n&&(yield c().tabs.sendMessage(n,{action:"browser_guard_enabled"}))})}_sendMessageBrowserGuardDisabled(){return Le(this,null,function*(){yield this._updateLocalGuardModeStatus(),(yield c().tabs.query({})).forEach(r=>{r.id&&c().tabs.sendMessage(r.id,{action:"halt_browser_guard"})})})}_updateLocalGuardModeStatus(){return Le(this,null,function*(){yield c().storage.local.set({guardModeStatus:this._isActive?1:0})})}_isMissingAllowedItemsList(){var n,r;return!((n=this._allowedBrowserAccess)==null?void 0:n.websites)||!((r=this._allowedBrowserAccess)==null?void 0:r.windowIds)}_injectShortcutDetection(){return Le(this,null,function*(){var n,r;if(!this._isActive||!((n=this._examControl)==null?void 0:n.examTabId))return;const s=yield c().storage.local.get(["launch_meta","shortcut_detection_enabled"]);(s.launch_meta?s.launch_meta.shortcut_detection_enabled:s.shortcut_detection_enabled)&&(yield c().scripting.executeScript({target:{tabId:(r=this._examControl)==null?void 0:r.examTabId,allFrames:!0},files:["js/shortcut_detection.js"]}))})}_detectedShortcutUsage(n){var r,s;!((r=this._cameraWindowControl)==null?void 0:r.cameraTabId)||c().tabs.sendMessage((s=this._cameraWindowControl)==null?void 0:s.cameraTabId,{action:"detected_shortcut_usage",data:n.data}).catch(l=>{})}stopIdleBrowserCapture(){return Le(this,null,function*(){var n,r,s;!this.forceFocus.isBrowserIdle||!((n=this._cameraWindowControl)==null?void 0:n.cameraTabId)||(this._SYNC_forceFocusIsBrowserIdle=!1,yield c().tabs.sendMessage((r=this._cameraWindowControl)==null?void 0:r.cameraTabId,{action:"window_focus_returned",data:(s=this._userInfo)==null?void 0:s.isWindowsUser}))})}resetState(){this._isActive=!1,this._fullscreen.isActive=!1,this._forceFocus.isActive=!1,this._forceFocus.isBrowserIdle=!1,this._forceFocus.isSendingFocusLostMessage=!0,this._forceFocus.isExamInitializing=!0,this._forceFocus.focusedWindowStartId=null,this._forceFocus.focusedWindowStartBounds=null,this._forceFocus.getCurrentWindowInterval&&(clearInterval(this._forceFocus.getCurrentWindowInterval),this._forceFocus.getCurrentWindowInterval=null)}}const Qs=wr,Hr=class{constructor(){this._platformLastAcknowledge=-1,this._onPlatformTabUpdatedCallback=this._onPlatformTabUpdated.bind(this),this._setupOnTabUpdatedListeners()}init(u){const{examControl:n}=u;this._examControl=n}set _SYNC_platformLastAcknowledge(u){this._platformLastAcknowledge=u}_setupOnTabUpdatedListeners(){c().tabs.onUpdated.hasListener(this._onPlatformTabUpdatedCallback)||c().tabs.onUpdated.addListener(this._onPlatformTabUpdatedCallback)}_onPlatformTabUpdated(u,n){var r,s;this._tabLoadingStatus=n==null?void 0:n.status,!(u!==((r=this._examControl)==null?void 0:r.examTabId)||(n==null?void 0:n.status)!=="complete")&&c().tabs.sendMessage((s=this._examControl)==null?void 0:s.examTabId,{action:"platform_tab_updated"}).catch(l=>{})}start(u){if(this.isRunning())throw new Error("PlatformWatcher: Already running!");if(!u.tab||!u.tab.id)throw new Error("PlatformWatcher: No platform tab id!");this._startPlatformWatcherInterval()}stop(u){var n,r;if(!this.isRunning())throw new Error("PlatformWatcher: Not running!");((n=u.tab)==null?void 0:n.id)===((r=this._examControl)==null?void 0:r.examTabId)&&(this._clearPlatformWatcherInterval(),this._SYNC_platformLastAcknowledge=-1)}isRunning(){return Boolean(this._platformWatcherInterval)}set onAbandonedCallback(u){this._onAbandonedCallback=u}handleAcknowledgeMessage(u){var n,r;((n=u.tab)==null?void 0:n.id)===((r=this._examControl)==null?void 0:r.examTabId)&&(this._SYNC_platformLastAcknowledge=Date.now())}_startPlatformWatcherInterval(){this._platformLastAcknowledge>0||this.isRunning()||(this._SYNC_platformLastAcknowledge=Date.now(),this._clearPlatformWatcherInterval(),this._platformWatcherInterval=setInterval(()=>{var u;!((u=this._examControl)==null?void 0:u.examTabId)||(c().tabs.sendMessage(this._examControl.examTabId,{action:"platform_hello"}).catch(()=>{this._triggerPlatformAbandoned()}),this._checkPlatformAlive())},Hr.PLATFORM_WATCHER_INTERVAL_MS))}_checkPlatformAlive(){if(!(this._platformLastAcknowledge<0)){if(this._tabLoadingStatus!=="complete"){this._SYNC_platformLastAcknowledge=Date.now();return}Date.now()-this._platformLastAcknowledge>Hr.PLATFORM_WATCHER_TIMEOUT_MS&&this._triggerPlatformAbandoned()}}_triggerPlatformAbandoned(){this._onAbandonedCallback&&this._onAbandonedCallback(),this._clearPlatformWatcherInterval(),this._platformLastAcknowledge=-1}_clearPlatformWatcherInterval(){this._platformWatcherInterval&&(clearInterval(this._platformWatcherInterval),delete this._platformWatcherInterval)}resetState(){this._platformLastAcknowledge=-1,this._platformWatcherInterval&&(clearInterval(this._platformWatcherInterval),delete this._platformWatcherInterval)}};let yi=Hr;yi.PLATFORM_WATCHER_INTERVAL_MS=3e3,yi.PLATFORM_WATCHER_TIMEOUT_MS=1.67*Hr.PLATFORM_WATCHER_INTERVAL_MS;const Xs=yi;var tt=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});const qr=class{constructor(){this._unknownExtensions=new Map,this._extensionMessageListenerHandlers={start_exam:()=>this._handleStartExamMessage(),focus_exam_webcam:()=>this.startWatching(),track_enabled_blocked_extensions:u=>tt(this,[u],function*({message:n,sender:r}){return yield this._trackEnabledBlockedExtensions(n,r)}),disable_blocked_extensions:()=>tt(this,null,function*(){return yield this._disableAllBlockedExtensions()})}}init(u){const{userInfo:n,cameraWindowControl:r}=u;this._userInfo=n,this._cameraWindowControl=r,this._setupOnMessageListeners()}getInstalledExtensions(){return tt(this,null,function*(){const u=yield chrome.management.getAll();if((0,ue.isEmpty)(u))return[];const n=[];return u.forEach(r=>{var s;n.push({id:r.id,name:r.name,description:r.description,version:r.version,enabled:r.enabled,homepageUrl:(s=r.homepageUrl)!=null?s:null,installType:r.installType,permissions:r.permissions,mayDisable:r.mayDisable,offlineEnabled:r.offlineEnabled})}),n})}startWatching(u=!1){u||this._disableAllBlockedExtensions(),this._setupExtensionStateListeners()}stopWatching(){this._tearDownExtensionStateListeners()}set _SYNC_blockedExtensions(u){this._blockedExtensions=u}set _SYNC_unknownExtensions(u){this._unknownExtensions=u}_addUnknownExtension(u){this._unknownExtensions.set(u.id,u),this._SYNC_unknownExtensions=this._unknownExtensions}_removeUnknownExtension(u){this._unknownExtensions.delete(u),this._SYNC_unknownExtensions=this._unknownExtensions}_handleStartExamMessage(){this.startWatching(),!this._blockedExtensions&&new Promise((u,n)=>{const r=s=>{if(s>qr.BLOCKED_EXTENSION_QUERY_TIMEOUT_MS)return n("blocked extension continuous query timeout");if(this._blockedExtensions)return u();this._queryBlockedExtensions(),setTimeout(r,qr.BLOCKED_EXTENSION_QUERY_INTERVAL_MS,s+qr.BLOCKED_EXTENSION_QUERY_INTERVAL_MS)};r(0)}).then(()=>{this._disableAllBlockedExtensions()}).catch(u=>{})}_trackEnabledBlockedExtensions(u,n){return tt(this,null,function*(){var r;if(!this._cameraWindowControl||!this._cameraWindowControl.cameraTabId)return;const s=(r=n.tab)==null?void 0:r.id;!s||s!==this._cameraWindowControl.cameraTabId||u.test_page||(this._updateEnabledBlockedExtensionData(),chrome.management.onInstalled.addListener(()=>tt(this,null,function*(){return yield this._updateEnabledBlockedExtensionData()})),chrome.management.onEnabled.addListener(()=>tt(this,null,function*(){return yield this._updateEnabledBlockedExtensionData()})),chrome.management.onDisabled.addListener(()=>tt(this,null,function*(){return yield this._updateEnabledBlockedExtensionData()})),chrome.management.onUninstalled.addListener(()=>tt(this,null,function*(){return yield this._updateEnabledBlockedExtensionData()})))})}_updateEnabledBlockedExtensionData(){return tt(this,null,function*(){var u;if(!this._cameraWindowControl||!this._cameraWindowControl.cameraTabId)return;const n=yield this.getInstalledExtensions();if(!this._blockedExtensions){this._queryBlockedExtensions();return}const r=(u=this._blockedExtensions)==null?void 0:u.filter(s=>{var l;const g=n.find(p=>p.id===s.id);return(l=g==null?void 0:g.enabled)!=null?l:!1});c().tabs.sendMessage(this._cameraWindowControl.cameraTabId,{action:"blocked_extension_data",data:r!=null?r:[]}).catch(s=>{})})}_disableAllBlockedExtensions(){return tt(this,null,function*(){this._blockedExtensions&&this._blockedExtensions.forEach(u=>tt(this,null,function*(){yield chrome.management.setEnabled(u.id,!1)}))})}_actionInstalledExtensions(u){return tt(this,null,function*(){var n;const r=yield(n=this._userInfo)==null?void 0:n.getSessionData(),s=yield this.getInstalledExtensions(),{lms_id:l}=yield c().storage.local.get(["lms_id"]);if(!(!(r==null?void 0:r.session_id)||(0,ue.isEmpty)(s))){if(l==fe.PARTNER){const{session_id:g}=yield c().storage.local.get(["session_id"]),p=chrome.runtime.getManifest().version;yield this._logExtensionVersion(u,g,p).catch(w=>{})}yield this._logInstalledExtensions(u,r.session_id,s).catch(g=>{}),this.startWatching(!0)}})}_logInstalledExtensions(u,n,r){return tt(this,null,function*(){return c().tabs.sendMessage(u,{action:"log_installed_extensions",session_id:n,installed_extension_data:r})})}_logExtensionVersion(u,n,r){return tt(this,null,function*(){return c().tabs.sendMessage(u,{action:"log_extension_version",session_id:n,extension_version:r})})}_setupOnMessageListeners(){R(this._extensionMessageListenerHandlers)}_setupExtensionStateListeners(){this._extensionStateHandler||(this._extensionStateHandler=this._handleExtensionInstalledOrEnabledEvent.bind(this),chrome.management.onInstalled.addListener(this._extensionStateHandler),chrome.management.onEnabled.addListener(this._extensionStateHandler))}_tearDownExtensionStateListeners(){!this._extensionStateHandler||(chrome.management.onInstalled.removeListener(this._extensionStateHandler),chrome.management.onEnabled.removeListener(this._extensionStateHandler),delete this._extensionStateHandler)}handleLaunchProctoringIframeMessage(u,n){return tt(this,null,function*(){var r;if(!(u.source!=="HL_LAUNCH_PROCTORING"||!((r=n.tab)==null?void 0:r.id))){if(u.message=="user_agreement_completed")return yield this._actionInstalledExtensions(n.tab.id);u.message==="blocked_extension_list"&&u.blocked_extension_data&&(this._SYNC_blockedExtensions=u.blocked_extension_data,this._updateEnabledBlockedExtensionData())}})}handleCameraBladeMessage(u,n){return tt(this,null,function*(){var r;if(u.source!=="HL_CAMERA_BLADE"||!((r=n.tab)==null?void 0:r.id))return;const s=yield c().storage.local.get(["exam_state"]),g=new Set([String(K.ACTIVE),String(K.PAUSED)]).has(s.exam_state);switch(u.message){case"blocked_extension_query_results":if(!u.blocked_extension_data||(this._SYNC_blockedExtensions=u.blocked_extension_data,this._updateEnabledBlockedExtensionData(),!g))return;this._disableAllBlockedExtensions(),this._unknownExtensions.forEach(p=>{var w;const f=(w=this._blockedExtensions)==null?void 0:w.find(T=>T.id===p.id);!f||(this._removeUnknownExtension(f.id),this._logEvent("enable_disallowed_browser_extension_attempted",p.id))});break}})}_queryBlockedExtensions(){return tt(this,null,function*(){if(!this._cameraWindowControl||!this._cameraWindowControl.cameraTabId)return;const u=yield this.getInstalledExtensions();c().tabs.sendMessage(this._cameraWindowControl.cameraTabId,{action:"blocked_extension_query",data:u}).catch(n=>{})})}_logEvent(u,n){return tt(this,null,function*(){!this._cameraWindowControl||!this._cameraWindowControl.cameraTabId||c().tabs.sendMessage(this._cameraWindowControl.cameraTabId,{action:"blocked_extension_log_event",data:{eventType:u,extensionId:n}}).catch(r=>{})})}_handleExtensionInstalledOrEnabledEvent(u){return tt(this,null,function*(){var n;const r=yield c().storage.local.get(["lms_id","exam_state","session_id","session_uuid"]),l=new Set([String(K.ACTIVE),String(K.PAUSED)]).has(r.exam_state),g=(n=this._blockedExtensions)==null?void 0:n.find(p=>p.id===u.id);if(!g){this._addUnknownExtension(u),this._queryBlockedExtensions();return}!l||(chrome.management.setEnabled(g.id,!1),this._logEvent("enable_disallowed_browser_extension_attempted",g.id))})}};let Si=qr;Si.BLOCKED_EXTENSION_QUERY_INTERVAL_MS=3e4,Si.BLOCKED_EXTENSION_QUERY_TIMEOUT_MS=3e5;const Zs=Si;var Gr=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())});class Js{constructor(){this._launchUnification=!1}init(n){const{userInfo:r,examControl:s,localizationControl:l}=n;this._userInfo=r,this._examControl=s,this._localizationControl=l,this._examControl.setIsLaunchUnificationFlagOn(this._launchUnification)}get isLaunchUnification(){return this._launchUnification}sendExitMessageToLaunchTab(){var n;!((n=this._examControl)==null?void 0:n.universalLaunchTabId)||c().tabs.sendMessage(this._examControl.universalLaunchTabId,{action:"exit_honorlock_clicked"})}handleLaunchProctoringIframeMessage(n,r){return Gr(this,null,function*(){var s,l,g,p,w,f;if(!((s=r.tab)==null?void 0:s.id)||r.frameId===void 0||n.source!=="HL_LAUNCH_PROCTORING"||n.message!=="universal_launch"||!this._userInfo||!this._localizationControl)return;(g=this._examControl)==null||g.setLmsUrl((l=r.tab.url)!=null?l:null),(p=this._examControl)==null||p.setLmsId(fe.UNIVERSAL),yield this._injectUniversalLaunch(r.tab.id,r.frameId);const T=n.universal_launch_meta;!T||((w=this._examControl)==null||w.setUniversalLaunchTabId(r.tab.id),(f=this._examControl)==null||f.setUniversalLaunchFrameId(r.frameId),yield this._injectInstalledExtensionEvents(r.tab.id,r.frameId),this._handleLaunchMeta(T))})}set _SYNC_launchUnification(n){var r;this._launchUnification=n,(r=this._examControl)==null||r.setIsLaunchUnificationFlagOn(this._launchUnification)}_injectUniversalLaunch(n,r){return Gr(this,null,function*(){yield c().scripting.executeScript({target:{tabId:n,frameIds:[r]},files:["js/universal_launch.js"]}),yield c().scripting.insertCSS({target:{tabId:n,frameIds:[r]},files:["css/universal_launch_styles.css"]})})}_injectInstalledExtensionEvents(n,r){return Gr(this,null,function*(){yield c().scripting.executeScript({target:{tabId:n,frameIds:[r]},files:["js/installed_extension_events.js"]})})}_handleLaunchMeta(n){return Gr(this,null,function*(){if(!this._userInfo||!this._localizationControl)return;this._SYNC_launchUnification=!0;const r=n.usat;this._userInfo.setSessionData({student_email:n.student_email,student_id:n.student_id,session_id:n.session_id,student_name:n.student_name}),this._localizationControl.setTranslations(n.translations),c().storage.local.set({launch_meta:n,is_universal_lms_exam:!0,launch_unification:!0,usat:r}).catch(s=>{})})}}const qe=Js;class Fe{constructor(){c().tabs.onRemoved.addListener(this.handleTabCloseEvent.bind(this))}init(n){this._examControl=n.examControl}handleTabCloseEvent(){this._examControl===void 0||this._examControl.examStart===null||chrome.history.deleteRange({startTime:this._examControl.examStart.valueOf(),endTime:Date.now()},ue.noop)}}const ea=Fe;class ta{init(){this._setupRequestListeners()}_setupRequestListeners(){c().webRequest.onHeadersReceived.addListener(this._handleCanvasNewQuizForbidden,{urls:["*://*.instructure.com/*api/quiz_sessions/*/take","*://*.canvas.com/*api/quiz_sessions/*/take"]},[])}_handleCanvasNewQuizForbidden({initiator:n,statusCode:r,tabId:s}){!n||r!==403||!n.includes(cr)||c().tabs.get(s).then(g=>{if(!g.url)return;const w=new URL(g.url).searchParams.get("url");if(!w)return;const T=new URL(w).searchParams.get("platform_redirect_url");if(!T)return;const re=new URL(T),j=re.origin+re.pathname;jn(j)&&c().tabs.update(s,{url:j})})}}const na=ta;var wt=(u,n,r)=>new Promise((s,l)=>{var g=f=>{try{w(r.next(f))}catch(T){l(T)}},p=f=>{try{w(r.throw(f))}catch(T){l(T)}},w=f=>f.done?s(f.value):Promise.resolve(f.value).then(g,p);w((r=r.apply(u,n)).next())}),ns;const rs=new _t,wn=new $e(rs,{localizationControl:new Se,userInfo:new Kn,studentTutorialControl:new Tt,chatClientControl:new ct,userPermissionsControl:new vt,extensionControl:new wi,examControl:new pr,cameraWindowControl:new E,allowedBrowserAccess:new D,injectDisableKeyboardEvents:new $,proctoringActions:new Ci,browserGuard:new Qs,platformWatcher:new Xs,installedExtensionsControl:new Zs,backgroundStateListeners:new Ve,universalLaunchControl:new qe,clearExamBrowserHistory:new ea}),{localizationControl:In,userInfo:Je,userPermissionsControl:Rn,extensionControl:nt,examControl:k,cameraWindowControl:ce,allowedBrowserAccess:Ne,injectDisableKeyboardEvents:Kr,studentTutorialControl:is,chatClientControl:ss,proctoringActions:an,browserGuard:Jn,platformWatcher:on,installedExtensionsControl:ft,universalLaunchControl:$r,clearExamBrowserHistory:Rt}=wn.moduleProxies,ra=new na;c().runtime.onInstalled.addListener(wn.handleExtensionOnInitialization),(ns=c().management)==null||ns.onEnabled.addListener(wn.handleExtensionOnInitialization),chrome.storage.onChanged.addListener(An),chrome.runtime.onMessage.addListener(Ti),c().runtime.onMessageExternal.addListener(Vr),wn.onStoreReady(as),ra.init();function as(){return wt(this,null,function*(){yield wn.rebuildState(),In.init(),Je.init(),is.init(),ss.init({examControl:k}),Rn.init({examControl:k,cameraWindowControl:ce}),nt.init({clearStoreState:wn.clearStoreState,localizationControl:In,examControl:k,cameraWindowControl:ce,allowedBrowserAccess:Ne,proctoringActions:an,browserGuard:Jn,installedExtensionsControl:ft}),k.init({cameraWindowControl:ce,browserGuard:Jn,allowedBrowserAccess:Ne,proctoringActions:an,userPermissionsControl:Rn,extensionControl:nt,injectDisableKeyboardEvents:Kr,installedExtensionsControl:ft}),ce.init({extensionControl:nt,examControl:k,userPermissionsControl:Rn,allowedBrowserAccess:Ne,browserGuard:Jn,proctoringActions:an,installedExtensionsControl:ft,universalLaunchControl:$r}),Ne.init({localizationControl:In,examControl:k,cameraWindowControl:ce}),an.init({userInfo:Je,localizationControl:In,extensionControl:nt,examControl:k,cameraWindowControl:ce,allowedBrowserAccess:Ne,userPermissionsControl:Rn}),Jn.init({userInfo:Je,localizationControl:In,extensionControl:nt,examControl:k,cameraWindowControl:ce,allowedBrowserAccess:Ne,userPermissionsControl:Rn}),ft.init({userInfo:Je,cameraWindowControl:ce}),on.init({examControl:k}),$r.init({userInfo:Je,examControl:k,localizationControl:In}),Rt.init({examControl:k}),wn.isBackgroundInitialized=!0})}function An(u){rs.saveLocalStorageToBackgroundStateStore();for(const n in u){const r=u[n].newValue;n==="exam_state"&&Xe(r)}}function Vr(u,n){var r,s;if(!!(n==null?void 0:n.origin)&&n.origin==="https://app.honorlock.com"&&u.message==="rehydrate_session"){if(!((r=u.data)==null?void 0:r.other)||!((s=u.data)==null?void 0:s.data))return;Qr(u.data.other,u.data.data),ce==null||ce.closeAllCameraWindows().then(()=>{an==null||an.pauseAllTabs()});return}}function Ti(u,n,r){var s,l,g;if(u.message==="lms_init"){if(nt.isExtensionUpdateAvailable){nt.handleExtensionUpdateRequiredOnExamInit();return}return Rn.clearActiveCameraSettings(),Ne.resetClosedTabUrls(),nt.clearLocalStorage(()=>la(u,n,r)).catch(p=>{}),!0}else if(u.message==="api_setup")nt.clearLocalStorage(()=>Ui(u,n)).catch(p=>{});else if(u.message==="platform_exam_closed")ds(n).catch(p=>{});else if(u.message=="access_request"){if(!((s=n==null?void 0:n.tab)==null?void 0:s.id))return;k.requestAccess(u.data.access,n.tab.id)}else if(u.message==="init_external_exams")Li().catch(p=>{});else if(u.message==="insert_password_external")ia(u.var.session_id,u.var.location_url).catch(p=>{});else if(u.message==="show_insert_password_button"){if(!k.examTabId||!ce.cameraTabId||!ce.cameraWindowId)return;chrome.tabs.sendMessage(k.examTabId,{action:"show_insert_password_button"}),chrome.tabs.sendMessage(ce.cameraTabId,{action:"show_insert_password_button"}),chrome.windows.update(ce.cameraWindowId,{focused:!0,state:"normal"})}else if(u.message==="insert_password_step")c().storage.local.set({authentication_complete:!0}).catch(p=>{});else if(u.message==="password_insert_success")ls(u,n).catch(p=>{});else if(u.message==="insert_password_ready")chrome.tabs.query({},function(p){for(let w=0;w<p.length;w++){const f=p[w];(f==null?void 0:f.id)&&chrome.tabs.sendMessage(f.id,{action:"insert_password_ready"})}});else if(u.message==="exit_honorlock_clicked")oa().catch(p=>{});else if(u.message==="end_universal_exam_early")us().catch(p=>{});else if(u.message==="launch_page_opened")cs(n).catch(p=>{});else if(u.message==="relaunch_app_unlock"){if(!ce.cameraTabId||!ce.cameraWindowId)return;chrome.tabs.sendMessage(ce.cameraTabId,{action:"relaunch_app_unlock"}),chrome.windows.update(ce.cameraWindowId,{focused:!0,state:"normal"})}else if(u.message==="external_exam_exit_listener"){if(!((l=n==null?void 0:n.tab)==null?void 0:l.id)||!((g=n==null?void 0:n.tab)==null?void 0:g.url)||(Ne.addAllowedTabId(n.tab.id),Ne.addAllowedWebsite(n.tab.url),k.setExamTabId(n.tab.id),k.setExamWindowId(n.tab.windowId),!k.examTabId||!k.universalLaunchWindowId||!k.universalLaunchTabId))return;chrome.tabs.move(k.examTabId,{windowId:k.universalLaunchWindowId,index:-1},function(p){!(p==null?void 0:p.id)||chrome.tabs.update(p.id,{active:!0})}),nt.pinBrowserTabById(k.universalLaunchTabId),r(!0)}else if(u.message==="inject_password_module")Pi(n).catch(p=>{});else if(u.message==="update_allowed_applications"){if(!k.examTabId)return;chrome.tabs.sendMessage(k.examTabId,{action:"update_toolbar_allowed_applications",data:u.var})}else if(u.message==="start_disable_copy_paste")Kr.addInjectableScripts(n.tab.id,"js/disable_copy_paste.js");else if(u.message==="start_hotkey_detection")Kr.addInjectableScripts(n.tab.id,"js/hotkey_detection.js");else if(u.message==="blocked_copy_paste")chrome.tabs.query({active:!0,currentWindow:!0},p=>{const w=p[0];(w==null?void 0:w.id)&&chrome.tabs.sendMessage(w.id,{action:"show_blocked_event_notification",event_name:u.event_name})});else if(u.message==="inject_new_canvas_quiz_run"){if(c().scripting.executeScript({target:{tabId:n.tab.id},files:["js/canvas_run.js"]}),!k.examTabId)return;c().tabs.sendMessage(k.examTabId,{message:"new_canvas_quiz_active"})}else if(u.message==="inject_new_canvas_quiz_summary")c().scripting.executeScript({target:{tabId:n.tab.id},files:["js/canvas_quiz_summary.js"]});else if(u.message==="is_ncq_access_screen")return c().tabs.sendMessage(n.tab.id,{action:u.message}).then(p=>{r(p)}),!0;if(u.message==="ultra_close_if_no_exam_is_active")k.examTabId&&chrome.tabs.get(k.examTabId,p=>{var w;!((w=n==null?void 0:n.tab)==null?void 0:w.id)||(!p||p.id===n.tab.id)&&(k.triggerExamSubmissionEvent(),chrome.tabs.sendMessage(n.tab.id,{action:"bbultra_exam_closed"}))});else if(u.message==="show_acknowledgement_modal_message"){if(!k.examTabId)return;const{modal_header:p,modal_body:w,modal_button:f,modal_icon:T,modal_aria_label:re}=u.data;c().tabs.sendMessage(k.examTabId,{message:"show_acknowledgement_modal_message",modal_header:p,modal_body:w,modal_button:f,modal_icon:T,modal_aria_label:re}).catch(j=>{})}}function Xe(u){if((0,ue.isUndefined)(u))return;const n={[K.PAUSED]:()=>r({initRecord:!0,badgeState:"ready",isExamActive:!0}),[K.INACTIVE]:()=>r({badgeState:"ready",isExamActive:!0}),[K.PRELAUNCH]:()=>r({initRecord:!0,badgeState:"ready",isExamActive:!0}),[K.ROOMSCAN]:()=>r({initRecord:!0,badgeState:"recording",isExamActive:!0}),[K.ACTIVE]:()=>r({badgeState:"recording",isExamActive:!0}),[K.SUBMITTED]:()=>r({badgeState:"inactive",isExamActive:!1,isCheckingIfUpdateAvailable:!0}),[K.OVERRIDE]:()=>r({badgeState:"inactive",isExamActive:!1,isCheckingIfUpdateAvailable:!0}),[K.FRESH]:()=>r({badgeState:"inactive",isExamActive:!1,isCheckingIfUpdateAvailable:!0})},r=s=>{const{initRecord:l,badgeState:g,isExamActive:p,isCheckingIfUpdateAvailable:w}=s;(0,ue.isUndefined)(l)||nt.setIsInitializingRecordingSession(Boolean(l)),(0,ue.isUndefined)(g)||nt.setBadgeIconState(g),(0,ue.isUndefined)(p)||(k.setIsExamActive(p),ge()),w&&nt.checkIfExtensionUpdateIsAvailable()};if(k.setExamState(u.toLowerCase()),!n[k.examState]){r({badgeState:"inactive",isExamActive:!1,isCheckingIfUpdateAvailable:!0});return}n[k.examState]()}function ln(){ce.cameraTabId!=null&&c().tabs.sendMessage(ce.cameraTabId,{action:"universal_set_end_exam"}).catch(u=>{})}function Li(){return wt(this,null,function*(){if(k.setIsUniversalExitButtonClicked(!1),(yield c().storage.local.get(["has_password_been_inserted"])).has_password_been_inserted&&ce.cameraTabId){yield c().tabs.remove(ce.cameraTabId);return}chrome.windows.onFocusChanged.addListener(Oi)})}function os(u){chrome.storage.local.get(null,function(n){return wt(this,null,function*(){if(u===n.launch_tab_id&&k.examTabId){const r=yield In.getTranslation("background.do_not_close_tab");yield chrome.storage.local.set({launch_message:r}),chrome.tabs.create({url:n.launch_url,pinned:!0},function(s){!(s==null?void 0:s.id)||chrome.tabs.sendMessage(s.id,{action:"password_insert_success"})})}u===n.webcam_tab_id&&ce.setCameraTabId(null),u===n.exam_tab_id&&k.setExamTabId(null)})})}function Oi(u){if(u===-1||!ce.cameraWindowId||u===ce.cameraWindowId||k.universalPasswordInsertWindowId===u)return!0;k.setUniversalPasswordInsertWindowId(u)}function ia(u,n){return wt(this,null,function*(){const{authentication_complete:r}=yield c().storage.local.get(["authentication_complete"]);if(!r||!k.universalPasswordInsertWindowId)return;const l=(yield c().tabs.query({active:!0,windowId:k.universalPasswordInsertWindowId}))[0];if(!(l==null?void 0:l.id)||Ne.websites.isDefaultItem(l.url)||Ne.websites.isDefaultItem(l.url))return;k.examTabId||(k.setExamTabId(l.id),k.setExamWindowId(l.windowId)),ce.updateIsInsertingUniversalExamPassword(!0);const g=yield c().tabs.sendMessage(l.id,{action:"check_external_code_exists"});if(!ce.cameraTabId)return;c().tabs.sendMessage(ce.cameraTabId,{action:"request_external_access",data:{location_url:n}});const p=yield c().tabs.sendMessage(ce.cameraTabId,{action:"check_external_access"});if(!p)return;if(!(l==null?void 0:l.id)){ce.updateIsInsertingUniversalExamPassword(!1);return}const w=p.substring(0,p.length-2);if(g){c().tabs.sendMessage(l.id,{action:"reinsert_access_code",access_code:w}).catch(f=>{});return}sa(w)})}function sa(u){!k.universalPasswordInsertWindowId||chrome.tabs.query({active:!0,windowId:k.universalPasswordInsertWindowId},function(n){return wt(this,null,function*(){const r=n[0].id,s=n[0].windowId;if(k.examTabId||(k.setExamTabId(r),k.setExamWindowId(s)),!r)return;k.setIsUniversalExamInitializationScriptInjected(!0);function l(g){globalThis.access_code=g}yield c().scripting.executeScript({target:{tabId:r,allFrames:!0},func:l,args:[u]}),yield c().scripting.executeScript({target:{tabId:r,allFrames:!0},files:["js/external_check.js"]})})})}function aa(u,n,r){return wt(this,null,function*(){const s={tabId:u,frameIds:[n]};yield c().scripting.insertCSS({target:s,files:["css/external_exams_styles.css"]}),yield c().scripting.executeScript({target:s,files:["js/external_exams.js"]}),yield c().windows.update(r,{focused:!0,drawAttention:!0})})}function ls(u,n){return wt(this,null,function*(){var r,s;if(chrome.tabs.onRemoved.addListener(os),k.setExamTabId((r=n.tab)==null?void 0:r.id),k.setExamWindowId((s=n.tab)==null?void 0:s.windowId),!k.examTabId||!ce.cameraTabId||!k.universalLaunchTabId)return;yield c().storage.local.set({has_password_been_inserted:!0,exam_state:K.ACTIVE,exam_tab_id:n.tab.id});const l={whitelistURL:u.host,whitelistTab:k.examTabId};Ne.addAllowedWebsite(u.host),Ne.addAllowedTabId(k.examTabId),Ne.addAllowedTabId(k.universalLaunchTabId),chrome.tabs.sendMessage(ce.cameraTabId,{action:"password_insert_success",data:l}),chrome.tabs.sendMessage(k.universalLaunchTabId,{action:"password_insert_success"}),chrome.tabs.sendMessage(k.examTabId,{action:"password_insert_success"}),nt.pinBrowserTabById(k.universalLaunchTabId)})}function er(){return wt(this,null,function*(){$r.isLaunchUnification&&k.universalLaunchTabId&&$r.sendExitMessageToLaunchTab(),k.setIsExamActive(!1),Ne.resetAllAllowedItemLists(),yield Jn.stop(),nt.checkIfExtensionUpdateIsAvailable()})}function tr(u){chrome.tabs.query({url:"https://*.honorlock.com/launch*"},function(n){n.forEach(function(r){(r==null?void 0:r.id)&&r.id!==u&&chrome.tabs.remove(r.id)})})}function oa(){return wt(this,null,function*(){if(k.setIsUniversalExitButtonClicked(!0),k.setIsExamCurrentlySubmitting(!0),k.unpinUniversalLaunchTabs(),k.examTabId!=null){if(yield c().tabs.remove(k.examTabId),!k.isExamActive)return;ln(),yield er();return}ln(),yield k.endUniversalExamSession(!0),yield er()})}function us(){return wt(this,null,function*(){yield k.endUniversalExamSession(!0),yield er()})}function cs(u){return wt(this,null,function*(){var n;if(!((n=u==null?void 0:u.tab)==null?void 0:n.id))return;ge(),k.setUniversalLaunchTabId(u.tab.id),tr(k.universalLaunchTabId),nt.pinBrowserTabById(k.universalLaunchTabId),yield c().storage.local.set({launch_tab_id:k.universalLaunchTabId});const r=yield c().storage.local.get(["exam_state"]);if(c().tabs.onRemoved.addListener(l=>{chrome.storage.local.get(null,function(g){return wt(this,null,function*(){l===g.launch_tab_id&&!k.examTabId&&(ce.closeAllCameraWindows(),chrome.storage.local.clear().catch(p=>{}))})})}),new Set([K.ACTIVE,K.PAUSED]).has(r.exam_state)&&(c().tabs.onRemoved.addListener(os),!ce.cameraTabId)){yield an.pauseAllTabs(),chrome.tabs.sendMessage(u.tab.id,{action:"password_insert_success"});return}yield an.resumeAllTabs()})}function Pi(u){return wt(this,null,function*(){k.isUniversalExamInitializationScriptInjected&&(u==null?void 0:u.tab)&&(yield aa(u.tab.id,u.frameId,u.tab.windowId),k.setIsUniversalExamInitializationScriptInjected(!1))})}function jr(u){var n,r;const s=parseInt((n=u[b.BASIC_CALCULATOR])==null?void 0:n.value),l=parseInt((r=u[b.SCIENTIFIC_CALCULATOR])==null?void 0:r.value);return s||l?s?"basic":"scientific":null}function Ni(u){var n;const r=parseInt((n=u[b.SUPPORT_CHAT])==null?void 0:n.value);return Boolean(r)}function la(u,n,r){let s,l;fetch("https://app.honorlock.com/lms/studentinit",{method:"POST",body:JSON.stringify(u.data),headers:{"Content-type":"application/json"}}).then(g=>g.json()).then(g=>{var p;if(s=1,l=g,!l.student){s=0;return}Qr(u.data,l),k.setLmsId(u.data.lms_id),u.data.lms_metadata!==void 0&&k.setLmsMetadata(u.data.lms_metadata),l.alerts&&((p=n==null?void 0:n.tab)==null?void 0:p.id)&&k.sendAlertNotificationsToTab(n.tab.id,l.alerts).catch(w=>{})}).catch(function(g){s=0,l=g}).finally(()=>{r({result:s,response:l})})}function Qr(u,n){ge(),In.setTranslations(n.translations),ce.setCameraWindowDimensions(n.camera_blade_dimensions),Je.setSessionData({student_attempt:n.student_attempt,bypass_status:n.student.bypass_status,student_email:n.student.signed_email,student_id:n.student_id,session_id:n.session_id,student_name:n.student.user_name,lms_student_id:u.lms_student_id,lms_student_name:u.lms_student_name}),chrome.storage.local.set({usat:n.usat,app_url:n.app_url,bypass_status:n.student.bypass_status,exam_id:n.exam_id,exam_toggles:n.exam_toggles,attempt:n.student_attempt,lms_id:n.lms_id,http_ref:n.student.http_ref,lms_exam_id:u.lms_exam_id,lms_school_id:u.lms_school_id,camera_blade_dimensions:ce.cameraWindowDimensions,translations:n.translations,shortcut_detection_enabled:n.shortcut_detection_enabled,launch_proctoring_iframe_url:n.launch_proctoring_iframe_url,toolbar_data:{available_calculator_type:jr(n.exam_toggles),support_chat_enabled:Ni(n.exam_toggles)}}).catch(s=>{}),n&&n.session_id&&chrome.runtime.setUninstallURL("https://app.honorlock.com/extension/uninstall/"+n.session_id);const r=new URL(u.href).hostname;Ne.addAllowedWebsite(r)}function Ui(u,n){var r;const s=u.data;c().storage.local.set({app_url:s.app_url,exam_id:s.exam_id,exam_toggles:s.exam_toggles,attempt:s.attempt,lms_id:s.lms_id,session_uuid:s.session_id,session_id:s.session_id,external_exam_id:s.external_exam_id,exam_taker_id:s.exam_taker_id,exam_taker_name:s.exam_taker_name,current_question:null,translations:s.translations,shortcut_detection_enabled:s.shortcut_detection_enabled,launch_proctoring_iframe_url:s.launch_proctoring_iframe_url,toolbar_data:{available_calculator_type:jr(s.exam_toggles),support_chat_enabled:Ni(s.exam_toggles)},simulated:s.simulated,additionally_supported_url:s.additionally_supported_url}).catch(l=>{}),s.additionally_supported_url&&Ne.addUrlToAllowList(s.additionally_supported_url),s.session_id&&chrome.runtime.setUninstallURL("https://app.honorlock.com/extension/uninstall/"+s.session_id),(s==null?void 0:s.alerts)&&((r=n==null?void 0:n.tab)==null?void 0:r.id)&&k.sendAlertNotificationsToTab(n.tab.id,s.alerts).catch(l=>{}),hs(n)}function ds(u){return wt(this,null,function*(){yield nt.clearLocalStorage().catch(n=>{}),(on==null?void 0:on.isRunning())&&on.stop(u)})}function hs(u){(on==null?void 0:on.isRunning())&&on.stop(u),on.onAbandonedCallback=()=>{ds(u).catch(n=>{})}}})()})();
